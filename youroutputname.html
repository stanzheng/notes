<hr />
<p>id: information-security-access-control
title: Access Control
course: information-security
lecture: access-control</p>
<hr />
<h1>Access Control</h1>
<h2>Controlling Accesses to Resources</h2>
<p>Any program can make a request for a protected resource, so the OS needs to know whether to grant or deny these requests.</p>
<p>For example, if John is a student in a class, and he makes a request to read a file containing the grades for all of the students in that class, should his request be granted?</p>
<p>Remember, authentication tells us the user on whose behalf a process or application makes a request. Authentication allows us to know that the above request came from John.</p>
<p>Authorization, or <strong>access control</strong>, involves determining if a certain requestor is allowed to access the resources they are requesting in the manner in which they are requesting. Access control determines whether John can access the file for reading or not.</p>
<p>Resources - like files - that we have in the system are created by certain users, or <strong>subjects</strong>.</p>
<p>One implementation of access control says that the creator of a resource has full reign over how that resource is accessed.</p>
<p>Indeed, in many systems the idea of a resource owner is defined, and it can be at the discretion of the owner how that resource can be shared.</p>
<p>Of course, there are situations where this is not true. For example, your company may not allow you to decide how you wish to share information related to that company, regardless of whether you created the information or not.</p>
<h2>Access and Authentication</h2>
<p>In order to understand whether a resource access request should be granted or denied, we need to know who is allowed to access which resources in a given system.</p>
<p>There are two components to the problem of access control.</p>
<p>First, system administrators need to specify who has access to what. This specification is called an <strong>access control policy</strong>.</p>
<p>Once the administrators have delivered this policy to the system, the system needs to monitor each request and ensure that any accesses it grants are consistent with the policy.</p>
<p>Complete mediation is essential for access control to work. There is no point having a system enforce policies if a user can step around the system.</p>
<h2>Access Control Matrix Defined</h2>
<p>We can abstract the information about "who has access to what" into a data structure called an <strong>access control matrix</strong> (ACM).</p>
<p>Like any matrix, an ACM has rows and columns. The rows of an ACM correspond to the users, subjects or groups present in the system. The columns of an ACM correspond to the system resources that need to be protected.</p>
<p>Each cell in the ACM, indexable by user and resource, contains a set of operations that the queried user can perform on the queried resource.</p>
<p>For example if we have an ACM <code>A</code>, a user <code>U</code>, and a resource <code>R</code>, then <code>A[U,R]</code> contains the list of operations that <code>U</code> can perform on <code>R</code>.</p>
<h2>Access Control Matrix</h2>
<p>Here is an example of an <code>m x n</code> matrix, with <code>m</code> rows and <code>n</code> columns.</p>
<p><img alt="" src="https://assets.omscs.io/notes/64483C40-D000-4FDD-A3C4-B71605042DA4.png" /></p>
<p>The first row in this matrix corresponds to the first user, the second row to the second user, and so on until the m-th user in the m-th row.</p>
<p>Likewise, the first column in this matrix corresponds to the first object, the second column to the second object, and so on until the n-th object in the n-th column.</p>
<p>Each cell in this matrix contains the authorized operations that a user can perform on an object. For example, the cell at <code>A[3,2]</code> contains the operations that user three can perform on object two.</p>
<p>The operations present will be some subset of the possible operations that can be performed on the given resource. In the case of a file <code>F</code> - which can be readable, writeable, and/or executable - and user <code>U</code> , <code>A[U,F]</code> will have some combination of read, write, and execute bits present.</p>
<h2>Data Confidentiality Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/AD434002-43B3-41CC-A837-4B2BBFA18017.png" /></p>
<h2>Data Confidentiality Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/C9D0D775-0D1F-4695-9F4F-8EBA71914E34.png" /></p>
<p>Controlling read access is connected to data confidentiality, while controlling write access is connected to data integrity.</p>
<h2>Determining Access Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/104BA89A-BC90-4875-A0BD-48765D8DD073.png" /></p>
<h2>Determining Access Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0E90ADD5-3CCB-4A69-9C9E-55E06E88A8E8.png" /></p>
<p>Access control conflicts can be securely resolved by denying access.</p>
<h2>Discretionary Access Control Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/8C822B06-A689-4ABC-BC3C-69517F39029D.png" /></p>
<h2>Discretionary Access Control Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/69519ED2-526D-47DB-8CFF-B3A922D2DBDF.png" /></p>
<p>Bob can write the contents of the file to a new file that he owns, and share that file with Charlie.</p>
<h2>Implementing Access Control</h2>
<p>A system will likely have multiple users and many different objects that it needs to protect; therefore, an access control matrix can be very large.</p>
<p>This matrix will also be relatively <em>sparse</em>. With many users in a system, and many objects that any individual user cannot access, the majority of the cells in the matrix will be empty.</p>
<p>How should we represent the access control matrix within our system?</p>
<p>If we focus on each column of the matrix, we can make a list of all of the access rights users have for a given object.</p>
<p>Consider an object <code>O</code>. If user <code>A</code> has read access to <code>O</code> and user <code>B</code> has write access to <code>O</code>, and user <code>C</code> has no access to <code>O</code>, we can represent the accesses permitted on <code>O</code> as</p>
<p><code>bash
[(A, r), (B,w)]</code></p>
<p>This is called an <strong>access control list</strong> (ACL). ACLs are associated with each resource, and enumerate the authorized users and types of operations permitted on that resource.</p>
<p>Alternatively, we can focus on each row in the matrix, which corresponds to a particular user.</p>
<p>Consider a user  <code>U</code>. If <code>U</code> can read object <code>X</code>, and can write object <code>Y</code>, but cannot access object <code>Z</code>, we can represent the authorized operations that <code>U</code> can perform as</p>
<p><code>bash
[(X, r), (Y, w)]</code></p>
<p>This type of list is called a <strong>capability list</strong> (C-list), and identifies which objects a user can access and in what fashion.</p>
<h2>Example Access Control Matrix</h2>
<p><img alt="" src="https://assets.omscs.io/notes/83D673FC-D0C1-4D65-8817-58624749D45F.png" /></p>
<p>In this example, we have a system with users <code>A</code>, <code>B</code>, and <code>C</code>, and objects <code>X</code>, <code>Y</code>, and <code>Z</code>.</p>
<p>We can create ACLs by looking "down" the column for each object, and we can create C-lists by looking "across" the row for each user.</p>
<h2>ACL Implementation</h2>
<p>Since an ACL determines who can access a resource that needs to be protected, ACLs must be stored in the kernel. Otherwise, any untrusted application could change access rules arbitrarily.</p>
<p>Within the kernel, one natural place to store an ACL for a resource is the same place that we store other metadata for that resource.</p>
<p>For example, a file has a bunch of metadata associated with block locations and file size and so forth, so storing the ACL with this metadata seems logical.</p>
<p>When a request for an object occurs, the operating system must traverse the ACL to determine if an <strong>access control entry</strong> (ACE) is present for the requesting user and, if so, whether the requested action is permitted.</p>
<p>For example, if user <code>A</code> is trying to read file <code>F</code>, the operating system must retrieve the ACL for <code>F</code>, find the ACE for <code>A</code> and check to see whether the "read" operation is present in the list of authorized operations.</p>
<h2>C Lists Implementation</h2>
<p>A capability is an unforgeable handle for a resource, which a user can present to the system to gain access to the resource. A capability is essentially a token that proves that a user has been given permission to access a resource.</p>
<p>Since capabilities have this unforgeable requirement, they must be stored in the kernel. Unlike ACLs, they are not going to be stored with resources themselves, since they are not scoped to individual objects.</p>
<p>Instead, the kernel must maintain a user catalogue of capabilities that defines what any particular user can access.</p>
<p>In some cases, a C-list can be stored in the objects or resources themselves, as was in the case in the <a href="https://en.wikipedia.org/wiki/Hydra_(operating_system)">Hydra</a> operating system from Carnegie Mellon, but this is less common.</p>
<p>How can authorizations be shared?</p>
<p>In the case of ACLs, a user who has permission to grant access to a resource can make a system call and authorize that access for another user. The operating system will create a new ACE for the newly authorized user and add it to the ACL for the resource.</p>
<p>For C-lists, sharing requires propagation of capabilities from one user to another.</p>
<p>Possession of a capability means that you can access the resource. There is no system-level access check as is the case with ACLs.</p>
<h2>ACL and C Lists Implementation: ACL vs C list</h2>
<p>If we are developing a new operating system, should we use ACLs or C-lists? What are the pros and cons of choosing one over the other?</p>
<h3>Efficiency</h3>
<p>With ACLs, the system needs to traverse the ACL in order to find an ACE corresponding to the user who made the request. There is some processing overhead associated with this traversal.</p>
<p>With capability lists, the mere presentation of a capability is sufficient to access a resource. The system does not have to perform any further checks.</p>
<p>In this manner, C-lists are more efficient than ACLs.</p>
<h3>Accountability</h3>
<p>If you want to know all of the users that have access to a particular resource, you can do this really easily with an ACL since, by definition, it contains the list of users and authorized actions for a given resource.</p>
<p>To determine the same information using C-lists, the system will need to look in every user catalogue and extract the authorizations for the resource in question.</p>
<p>Because of this, accountability is more transparent with ACLs.</p>
<h3>Revocation</h3>
<p>Revocation refers to removing access to a given object for a given user after some initial access has been granted.</p>
<p>Alice can easily revoke Bob's access to file <code>foo</code> if ACLs are used. She can simply make a system call, and the system will locate the ACL for <code>foo</code>, find the ACE corresponding to Bob, and remove the appropriate permission.</p>
<p>For C-lists, Alice can't remove permissions from Bob's catalogue at will.</p>
<p>Revocation is easier to perform using ACLs.</p>
<h2>ACE Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/38DA4583-E908-4834-A4A8-A30FB65A2754.png" /></p>
<h2>ACE Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/89BFDAE7-ED13-41D6-BB4C-01D5948DD108.png" /></p>
<p>The presentation of the ticket is sufficient to gain access to the theater. No other access checks are required. This is closest in functionality to a capability.</p>
<h2>ACE Access Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/790A92B9-8315-4A52-8B83-9F7CF9F33947.png" /></p>
<h2>ACE Access Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0D94E256-D8D9-4BCE-9E83-F7BFD18F7E20.png" /></p>
<p>Negative access rights supersede positive access rights, so you can't terminate as soon as you find a positive access right. You can terminate as soon as you find a negative access right, though.</p>
<p>NB: The third option can't be true if the second option is true.</p>
<h2>Revocation of Rights Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/99C6BB65-DB67-42A9-A133-484EAEC0498C.png" /></p>
<h2>Revocation of Rights Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/06734230-A91A-4DCB-BBC0-35AF61DC9A09.png" /></p>
<h2>Access Control Implementation Part 1</h2>
<p>In Unix, every resource that needs protection is represented as a file.</p>
<p>All users in Unix systems have a unique user id (UID). Users can belong to groups, which each have their own group id (GID). There is a special <em>world</em> group which contains every user in the system.</p>
<p>Since resources are files, they can be read, written or executed.</p>
<p>In the access control matrix, each row corresponds to each entity in the system: each UID, each GID, and the special world group. Each column corresponds to each file in the system. Each entry will be a subset of read/write/execute.</p>
<p>The original ACL implementation in Unix systems had a compact, fixed size representation representing the read, write, and execute permissions for the user, the group, and the world.</p>
<p>These three ACEs were represented as a nine bit mask such as <code>111110100</code>. You may have seen this mask in a slightly different format: <code>rwxrw-r--</code> if you have ever run the <code>ls -l</code> command on your Unix machine.</p>
<p>This ACL structure is limited in its flexibility since it provides only three levels of authorization granularity.</p>
<p>Modern operating systems - Linux, BSD, MacOS - provide full ACL support in order to make access control as flexible as necessary.</p>
<h2>Access Control Implementation SetUID</h2>
<p>Consider the following scenario.</p>
<p>Alice owns an executable file that launches a computer game. Alice also owns a text file that contains the scores of the users playing the game.</p>
<p>Alice wants to allow any user to execute the game file, but wants to restrict write access to the score file unless the game is being played.</p>
<p>We can solve this problem with the <strong>setuid</strong> bit. If this bit is set on an executable file, a process executing this file takes on the <em>effective user id</em> of the owner of the file - not the current user - for the duration of the execution.</p>
<p>In other words, when Bob runs Alice's game, the process that is created by Bob has Alice's UID associated with it. This means that Bob can access the score file - which Alice owns - while he plays the game so he can record his scores.</p>
<p>Since the effective UID is set on a per-process basis, this temporary privilege will go away once Bob closes the game.</p>
<h2>Access Control Implementation Part 2</h2>
<p>A file can be opened with the <code>open</code> system call. If the file doesn't exist, this call will create the file and then open it.</p>
<p>The <code>open</code> system call takes two arguments: the name of the file and the mode in which you want to access the file. The mode can be read or write, for example.</p>
<p>Once we open a file, the operating system returns a <em>file descriptor</em>, which is a small integer. In order to read, write or close a file, we need to pass this descriptor back to the operating system.</p>
<p>If you want to read a file, you can pass the file descriptor to the <code>read</code> system call. The call to <code>read</code> takes two arguments: the buffer into which you wish to read the data, and the number of bytes you wish to read.</p>
<p>Similarly, there is a <code>write</code> system call, which writes a supplied number of bytes from a supplied buffer back into the file referenced by the file descriptor.</p>
<p>When you are done with the file, you can close it with the <code>close</code> system call, which also takes the file descriptor as an argument.</p>
<p>Read more about <a href="http://man7.org/linux/man-pages/man2/open.2.html">open</a>, <a href="http://man7.org/linux/man-pages/man2/read.2.html">read</a>, <a href="http://man7.org/linux/man-pages/man2/write.2.html">write</a>, and <a href="http://man7.org/linux/man-pages/man2/close.2.html">close</a>.</p>
<h2>How does the OS Implement ACL?</h2>
<p>What happens when you open a file?</p>
<p><img alt="" src="https://assets.omscs.io/notes/4BE62145-B4CD-4EFC-A74F-8E37C7BD64AE.png" /></p>
<p>When we execute the <code>open</code> system call, the very first thing that happens is that we switch into kernel mode and start executing from within the operating system.</p>
<p>Every file has metadata associated with it. This metadata can contain disk block locations, file size, file name, and the ACL.</p>
<p>The data structure that contains this metadata is referred to as an  <a href="https://en.wikipedia.org/wiki/Inode">inode</a>  on Unix systems, and the operating system maintains a table of inodes for all of the files in the system that are actively being accessed.</p>
<p>When we attempt to open a file, the operating system will check the inode table to see if there is an entry for the given file. If not, the operating system will create an entry for that file.</p>
<p>Once the inode for the file is located, access control is performed. The system will locate the ACL and will decide whether to grant access or not based on the bits present in the ACL and the mode in which the user is requesting to open the file.</p>
<p>If the system determines that access should not be granted, the requesting process is not given with a file descriptor.</p>
<p>If the system determines that access should be granted, it will create an entry in another table, the per-process <em>file descriptor table</em>. This table holds pointers to the inode table and contains all of the files currently being accessed by the given file.</p>
<p>The file descriptor returned from this call is nothing more than an index into that table.</p>
<p>What is important to understand here is that after the file descriptor is returned, there are no subsequent access checks. If your permissions to read a file are removed after you have opened a file for reading, you can continue reading using that file descriptor.</p>
<p>Of course, if a process opens a file for reading and then tries to write to the file, the system will prevent it.</p>
<h2>Time to Check vs Time to Use Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/252D27FB-9B58-4DCD-AE9C-6D6B7C3143E9.png" /></p>
<h2>Time to Check vs Time to Use Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B464C794-6718-40DB-BDAB-EAA956AD1C13.png" /></p>
<p>As long as you had the permissions when you called <code>open</code>, you can access the file using the file descriptor.</p>
<h2>Unix File Sharing Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/88897E9D-9338-459B-B582-7A87A6EB74E6.png" /></p>
<h2>Unix File Sharing Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/8E7ED659-B2F6-4823-A54F-C312F6110482.png" /></p>
<p>You would need to somehow add the descriptor to the per-process descriptor table for the process with which you wish to share the descriptor. Since the OS owns this table, mutating it is impossible.</p>
<h2>SetUID Bit Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/71AAA4B5-5DD3-414A-8317-8BB17007E533.png" /></p>
<h2>SetUID Bit Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/E2739829-4308-4DBE-8C7D-0AAF1025E54E.png" /></p>
<p>The effective UID of a process executing a file with the setuid bit set is the owner of the file, not the user who created the process.</p>
<h2>Role Based Access Control</h2>
<p>Some systems use <strong>role-based access control</strong> (RBAC). In RBAC, the rights to access certain resources are associated with roles instead of users.</p>
<p>Once a user authenticates with the system, they can take on one or more roles that allow them to interact with the system in certain ways.</p>
<p>A role is often closely linked to job function. For example, people in payroll might assume a role that allows them to access salary data, while engineers might have a role that allows them to deploy code.</p>
<p>A user can have more than one role. The employees described above might take on a general employee role which allows them to connect to a local intranet or access a company directory.</p>
<p><a href="https://en.wikipedia.org/wiki/Security-Enhanced_Linux">Security-Enhanced Linux</a> (SELinux) supports RBAC.</p>
<h3>RBAC Benefits</h3>
<p>Since the policy defines which roles have access to which resources, the policy doesn't need to change when any one user leaves the organization.</p>
<p>In addition, a new employee can easily be set up. Instead of having to assign them individual privileges one by one, a system administrator can assign them to one or more roles and instantly grant the appropriate amount of access.</p>
<p>In these regards, RBAC makes policy administration simpler.</p>
<h3>Least Privilege</h3>
<p>Remember, <em>least privilege</em> is the idea that a user should always execute with the smallest number of privileges or access rights needed to complete a task.</p>
<p>The point of least privilege is really damage containment. If something goes wrong, a user can't damage resources that they had no business accessing in the first place.</p>
<p>In RBAC, a user can start in one role and access a subset of the files that are only available to that role. At a later point, the user can switch roles and access a different set of files associated with the new role.</p>
<p>Without roles, a user just has static access to the complete universe of things they would ever need to access. Roles allow for much tighter access control scoped by functionality.</p>
<h2>RBAC Benefits Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/D1B82974-ED31-4162-B636-012F375BCE35.png" /></p>
<h2>RBAC Benefits Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/01A48AF0-F1FD-4085-A588-4BA0C746FE0C.png" /></p>
<h2>Access Control Policy Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/7221A53F-3B6C-4CA2-9738-3A63FCA7CEFA.png" /></p>
<h2>Access Control Policy Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/5DEE9998-897C-4B46-8565-A383DD6FC069.png" /></p>
<h2>From a security standpoint, denying access is a fail-safe default. It never fails to keep your system secure.</h2>
<p>id: information-security-authentication
title: Authentication
course: information-security
lecture: authentication</p>
<hr />
<h1>Authentication</h1>
<h2>What is Authentication?</h2>
<p>We can understand the importance of authentication by going back to the conversation about trusted computing bases.</p>
<p>We have resources that need to be protected, and we can achieve this protection by using a trusted computing base that serves as a reference monitor.</p>
<p>Every request for every resource must be monitored, and the trusted computing base has to determine whether to accept or deny each request.</p>
<p>In order to make this decision, the TCB has to know the source of such requests, and <strong>authentication</strong> is the mechanism by which these sources are identified.</p>
<p>The first step in authentication is identification. Of course, a requestor cannot just claim whatever identity they'd like. As a result, the second step in authentication is identity verification.</p>
<p>For a concrete example, we identify ourselves when we supply our username to a login form, and we verify that identity when we supply our (secret) password.</p>
<p>Once we establish the source of a request, the next step is <strong>authorization</strong>. In authorization, the operating system decides whether the source of the request has the permission to access the resource they are requesting.</p>
<p>Once authentication and authorization are complete, then the operating system can allow access to the protected hardware resources.</p>
<p><img alt="" src="https://assets.omscs.io/notes/A30BC14D-0AD8-446B-B81B-DE77032DFF5D.png" /></p>
<p>The operating system needs to know who is making a request for a protected resource.</p>
<p>In a computer system, a request comes from a process, and each process runs on behalf of a certain user (also referred to as a <em>subject</em> or <em>principal</em>) within that computer system.</p>
<p>Therefore, authentication helps us answer the question: on whose behalf is the requesting process running?</p>
<p>We can answer this question with authentication. Before a user is allowed to interact with a computer system, they must first authenticate themselves - by logging in, for example.</p>
<p>Once authenticated, the OS is able to link any subsequent process or application resource requests back to the authenticated user.</p>
<h2>Authentication Goals</h2>
<p>When a legitimate user tries to authenticate herself, the system can demand some evidence, but when the right evidence is provided the system should allow the login to complete successfully.</p>
<p>This is called <strong>availability</strong>. The system is available to the user who is able to provide the sufficient evidence to support their claim to their identity.</p>
<p>In other words, we don't want to have any <em>false negatives</em>. This means that we don't want to have the situation where we deny access to a user who has provided sufficient evidence that they are who they claim to be.</p>
<p>On the other hand, we don't want to have a system that allows a malicious user to successfully impersonate a valid user.</p>
<p>In other words, we don't want to have any <em>false positives</em>. This means that we don't want to have a situation where we grant access to someone who is not who they claim to be.</p>
<p>Authentication systems that have low false positive rates are said to have <strong>authenticity</strong>. That is, these systems ensure that they only authenticate users with authentic claims to their identity.</p>
<h2>Authentication Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/196A1024-D729-4CE2-BA23-5C8D8CD10B6B.png" /></p>
<h2>Authentication Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/57996615-B926-4F51-BF29-E3372F1A5C63.png" /></p>
<p>If someone steals your phone, you will be thankful for your lock screen/passcode.</p>
<h2>How is Authentication Implemented?</h2>
<p>There are three basic methods for implementing authentication.</p>
<p>Authentication can be implemented using something a user knows. This could be a secret shared by the user and the operating system - a password, for example. The fact that a user is able to produce this secret during authentication is evidence that they are who they claim to be.</p>
<p>Authentication can also be implemented using something that the user has. For example, possession of a token or a smart card may be sufficient as a means of identity verification for some systems.</p>
<p>Finally, authentication can be implemented using something that the user is. For example, a system may be able to authenticate a user by digitizing and processing his or her fingerprint or voice. Such biometric data must be unique to each user for this scheme to be useful.</p>
<p>Here is a diagram illustrating the basic steps in an authentication interaction between as user and a system.</p>
<p><img alt="" src="https://assets.omscs.io/notes/B148F4BD-E1C1-4E73-A1DD-37918E708306.png" /></p>
<p>The user first comes to the system and requests access to it. In this request they claim an identity and provide a means of verifying that identity.</p>
<p>The operating system can take the supplied authentication information check it against stored information for the claimed identity.</p>
<p>If there is a match between what the system knows and what a user provides, then the user is authenticated, and a user shell is created.</p>
<p>If the check fails, then the system believes that the user has not provided the correct information. If so, the identity being claimed probably doesn't belong to the user who is asking for authentication.</p>
<p>In this case, the system doesn't have the right match and authentication fails.</p>
<h2>Login Attacks Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/5A9CA9D1-FD6A-413F-9DF6-43B0D94BBE71.png" /></p>
<h2>Login Attacks Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/DBB01EA0-AF2A-4894-96DF-5D34EEC42A10.png" /></p>
<p>Remember, the positive event is gaining access to the system. A false positive is gaining access erroneously. An attacker authenticating as someone else is a false positive.</p>
<h2>Implementation Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6E147430-22A9-4286-A6F3-475688360A5A.png" /></p>
<h2>Implementation Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/CC89677E-5EA4-41E8-899B-5697A658BA99.png" /></p>
<h2>Threat Modeling of the Password Method</h2>
<p>How can we attack password-based authentication?</p>
<p>A password is a secret shared between a legitimate user and the system, but that doesn't mean an attacker can't try to guess it. As obvious as it may seem, using common or weak passwords presents a real vulnerability in authentication systems.</p>
<p>When you authenticate with a computer system, how do you know that you are really talking to the system instead of a program that is impersonating the system? A hacker can create a fake login program and then steal your credentials as you type them in.</p>
<p>Finally, an attacker may install malicious software called a <a href="https://en.wikipedia.org/wiki/Keystroke_logging">keylogger</a> onto your machine, which will record all of the keyboard keys that you press. Keyloggers can be used to steal your password without have to impersonate the login program.</p>
<h2>Importance of a Trusted Path</h2>
<p>When using a trusted path, a user can have confidence that there is no application between the user and the operating system.</p>
<p>The hardware and the operating system work in tandem to provide a trusted path.</p>
<p>For example, to login to windows systems you have to press the key sequence CTRL-ALT-DEL. This sequence can't be trapped by any other program besides the operating system. Thus, you can be confident that you are communicating directly with the operating system after pressing this sequence.</p>
<p>In addition, the display and keyboard must be connected to the CPU on which the operating system is running, in a way in which there is no one in between. As I/O devices, they need to be using their own trusted path to the OS.</p>
<p>Sometimes, visual feedback can be provided to assure the user that they are using the trusted path, such as a certain type of display on a computer monitor or a light on a keyboard.</p>
<h2>Password Popularity Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/7E55E7C7-D42D-49D1-8BD8-426BFA142037.png" /></p>
<h2>Password Popularity Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3F2C0344-3371-466B-B6CF-D7D1E177661C.png" /></p>
<p>If we are attacking systems, we might get the best bang for our buck trying these passwords.</p>
<h2>Implementing Password Authentication</h2>
<p>When a user authenticates with a computer system, they must supply their identity and some verification of that identity. In password-based systems, this verification is the user's password.</p>
<p>When a user supplies their password to a computer system, the system then has the task of verifying that this is the correct password for this user.</p>
<p>How does the system know the user's password? One solution is to ask users to share their password with the system when they create their account. This is known as <strong>enrollment</strong>.</p>
<p>After enrollment, how does the system store the password?</p>
<h3>Method 1</h3>
<p>The system can persist user passwords in  plaintext in a system file. All the system has to do is compare the supplied password against the stored password.</p>
<p>As a basic security measure, the file should only be readable by the root/admin user, which is the user on whose behalf the login program runs.</p>
<p>What if permissions are set incorrectly? If so, someone else may be able to read that file and learn everyone's password.</p>
<p>Even if the permissions are set correctly, why should the admin know the passwords? If an attacker can impersonate the root user, they can learn all the passwords.</p>
<p>It's clear that something about the secret has to be shared with the system, but storing those secrets in a file as plaintext - even with access control - is not a good idea.</p>
<h3>Method 2</h3>
<p>Alternatively, the system don't store the passwords themselves, but rather stores something derived from them.</p>
<p>We can pass the password through a <strong>one-way hash function</strong> to create this derived value.</p>
<p>Hash functions are often used to take an arbitrary length input and produce a fixed-size output that is fairly unique to the input.</p>
<p>A one-way hash function means that it is easy to compute the hash value given the input, but it is very difficult to recreate the input given the hashed value.</p>
<p>During enrollment, the system applies the hash function to the supplied password and writes this value to the file. When a user later comes to authenticate, the system hashes the supplied password and checks that value against the persisted hash value.</p>
<p>The benefit of this approach is that if an attacker steals this file they cannot compromise any user accounts because they can't recreate the original passwords.</p>
<p>Even so, these password files should still only be readable by the root user.</p>
<h2>Hash Functions</h2>
<p>A hash function takes a variable length password and outputs a fixed-length hash value.</p>
<p>A hash function is a one-way function, which means that it is very difficult to invert. In other words, it's easy to compute a hash given an input, but it's very difficult to recreate an input given a hash.</p>
<h3>Hash Functions and Threats</h3>
<p>We assume that the one-way property of hash functions holds, so hash function inversion is not a threat.</p>
<p>One vulnerability present in authentication systems that use hash functions is users using common passwords.</p>
<p>Since the hash functions being used are well-known (remember security by obscurity is not a thing), an attacker can easily compute the hash of well-known password values.</p>
<p>If the attacker can get ahold of the system password file, they can hash common passwords and check the hashes against the file.</p>
<p>For example, if the password file contains the hash value 'abcdef' for Bob's account, and the attacker determine that passing '123456' through the hash function yields 'abcdef', then the attacker knows that Bob's password is '123456'.</p>
<p>In a <strong>dictionary attack</strong>, a malicious user passes a large dictionary of common passwords - with some common mutations - to a series of hash functions in order to match against a stolen password file.</p>
<p>Dictionary attacks are examples of an <strong>offline attack</strong>, whereby the malicious user is not interacting directly with the system. When the user interacts with the system - a so-called online attack - the system can block subsequent login attempts after some number of failed attempts.</p>
<p>In offline attacks, the attacker has plenty of time to test a wide value of common passwords and hash functions against a stolen password file.</p>
<h2>Password Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/24F5D97B-1D55-46CD-B2D8-8E795B30BA8F.png" /></p>
<h2>Password Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/31FE2544-CBD2-4906-B310-7F05DC21E645.png" /></p>
<p>A trusted path ensures that there is no application between the user and the operating system. Without this path, malicious programs may intercept login credentials.</p>
<h2>Hashed Passwords Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/C4A2AD00-738F-455D-830F-718C3ED2205D.png" /></p>
<h2>Hashed Passwords Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2F6B2EAE-5899-4DE4-B41A-49697B251132.png" /></p>
<h2>Hash Function Characteristics Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3F37F04D-3EC1-4EA7-A0F4-C3EE3098D70D.png" /></p>
<h2>Hash Function Characteristics Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/245963DD-ABEE-4364-96FA-16B7753AAD9C.png" /></p>
<h2>Brute Force Guessing of Passwords</h2>
<p>If an attacker has a system password file, how hard is it for them to brute force hash every single possible password?</p>
<p>There is publicly available software that can compute <code>10^8</code> <a href="https://en.wikipedia.org/wiki/MD5">MD5</a> hashes per second using a <a href="https://en.wikipedia.org/wiki/Graphics_processing_unit">graphical processing unit</a>, a piece of hardware which is particularly well-suited for performed hashing calculations.</p>
<p>If the password is only six random alphanumeric characters (A-Z, a-z, 0-9), then the space of possible passwords is <code>62^6</code>. There are 62 (26 + 26 + 10) possible characters for each position in the password, and there are 6 positions.</p>
<p>Using the above software, it will take <code>62^6</code> / <code>10^8</code> seconds - about ten minutes - to compute hashes for all possible passwords in that space.</p>
<p>If we increase the size of the password to eight random characters, the space grows from <code>62^6</code> to <code>62^8</code>, increasing the computation time from ten minutes to about twenty-five days.</p>
<p>Regardless, this is not an unfeasible amount of time for a hacker to wait while a program exhaustively searches a password space.</p>
<p>As a fun aside: increasing the password length to nine random characters increases the search time to 4.29 years, and increasing it to ten random characters increases the search time to 266 years.</p>
<h2>Passwords are not Really Random</h2>
<p>Passwords are not really random, so when an attacker is trying a brute force attack, they don't have to search for things in a completely random manner.</p>
<p>A smart attacker will try popular passwords first - for example, "password" and "123456" - in order to reduce the amount of work that they have to do.</p>
<p>An attacker can create a <strong>rainbow table</strong> mapping potential passwords to their hash values. With this table, the attacker doesn't even need to perform the hashing directly. Instead they can just lookup hash values from the password file and see what password maps to those hash values.</p>
<p>What if two users pick the same password? This is not an unlikely occurrence, given the popularity of a relatively small set of common passwords.</p>
<p>If multiple users use the same password, the hash values will be equal. This means that if an attacker compromises one of these accounts, they instantly compromise all of them.</p>
<p>To avoid this situation, we can add a <strong>salt</strong> - a random number - to each password before we hash it. Since the salt is randomly selected during enrollment, the salt and therefore the hash for users with the same password will be different.</p>
<p>Since the hashed value is derived from the salt and the password, the salt must be stored in the password file with the hashed value.</p>
<h2>Brute Force Figure</h2>
<p><img alt="" src="https://assets.omscs.io/notes/85645D9B-66D3-4EE4-86A6-A71645CCAC9D.png" /></p>
<p>An enrolled user attempts to authenticate with the system by supplying a user id and a password.</p>
<p>The system indexes into the password file using the supplied user id in order to get the correct entry. This entry contains the user id, the salt, and the hash value.</p>
<p>The system then takes the supplied password, and the saved salt, and runs them both through the hash function. If the resulting hash value matches the hash value in the entry then access to the system is granted.</p>
<p>It is important to note that the hash function used by the system is intentionally slow. This is done to ensure that brute force attacks take much longer.</p>
<h2>Unique PINS Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/C7E9CD09-30CD-4A70-A3E8-12CA15DB1769.png" /></p>
<h2>Unique PINS Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B3B14694-D6EC-4C26-B0F3-C00DBB302AB8.png" /></p>
<p>With ten options for the first digit, ten options for the second digit, and so on, the total number of four digit pins is 10 * 10 * 10 * 10, or <code>10^4</code>, or 10,000.</p>
<h2>Brute Force Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F88846E5-1F09-4695-9ABA-9C6786066E21.png" /></p>
<h2>Brute Force Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0EA2B5B0-F329-4B96-80EA-1BF697743D43.png" /></p>
<p>With 72 options for each other six characters, the total number of unique passwords is 72^6, which is the number of attempts the hacker will have to make in the very worst case.</p>
<h2>Touch Screen Passwords Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/AB789F7E-C3A5-4938-B5C9-58BF3C3424D9.png" /></p>
<h2>Touch Screen Passwords Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/D02FF363-D3A3-4D71-B4E6-E5A137CE04A8.png" /></p>
<p>Basically, the idea here is that attackers will likely not have to exhaustively search the space of possible patterns because biases exist that greatly shrink this space into a much smaller space of much more probable patterns.</p>
<h2>Problems with Passwords</h2>
<p>Although we use passwords all the time, there are plenty of problems with passwords.</p>
<p>For passwords to be strong - that is, harder to crack - they need to be long and complex. This increases the size of the space that attackers need to search, but it also increases the complexity for users, at the expense of usability.</p>
<p>Even with strong passwords, there are problems that are related to the trusted path. When a system asks you to authenticate yourself, how do you know the system is not being impersonated? <strong>Phishing</strong> and <strong>social engineering</strong> attacks arise from users not authenticating the entities trying to authenticate them.</p>
<p>Unfortunately, once a password is stolen, it can be used many times because a password grants continual access. We can address this by having polices that enforce frequent password change, but again this hurts usability.</p>
<p>Finally, humans have a hard time remembering many different passwords for all of the different accounts they may have. As a result, people will often choose simple passwords that are easy to remember - and guess - and reuse these passwords across accounts.</p>
<h3>Best Practices for System Administrators</h3>
<p>Never store plaintext passwords. Instead, store only hashed values generated with a random salt and limit access to password file where the hash value is stored.</p>
<p>Use a slow hash function. They system has to execute this function only once when the user logs in, so speed is not crucial for this use case.</p>
<p>On the other hand, someone running a brute force attack will execute the function again and again, and a slow hash function will slow their attack down.</p>
<h3>Best Practices for Users</h3>
<p>Use a password manager to generate and maintain complex passwords for the services you use. Make sure to use a strong password for the password manager itself.</p>
<h2>Something You Have Authentication</h2>
<p>Since passwords have problems, we can look at other authentication strategies.</p>
<p>We can authenticate users based on something they have - such as a smart card or a token - instead of using something they know, like a password.</p>
<p>How is authentication implemented with a smart card?</p>
<p>Often, the authentication flow will include a <strong>challenge-response</strong>. In challenge-response the system may send some sequence of characters to the token, and the token will send back a response based on this challenge. This response can be the same sequence encrypted with the token's private key, for example.</p>
<p>Thus, the system can authenticate the smart card and, by proxy, the user in possession of the smart card.</p>
<p>One obvious ramification of this approach is that the users must be in physical possession of the smart card in order to authenticate. If you leave your smart card at home, you'll have to go back at get it.</p>
<p>In addition, a smart card needs special hardware - such as a card reader - installed in order to communicate with the system. This added requirement adds cost to the implementation of this type of authentication system.</p>
<p>Another problem with this approach is misplaced trust. For example, the <a href="https://en.wikipedia.org/wiki/RSA_SecurID#March_2011_system_compromise">RSA SecureID system breach</a> created a situation in which tokens could potentially be forged by attackers.</p>
<h2>Something You Are Authentication</h2>
<p>Finally, authentication can be based on <strong>biometrics</strong> or, more colloquially, "something you are".</p>
<p>For example, a system can look at the pattern of ridges and grooves in a supplied fingerprint to verify a user's identity.</p>
<p>Alternatively, a system can analyze keystroke dynamics, such as how fast a user types or how long it takes a user to transition from certain keys to others. This data can be synthesized to create a representation of a specific user.</p>
<p>(To be fair, keystroke dynamics fall more into the "something you do" category, as opposed to the "something you are" category. Such behavioral identifiers are sometimes referred to as <em>behaviometrics</em>.)</p>
<p>Some systems can analyze the sound and speed of your speech to authenticate you by your voice. Other systems can verify your identity by scanning your retina and measuring the underlying blood flow.</p>
<p>There are many different choices for biometrics, but they should all be unique to an individual. A feature that many people share - such as height in inches - is not a sufficient biometric for the purpose of authentication.</p>
<p>In addition, the biometric recording should be the same during each authentication attempt. Otherwise, the system may deny you access: a false negative.</p>
<p>Of course, this consistency is not always possible. For example, a cold can impact your voice and moisture or swelling can obscure your fingerprint.</p>
<p>Instead of looking for exact measurements when using biometrics, a system might use a probability distribution when verifying identity.</p>
<p>The system will have to pick a certain threshold of similarity by which the false negative rate and the false positive rate are balanced appropriately.</p>
<p>False negatives - denying valid users access - hurts usability while false positives - allowing Alice to authenticate as Bob - is insecure.</p>
<h3>Implementing Biometric Authentication</h3>
<p><img alt="" src="https://assets.omscs.io/notes/25D9B1BF-8B63-4958-9830-CA2335C34FB8.png" /></p>
<p>After a user supplies their identity to a system, the biometric sensors capture the biometric data of interest.</p>
<p>The system then digitizes this data and extracts certain key features to be used for matching.</p>
<p>The extracted features - or some data derived from them - are matched against the stored data for the given user and, if there is a match, the system grants access to the user.</p>
<h2>Other Methods</h2>
<h3>Multi-factor Authentication</h3>
<p>We can combine different <strong>factors</strong> (something you know, something you have, something you are) into a <strong>multi-factor authentication</strong> strategy.</p>
<p>For example, some websites may require you to log-in with your password and then ask you to enter a code that they text to you. The password is something you know, and the code is something you know based on something you have.</p>
<p>Another example is the ATM card and PIN combination required to withdraw money from the bank. The card is something you have and the PIN is something you know.</p>
<p>Other authentication methods can incorporate other factors. For example, a system can use a location-based factor - "somewhere you are" - by examining IP addresses in network requests.</p>
<p>Multi-factor authentication makes it harder for attackers to impersonate users.</p>
<h3>Authentication over a Network</h3>
<p>When we are authenticating with services over the open Internet, we no longer have the trusted path to the OS authenticating us.</p>
<p>Cryptography helps secure network communication through encryption and shared secrets. Of course, this doesn't help against certain <em>man-in-the-middle</em> attacks.</p>
<h2>Multi-factor Authentication Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/41CFA250-2487-4089-A2D7-D01CC482495F.png" /></p>
<h2>Multi-factor Authentication Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/CC9A6A59-47B9-465A-BCAD-4F0257BE84A5.png" /></p>
<p>Remember, a false positive occurs when a malicious user is granted access to the system as a valid user. The likelihood of this happening decreases when multiple authentication components are employed by the system.</p>
<h2>Chip and Pin Authentication Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/77924BCE-4594-4893-B02E-08E46A624821.png" /></p>
<h2>Chip and Pin Authentication Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/4668FB80-8C96-4083-A753-7E4A41F8CC1D.png" /></p>
<p>Read more <a href="http://www.darkreading.com/vulnerabilities---threats/flaws-in-emv-chip-and-pin-undercut-security/d/d-id/1269155">here</a> and <a href="https://www.schneier.com/blog/archives/2014/05/preplay_attack_.html">here</a>.</p>
<h2>Biometric Authentication Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3D51F432-5BE0-41DC-BCE5-243BEEF20CA6.png" /></p>
<h2>Biometric Authentication Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/62C0DA99-A728-42B8-867F-D0FB6CEB9DA2.png" /></p>
<h2>As a basic example, consider someone recording your voice and playing it back to a voice-based authentication system.</h2>
<p>id: information-security-cyber-security
title: Cyber Security
course: information-security
lecture: cyber-security</p>
<hr />
<h1>Cyber Security</h1>
<h2>Managing Security</h2>
<p>The digital components of a business - be they routers, operating systems, or databases - are crucial to successful business operation. A business must implement appropriate security measures to protect these assets against malicious actors attempting to gain unauthorized access.</p>
<p>In addition to mitigating explicit threats, companies often secure our digital assets for legal and compliance reasons. For example, HIPAA mandates a process for sharing digital health data. Therefore, an entity that deals with health data may need to implement specific security measures to meet compliance requirements.</p>
<p>We've spent time talking about the various technical controls - such as firewalls, intrusion detection systems, and anti-virus programs - that organizations can use to secure their computer systems.</p>
<p>Of course, a business must first understand the risks that they face and the threat landscape surrounding their organization and digital assets before implementing any security measure.</p>
<p>Additionally, technical implementations carry associated costs, and businesses are wise to ensure that the cost of securing a system does not exceed the value of the system.</p>
<h2>Key Challenges</h2>
<p>A business faces different challenges during the process of building and implementing a cybersecurity plan.</p>
<p>For example, a business must identify their assets and the relative value of these assets. Furthermore, a business must understand which assets are at risk, how severe the risk is, and how threat sources are likely to present themselves.</p>
<p>After a business surveys the security landscape of their organization, they then have to implement the security measures. This implementation step requires awareness of the various security solutions and controls present in the market.</p>
<p>Additionally, organizations must perform a cost-benefit analysis before deploying a particular solution. While a business wants to reduce risk, they likely don't want to spend more than the value of the asset they are protecting.</p>
<p>Finally, a business must understand how the employees operate within the organization and the various workflows that a new security implementation can impact. Employees are likely to skirt security measures that drastically hinder their productivity.</p>
<h2>Network Use Policy Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/C4EF0BE1-E7EB-4EF2-95C7-6C350AE5378A.png" /></p>
<h2>Network Use Policy Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/66481383-5E3B-41E1-8872-16C2F922D983.png" /></p>
<h2>Botnet Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/87796EC7-942D-4C51-A88A-D795E1D08008.png" /></p>
<h2>Botnet Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/BDBF525E-38FC-4589-B8F9-5D60D9BFC8ED.png" /></p>
<h2>Security Planning</h2>
<p>So far, we've identified the assets that need protection, determined the parties responsible for understanding the security needs of the organization, examined the technical controls at our disposal, and understood the impact of different implementations on user workflow.</p>
<p>During the process of security planning, a business has to understand that no matter how well they deploy their security, they can never reduce the risk to zero. Therefore, the planning process needs to cover response and recovery as well as prevention and detection.</p>
<p>One component of incident response is accountability. When an incident occurs, the business needs to understand which responsibilities were not fulfilled and take steps to hold the appropriate employees accountable.</p>
<h2>Assets and Threats</h2>
<p>A business must take inventory of their assets to understand which assets are valuable. These assets include servers, routers, switches, laptops, and mobile devices.</p>
<p>In addition to the physical assets themselves, a business needs to consider the software utilized by these assets; for example, the operating systems running on the servers, laptops and mobile devices; the databases that store large amounts of data, and; the services and applications running on these devices.</p>
<p>The organization must concern themselves with the data stored in the system, whether structured data that lives in databases or unstructured data in files in the filesystem. Some of this data, such as intellectual property, financial records, or customer information, can be sensitive and, therefore, may require additional security measures.</p>
<p>Assets only require security if they are at risk, so a business needs to understand who they are securing their assets from before implementing security controls. These threat actors could be external cybercriminals, passionate hacktivists, or even disgruntled employees.</p>
<h2>Security Audit Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A0ACD1BC-3257-4E9D-B658-A38F2341B6D9.png" /></p>
<h2>Security Audit Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/955B7AA6-8925-4060-90FD-B15F77C7640A.png" /></p>
<p>NOTE: answers 1 and 3 are correct.</p>
<h2>CISO Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/44C4B128-D47A-4F43-AEFB-8AC2A7DF7355.png" /></p>
<h2>CISO Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6739A49C-41D1-4773-AB37-B79A90468145.png" /></p>
<h2>Security Planning: Controls</h2>
<p>Security planning involves understanding which security controls make the most sense for a given organization's assets and threat posture. Let's take a look at a few of these controls.</p>
<p><strong>Identity and Access Management</strong> (IAM) is a popular security control. The "identity" part of IAM serves to identify a user who is requesting any type of resource present in the system. The "access management" component of IAM serves to perform access control on the resource, ensuring that a user has sufficient permission to access the resource they have requested.</p>
<p>Credentialing is another security measure that concerns resource access. When a business provides a user with a credential, the credential serves as a proxy for the user's identity, allowing them to access resources without explicitly identifying themselves each time.</p>
<p>A business may have certain password policies, which dictate how long a password must be and how frequently a password needs to change. Additionally, some organizations may require multi-factor authentication; for example, a user may need to use a password and a smart card to access specific resources.</p>
<p>A business can deploy network and host defenses to protect their resources. For example, firewalls control the traffic that enters and exits a network, and intrusion detection systems and intrusion prevention systems monitor the traffic at the network level and raise alarms when they detect suspicious activity. Anti-virus systems running on local machines help control which external software a user can download and run.</p>
<p>If employees need to access critical systems from external networks, a business may require a VPN solution to tunnel business traffic through these networks securely. Additionally, organizations that permit employees to bring their own devices need to have a plan for securing those devices.</p>
<p>New vulnerabilities are found in software all the time. A business must have a strategy for discovering vulnerabilities and patching them in a timely fashion.</p>
<p>Besides deploying technological controls, a business can also look at employee education. For example, many companies periodically run fake phishing campaigns to show employees what a real phishing attack might resemble. Educational exercises like this can supplement purely technical security solutions.</p>
<h2>Security Planning: Security Policy</h2>
<p>Security planning requires that a business develops a security policy. A <strong>security policy</strong> articulates the security objectives and goals of an organization, and specifies the rules the organization needs to implement to achieve those objectives.</p>
<p>A security policy often incorporates legal, compliance, and business rationale for the rules it chooses to implement. Security policies may concern prevention and detection, as well as recovery and response.</p>
<p>An organization might have many security goals, such as</p>
<ul>
<li>preventing unauthorized data disclosure</li>
<li>ensuring system availability</li>
<li>guarding against data corruption</li>
<li>abiding by compliance requirements</li>
</ul>
<p>To achieve these goals, an organization must implement certain rules. For example, many companies have web and email policies that restrict the use of these facilities from within the corporate network. A web policy may dictate which sites an employee can visit, while an email policy may restrict a user from corresponding with certain addresses or opening certain attachments.</p>
<h2>Georgia Tech Computer and Network Use Policy</h2>
<p>Like many organizations, Georgia Tech (GT) has a security policy, the <a href="https://policylibrary.gatech.edu/information-technology">Computer Network Usage and Security Policy</a>. One guiding principle of this policy is to protect valuable IT resources that GT owns, including the data stored on and services used by these resources. Another guiding principle is to prevent any illegal activity from taking place on GT networks and devices.</p>
<p>You can read the entire policy by clicking the link above. We cover a few interesting highlights here.</p>
<p>The policy talks about intellectual property and copyright. As a research institution, GT creates intellectual property that resides on their computers and must decide how to store and share that information. Additionally, GT has to explicitly address copyrighted material since many colleges got in trouble in the past when students would use university networks to download illegal music.</p>
<p>GT is home to individuals from all over the world, and many people work with counterparts in other countries. Since working across national boundaries can raise issues related to customs and border control, the security policy must address these issues.</p>
<p>An organization must define responsibility and accountability when creating a security policy. The security planning process must involve identifying who is responsible for what resources and how they should be held accountable for those resources.</p>
<p>The GT policy defines a distributed model of responsibility. The centralized <a href="https://oit.gatech.edu/">Office of Information Technology</a> is responsible for the overall university network. Individual devices, such as workstations, are the responsibility of particular units - the College of Computing, for example - or the individual in possession of the devices.</p>
<h2>Computer Use Policy Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9771E45D-9638-4E05-82F6-A1C10CB72D05.png" /></p>
<h2>Computer Use Policy Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6CEB54B3-7C84-476C-A25E-048670C9DFE2.png" /></p>
<h2>Student Privacy Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0AB2ABF9-9651-4AB1-A084-C5A26D7833A4.png" /></p>
<h2>Student Privacy Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/44B358FC-1EB0-42D2-AC0E-9129A51A793C.png" /></p>
<h2>Anthem Breach Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/D3870811-2400-4AAC-80EC-F6DF688E235F.png" /></p>
<h2>Anthem Breach Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/8785FC32-D688-48B9-935A-B03C867CF522.png" /></p>
<p>Read more <a href="http://blogs.wsj.com/riskandcompliance/2015/03/02/crisis-of-the-week-anthems-breach-response/">here</a> and <a href="http://www.latimes.com/business/hiltzik/la-fi-mh-anthem-is-warning-consumers-20150306-column.html">here</a>.</p>
<h2>Cyber Risk Assessment</h2>
<p>Unless a business disconnects from the rest of the world, they cannot eliminate their risk. Regardless of how well an organization plans or how many controls they implement, the possibility of compromise is greater than zero. Systems have unknown vulnerabilities, and people get phished: something can always go wrong.</p>
<p>A business must perform cost-benefit analyses when planning to implement security controls. An investment in cybersecurity requires money and effort, and the investment decisions must be based on risk and its reduction. A business may want to understand how much risk is reduced, from a financial perspective, as a result of purchasing some security control.</p>
<p>These decisions require businesses to quantify their risk. While various frameworks can help a business reduce relative risk, putting a dollar amount to the overall risk faced by an organization is not an easy task.</p>
<h2>Quantifying Cyber Risk</h2>
<p>When a business wants to quantify risk, they need to consider two things. First, they need to look at the probability of an adverse security event happening. For a given set of assets, threat landscape, and set of security controls, there is some nonzero probability of system compromise. Second, the business must consider the financial impact of the adverse event. For example, a data breach may cost a company $10 million.</p>
<p>For a probability <code>P</code> and impact <code>I</code>, we can define <strong>risk exposure</strong> <code>R = PI</code>. For example, given a 50% chance of an adverse security event that is going to cost $10 million, the risk exposure is $5 million.</p>
<p>An organization wants to reduce their risk exposure, and they can achieve this reduction by implementing security controls. Since every control comes at a cost, an organization is smart to choose those controls that bring the most significant risk reduction relative to the implementation cost.</p>
<p>Given a pre-implementation risk <code>pre</code> and a post-implementation risk <code>post</code> and an implementation cost <code>cost</code> for a particular security measure, we can define <strong>risk leverage</strong> <code>L = (pre - post) / cost</code>.</p>
<p>Naturally, a business wants to choose controls that maximize their risk leverage. Any control under consideration should have a risk leverage higher than one; otherwise, the cost of the control is higher than the amount of risk it reduces.</p>
<h2>Managing Cyber Risk</h2>
<p>Risk assessment is a challenging exercise. A business may not fully be aware of the vulnerabilities present on their systems, and they may be ignorant of the threats seeking to compromise these systems. Without this knowledge, they can only guess at the likelihood of a successful attack.</p>
<p>Instead of trying to understand the probability of an attack, an organization might choose to examine the impact of an attack, which can be vast and expensive. For example, the business might suffer a loss of reputation or a decrease in sales. They may have to spend money to bring in cybersecurity firms for incident management and PR. They may incur legal costs, such as being forced to buy identity theft protection for their customers after a data breach.</p>
<p>After a business performs a risk assessment, they have three choices concerning managing their risk: accept it, transfer it, or reduce it.</p>
<p>Occasionally, a company may decide that both the probability and impact of an attack are so low that they are comfortable with the risk as is. Alternatively, a business may choose to transfer their risk by taking out an insurance policy; that way, if something bad happens, the cost is borne by someone else. Finally, an organization can reduce its risk by deploying new technology solutions, educating their employees, and providing security awareness training.</p>
<h2>Security Breach Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9978A76B-E7AB-47DE-892A-639CCA8A15ED.png" /></p>
<h2>Security Breach Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/CF8998BF-BD44-4ADC-9DCC-4C71DF43014B.png" /></p>
<h2>Reducing Exposure Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3F8AD3EE-7E5F-46F3-8662-D86A7381C385.png" /></p>
<h2>Reducing Exposure Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6EEC39B8-9C40-473C-B2ED-6547F696CFAF.png" /></p>
<h2>Cyber Insurance Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/E2BF4801-6F74-4CD9-8E2A-142E405723DE.png" /></p>
<h2>Cyber Insurance Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A2F22984-714E-452C-8801-507291A5711A.png" /></p>
<h2>Enterprise Cyber Security Posture Part 1</h2>
<p>The whole point of security planning and security management is to become better prepared when it comes to cybersecurity. <strong>Cybersecurity posture</strong> captures this level of preparation; roughly, it refers to how "good" an organization is at cybersecurity. A cybersecurity posture can either be reactive or proactive.</p>
<h3>Reactive</h3>
<p>Unfortunately, most postures are reactive. In other words, an organization worries about cybersecurity because of some external entity or event.</p>
<p>In some cases, organizations have legal or regulatory requirements they must meet. If a new regulation stipulates that a particular change must be made, an organization must abide by that regulation.</p>
<p>Other times, an organization is merely responding to customer demands. If customers or other companies refuse to conduct business with an organization that has lax security, that organization would be wise to adjust their cybersecurity posture.</p>
<p>Organizations also react to adverse security events that they have suffered. A data breach, for example, can serve as an impetus to review and revise security practices.</p>
<p>Organizations may also react to adverse security events that others have experienced. For instance, when a bank suffers a breach, other banks may react by ensuring that the exploited vulnerabilities don't exist in their systems.</p>
<h3>Proactive</h3>
<p>A proactive approach to cybersecurity is best. An organization should conduct an inventory of their assets, assess their risk, plan and analyze, and implement controls that achieve risk reduction, instead of waiting for some external force.</p>
<p>Someone within the company should be worrying about cybersecurity full-time. This individual needs to focus on protecting assets, educating and empowering employees, drafting and maintaining security policies, and holding stakeholders accountable.</p>
<p>Additionally, this individual needs to have influence within the organization, as well as exposure to the highest levels of decision-making. Board-level conversations should address cybersecurity risk and investment, whether in additional personnel or technical controls. Without board-level stakeholders, this individual will struggle to accomplish their goals.</p>
<p>In short, this person, often a Chief Information Security Officer (CISO), must be the cybersecurity champion within the organization and use their expertise and influence to position the organization to proactively mitigate cybersecurity risk.</p>
<h2>Enterprise Cyber Security Posture Part 2</h2>
<p>A cybersecurity champion, such as a CISO, needs to make their case to upper management to justify the security policies they want to implement. This task can be difficult for two reasons: first, risk is difficult to quantify, and, second, cybersecurity does not make money.</p>
<p>The primary economic argument for cybersecurity is based on return on investment (ROI), not revenue generation. For example, an investment of $5 million in cybersecurity that shields an organization from a $10 million security incident is a worthwhile spend.</p>
<p>Of course, demonstrating this sort of cost-benefit analysis to upper management is difficult. While a CISO would like to quantify risk and risk reduction precisely, exact numbers are notoriously hard to derive. They can present their analyses based on their experience and perception but should be prepared for other leaders to question what they perceive as unsubstantiated opinions.</p>
<h2>Security Planning and Management</h2>
<p><img alt="" src="https://assets.omscs.io/notes/13B63BD1-85AB-4CDD-80A8-AC8B0BA0086C.png" /></p>
<h2>Cyber Security Budgets Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1C6C0BDF-579C-4B4A-89B2-5AE53DE6E845.png" /></p>
<h2>Cyber Security Budgets Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/5F82F572-BDB4-46BD-BC15-382A67CD15C8.png" /></p>
<p>Read more <a href="https://www.partnerre.com/assets/uploads/docs/cyber-survey-results.pdf">here</a>.</p>
<h2>Proactive Security Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/4BEB9B1D-801B-4C94-BDA2-7547458C7620.png" /></p>
<h2>Proactive Security Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/C3D071BA-435F-43EA-ABC8-A3D3D8C417E7.png" /></h2>
<p>id: information-security-database-security
title: Database Security
course: information-security
lecture: database-security</p>
<hr />
<h1>Database Security</h1>
<h2>Importance of Database Security</h2>
<p>Databases store massive amounts of sensitive data. When hackers steal millions of customer records from a company - often containing data like social security numbers, addresses, and credit card numbers - they usually steal this information from one or more databases.</p>
<p>Data often has structure, and databases expose abstractions that help users store their data in structured ways. This data can then be accessed and manipulated using structured queries that we send to the database. <strong>Structured Query Language</strong> (SQL) is a common language for expressing these queries.</p>
<p>Databases store data that is persistent, and the integrity of this data is important. Running a partial query can leave a database in an inconsistent state, which can impact integrity. As a result, queries are often transactional, which means they either run completely or are completely undone.</p>
<p>For example, consider a query that moves money from one account to another account. Both the withdrawal and the deposit must succeed, otherwise both will have to be undone.</p>
<p>When a user executes a query, they can store the result in a virtual database called a <strong>database view</strong>.</p>
<p>For example, a user could query a database of employees and ask for a view that shows the name, address, and phone number, but not the salary, for each employee.</p>
<p>Database views are powerful tool for achieving access control. A database owner can extract some subset of the data and give other users access to only that subset.</p>
<h2>Database Threats Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/DF4376DB-23F1-4197-A713-0D67A365E539.png" /></p>
<h2>Database Threats Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/EEA0ABC9-F002-4A9D-8654-81E456D1921D.png" /></p>
<p><a href="http://www.oracle.com/us/products/database/2014-ioug-dba-security-superhero-2338955.pdf">Source</a></p>
<h2>Database Hacking Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/BC720089-2712-4976-B060-FF39DC587337.png" /></p>
<h2>Database Hacking Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/027DCEF8-3F17-4FD1-8D27-191328C18040.png" /></p>
<h2>Relational Database Systems (RDBS) Part 1</h2>
<p>Relational databases are widely used in real-world environments.</p>
<p>A relational database consists of <strong>relations</strong>. Relations are also referred to as tables. A table consists of rows and columns.</p>
<p>The columns of a given table describe the attributes of the data to be stored in that table. A database <strong>schema</strong> defines these columns.</p>
<p>For example, we may define the following columns for a table of employees:</p>
<ul>
<li>name</li>
<li>DOB</li>
<li>salary</li>
<li>social security number</li>
</ul>
<p>Tables also have rows. A given row contains a value for each of the attributes as defined by the schema. These rows are called <strong>tuples</strong>.</p>
<p>For example, the tuple for an employee named Bob might look like:</p>
<ul>
<li>Bob</li>
<li>1/1/1970</li>
<li>57,000</li>
<li>123-45-6789</li>
</ul>
<p>Some of the columns in a table hold special values called <strong>keys</strong>. Keys uniquely identify a given tuple. For example, in the above table describing employees, the social security number column contains the key for each tuple since employees can be uniquely identified by this value.</p>
<h2>Relational Database Systems (RDBS) Part 2</h2>
<p>Let's look at an example of a relation that contains information about employees.</p>
<p><img alt="" src="https://assets.omscs.io/notes/66526878-6A01-4729-B187-6E1EB0FAC626.png" /></p>
<p>This table defines the following columns:</p>
<ul>
<li>Employee name</li>
<li>Department ID</li>
<li>Salary Code</li>
<li>Employee ID</li>
<li>Employee phone number</li>
</ul>
<p>Each employee will occupy one row in this table and will have data for each of the columns.</p>
<p>For example, Neil has an employee ID of 5088, a department ID of 13, a salary code of 12, and a phone number.</p>
<p>The employee ID is used to uniquely identify each employee in this table. The employee ID is the <strong>primary key</strong> for this relation.</p>
<p>Sometimes, you want to perform operations across tables.</p>
<p>For example, imagine there is a table of departments that has columns for a department ID and a department name. Suppose you wanted to create a query that selected the name of each employee and the department name (not ID) where each employee works.</p>
<p>We need a way of referencing the departments relation from the employees relation, so we can <strong>join</strong> the two and select the data we want. We can do this using the department ID.</p>
<p>In the employees table, the department ID is a <strong>foreign key</strong>. It references a primary key of another table: the departments table. Foreign keys are used to define relationships between tables and can be used to query those relationships.</p>
<h2>Relational Database Systems (RDBS) Part 3</h2>
<p>There are many different operations that we can perform on tables.</p>
<p>We can <em>create</em> a table. We can <em>select</em> certain information out of a table. We can <em>insert</em> new tuples or columns. We can <em>update</em> attribute values for certain tuples. We can perform <em>join</em> operations to combine multiple tables. We can <em>delete</em> tuples, columns, tables, and entire databases.</p>
<p>The following is a SQL query - a selection - that retrieves all of the attribute values for each employee in the above employee relation that works in the department with ID 15.</p>
<p><code>sql
SELECT * FROM Employee
WHERE DID = '15';</code></p>
<h2>Key Value Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/83E4EFF2-3CED-4058-AD08-39D3DEFC3A62.png" /></p>
<h2>Key Value Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/66B99FB2-D304-43C2-979E-BDA1CAD672A8.png" /></p>
<p>A primary key uniquely identifies a row.</p>
<h2>Database Views Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/12C1B7B6-9B61-4C2A-B9CB-55D63FB07E0A.png" /></p>
<h2>Database Views Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/8046AD01-9F33-468B-9F3E-2A1D04087814.png" /></p>
<h2>Database Access Control</h2>
<p>There are two basic SQL commands for implementing database access control.</p>
<h3>Grant</h3>
<p>The SQL command for granting privileges has the following syntax.</p>
<p><code>bash
GRANT          { privileges | role }
[ON            TABLE]
TO               { user | role | public }  
[IDENTIFIED BY password]
[WITH          GRANT OPTION]</code></p>
<p>The first line of the command describes what we would like to grant. We can grant either privileges - like <code>SELECT</code> - or an entire role, such as admin.</p>
<p>We can optionally scope our grant to a specific table.</p>
<p>Our grant must have a recipient, be it a particular user, role, or <em>public</em>. Public refers to the entirety of users/roles that interact with the database.</p>
<p>We can optionally require users to identify themselves using a certain password if they wish to revoke this grant.</p>
<p>Finally, we can optionally allow the grantee to further propagate their access with the <code>WITH GRANT OPTION</code>  clause.</p>
<p>For example, if we would like to grant Alice the ability to perform a <code>SELECT</code> on any table, and propagate that access to others, we could issue the following command:</p>
<p><code>sql
GRANT SELECT ON ANY TABLE TO Alice WITH GRANT OPTION;</code></p>
<p>Alternatively, we could grant access for <code>INSERT</code>, <code>UPDATE</code> and/or <code>DELETE</code>.</p>
<h3>Revoke</h3>
<p>The SQL command for revoking privileges has the following syntax.</p>
<p><code>bash
REVOKE { privileges | role }
[ON    TABLE]
FROM     { user | role | public }</code></p>
<p>The first line of the command describes the privilege or role that we would like to revoke.</p>
<p>We can optionally scope our revocation to a specific table.</p>
<p>Finally, we must revoke access from a particular entity. This entity can be a user, role, or the general public.</p>
<p>For example, to revoke the access we just gave to Alice, we issue the following command:</p>
<p><code>sql
REVOKE SELECT ON ANY TABLE FROM Alice;</code></p>
<h2>Database Access Control Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/7D499BB8-5C13-4A36-8CF3-0C3E8F301532.png" /></p>
<h2>Database Access Control Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/11C78BAE-41F8-42FC-8AFE-F234639D2D20.png" /></p>
<h2>Cascading Authorizations Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/31AD71A2-E008-405D-8F49-8C4A9CA746D9.png" /></p>
<h2>Cascading Authorizations Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/4A856303-A0BB-473A-8E98-41306F1E2AE4.png" /></p>
<h2>DAC or MAC Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/5947BE2E-48E7-4792-A77C-432EBC939BF2.png" /></p>
<h2>DAC or MAC Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6AED63B6-5A43-4EF8-BDCF-3624B7789381.png" /></p>
<h2>Attacks on Databases: SQL Injections Part 1</h2>
<p>One famous attack that is carried out against databases is the SQL injection attack.</p>
<p>In an <strong>SQL injection attack</strong>, an attacker sends a malicious command to the database, which allows them to interact with database data in unauthorized ways. The results of this malicious query can result in unauthorized reading and/or writing of data.</p>
<p>These attacks can disclose large amounts of data - an attack on confidentiality - and they can also corrupt data - an attack on integrity.</p>
<p>Understanding how an SQL injection attack is carried out first requires some understanding of common application architecture.</p>
<p>Often, the database resides in the back-end of the system. The front-end of the system that the user interacts with is typically a web application.</p>
<p>The user will present data to the application, often via forms, and the application will translate this data into database queries.</p>
<p>The application will send these queries to the database and then present the results to the user in some informative way.</p>
<p>The SQL injection attack occurs as a result of the application not properly sanitizing the input received from the user before sending that input to the database.</p>
<h2>Attacks on Databases: SQL Injections Part 2</h2>
<p>Consider a user interacting with a shipping platform.</p>
<p>Perhaps the application presents the user with a web form that asks them to enter a shipping city and then shows them all of the shipments destined for that city.</p>
<p>The script code might look something like this:</p>
<p><code>php
var Shipcity;
Shipcity = Request.form("Shipcity");
var sql = "select * from OrdersTable where Shipcity = '" + Shipcity + "';</code></p>
<p>If the user submits "Redmond" on the form, the SQL query sent to the database becomes:</p>
<p><code>sql
SELECT * from OrdersTable where Shipcity = 'Redmond';</code></p>
<p>What if the user submits "Redmond'; DROP table OrdersTable;"?</p>
<p>This SQL query will be sent to the database:</p>
<p><code>sql
SELECT * from OrdersTable where Shipcity = 'Redmond'; DROP table OrdersTable;</code></p>
<p>In this case, the user is taking a simple text input field and is injecting SQL into that field to be sent to the database.</p>
<p>The <code>SELECT</code> statement will still be executed, but it will be followed by a <code>DROP table</code> statement, which will delete all of the orders.</p>
<p>The vulnerability that we have in the web application is that it is not checking input. It is accepting any input and passing it blindly back to the database.</p>
<h2>SQL Injection Defenses</h2>
<p>As always, input checking remains a crucial defense for blocking SQL injection. If we assume all input is evil, we will be much more careful with that input before we send it to the database.</p>
<p>In addition, the Open Web Application Security Project (OWASP)  defines a list of <a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls">ten proactive controls</a> for guarding against common software vulnerabilities, including SQL injection.</p>
<h2>SQL Login Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/29ADEB96-538D-470A-85E1-28D2D25B40AC.png" /></p>
<h2>SQL Login Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6FF291D3-98CE-4AD1-93D7-9A93431D5335.png" /></p>
<h2>SQL Login Quiz 2</h2>
<p><img alt="" src="https://assets.omscs.io/notes/7BA1E896-52B9-43EB-A710-2EB5C7170141.png" /></p>
<h2>SQL Login Quiz 2 Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/87FB43B8-EEE7-4BB8-A3CE-10DFA9911FAE.png" /></p>
<h2>Inference Attacks on Databases Part 1</h2>
<p><strong>Inference attacks</strong> occur when a user is able to make inferences about data that they are not authorized to access based on queries that they are authorized to execute.</p>
<h2>Inference Attacks on Databases Part 2</h2>
<p>Consider a database of students with the following schema:</p>
<ul>
<li>student ID</li>
<li>student standing (junior/senior)</li>
<li>exam 1 score</li>
<li>exam 2 score</li>
<li>final exam score</li>
</ul>
<p>Suppose that students are not authorized to execute a query that will reveal another student's exam grade. However, students are authorized to execute a query <code>Q</code> that returns the average grade for an exam across all students.</p>
<p>An attacker wants to gain access to the exact score of another student for a particular exam and may be able to infer the grade through via <code>Q</code>.</p>
<p>Inference attacks sometimes require some additional outside information. In this case, let's suppose that the attacker knows that the particular student takes the exam late.</p>
<p>The attacker can deduce the exam grade of this student by executing <code>Q</code> before the student takes the exam and then again after the student takes the exam.</p>
<p>For example, if there are 10 students in the class and the <code>Q</code> returns 100 before the student takes the exam, and 99 after, we can calculate the student's score as:</p>
<p><code>bash
99 = (9 * 100 + x) / 10;
990 = 900 + x;
x = 90;</code></p>
<p>Again, the problem demonstrated here is that authorized queries like <code>Q</code> allow users to make inferences about data that they are not authorized to access.</p>
<h2>Inference Attacks on Databases Part 3</h2>
<p>The previous example might be a little contrived, so let's consider another scenario.</p>
<p>Suppose that <code>Q</code> is augmented to allow users to constrain the group of students over which they want to see the average score calculated.</p>
<p>For example, since our database has a field for student year - either junior or senior - suppose <code>Q-senior</code> allows students to calculate the average of only seniors and <code>Q-junior</code> allows students to calculate the average of only juniors.</p>
<p>A junior might execute <code>Q-junior</code> as a way to compare themselves with their peers.</p>
<p>Of course, a problem arises when there are only two juniors present in the class. One junior executing <code>Q-junior</code> can easily deduce the score of the other junior.</p>
<h2>Defenses Against Inference Attacks</h2>
<p>One way that we can guard against inference attacks is by preventing the access of aggregate information about a set of tuples when the size of that set is too small or too large.</p>
<p>In the most extreme case, aggregate information about a set containing one tuple is simply just the data present in that tuple.</p>
<p>For example, if a group containing one student has an average score of 90 on an exam, that one student scored a 90.</p>
<p>In addition, if you are selecting aggregate information about a set that is very large, the aggregate information roughly holds for everyone, and if it holds for everyone, it holds for a given user as well.</p>
<h2>Defenses Against Inference Attacks Process</h2>
<p>We can further defend against inference attacks by removing identifying information from databases. We can <strong>de-identify</strong> the exam score table by dropping the student ID column.</p>
<p>Even with de-identification, inference attacks may still be possible.</p>
<p>For example, if we know that there is one junior in the class, we can still <code>SELECT</code> the tuple where the student year is "junior" to reveal information about that student. We must remove or change the student year column to <strong>anonymize</strong> this student.</p>
<p>In addition to de-identification and anonymization, we can use <strong>generalization</strong>. For example, we might generalize the data in the student year column to say either "upperclassmen" or "underclassmen" instead of revealing the exact year.</p>
<p>This still may not be sufficient to defend against inference attacks if the data is not diverse enough.</p>
<h2>SQL Inference Attack Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/972B9CAC-ECD3-40CF-9187-8CA4B3F1E280.png" /></p>
<h2>SQL Inference Attack Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/379AB37B-1684-45F6-AD8D-54C00A35629B.png" /></p>
<h2>SQL Inference Attack Quiz 2</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0C1BADC4-C735-4958-9274-F9F2DB3E9411.png" /></p>
<h2>SQL Inference Attack Quiz 2 Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/13759837-A50F-4319-9A86-FDD985C5EE27.png" /></p>
<h2>Consider the case where one student from a region containing two students retrieves the grade information about that region.</h2>
<p>id: information-security-firewalls
title: Firewalls
course: information-security
lecture: firewalls</p>
<hr />
<h1>Firewalls</h1>
<h2>Defense in Depth</h2>
<p>When it comes to defense against attacks, the most important principle is to employ <strong>defense in depth</strong>. In other words, we should utilize multiple layers of defense mechanisms.</p>
<p>The first line of defense is prevention: prevention stops attacks from getting into our networks and systems in the first place. Inevitably though, some attacks will defeat the prevention mechanism. For example, anti-virus software may not prevent a user from downloading a Trojan horse, since Trojan horses appear to be legitimate programs.</p>
<p>Detection and response mechanisms make up the second line of defense. These mechanisms monitor activities in our systems and networks to detect attacks and repair damage. Just like with prevention, there will be attacks that can go undetected, at least until they have inflicted their damage. For example, the APT malware examples we discussed previously are often hard to detect because they blend in with normal activities so well.</p>
<p>The third line of defense consists of the attack-resilient technologies that enable the most valuable system components to survive attacks. For example, a server is a collection of diversified subsystems with different implementations. At least one of these subsystems will not be susceptible to an attack since an attack typically exploits specific vulnerabilities that may be present on some, but not all, components.</p>
<h2>What is a Firewall?</h2>
<p>To motivate the need for firewalls, let's first take a high-level tour of a typical enterprise network.</p>
<p>An enterprise network is part of the Internet. It typically has an internal, trusted intranet that only the employees can access. At a bank, for example, the trusted part of the network holds the internal email server and the systems that process financial transactions.</p>
<p>The enterprise network can also have a public-facing part. A bank may have a web portal where customers can log in and view their account. These public servers live in the so-called <strong>demilitarized zone</strong> (DMZ), which is a part of the enterprise network that is separated from the trusted network. While customers can interact with the webserver to log in and submit transaction requests, they cannot directly access the servers in the trusted network that are authorizing and processing transactions.</p>
<p>When a company has multiple physical sites, each site can have its own local, trusted network. However, these sites will need to communicate with one another. For example, employees in one bank branch may need to access the corporate network at the headquarters in another city. Such access must take place using the untrusted Internet.</p>
<p>We use routers to get traffic to its destination correctly across the Internet. Each local network has at least one router at its perimeter and these routers together with the core routers in the Internet backbone transport packets from one local area network to another.</p>
<p>While routers can send this traffic, the network needs to decide whether it should allow such traffic, based on security considerations. For example, the bank may want to explicitly disallow any external traffic from reaching the trusted network directly.</p>
<p>A <strong>firewall</strong> is a device that provides secure connectivity between networks. It is used to implement and enforce a security policy for communication between the networks.</p>
<h2>Firewalls Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F9F12971-51F9-4D97-8CDD-ABD6DE61A09F.png" /></p>
<h2>Firewalls Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/CD0D727F-C0F6-4B52-9B85-95B0D5540FED.png" /></p>
<h2>Firewall Design Goals</h2>
<p>A firewall is designed to enforce security policies on inbound and outbound network traffic. All traffic must be checked at the firewall, and only traffic that has been authorized by the security policy is allowed to pass through.</p>
<p>In addition to correctly enforcing the security policies, a firewall must also be dependable. This means that the firewall must not be easily crashed or disabled by an attack. A disabled firewall can no longer enforce the security policies of the network.</p>
<h2>Firewall Access Policy</h2>
<p>A critical component in the planning and implementation of a firewall is defining a suitable access policy. A network access policy specifies the types of traffic that are authorized to pass through the firewall. Traffic can be authorized using many different criteria, including address ranges, protocols, applications, and content types.</p>
<p>Policies should be developed through a security risk assessment conducted by the organization. This assessment will reveal what types of traffic the organization must support and what security risks are associated with this traffic, which will inform the firewall implementation.</p>
<h2>Firewall Limitations</h2>
<p>A firewall cannot provide protection against traffic that does not flow through it, such as traffic that is routed around it or traffic that is internal to the network. Additionally, if a firewall is misconfigured, it may not properly enforce the security policy against the traffic that it sees.</p>
<h2>Additional Convenient Firewall Features</h2>
<p>A firewall can log all traffic that passes through it, and the log can be analyzed later to learn more about the traffic, such as the traffic volume to a specific part of the network.</p>
<p>Firewalls can also provide <strong>network address translation</strong>. This is useful when multiple machines in the internal network have to share a single public IP address. For outbound traffic leaving the network, the firewall rewrites the local source IP address of a packet coming from an internal host to the public IP address. For inbound traffic, the firewall translates the destination IP address of the packet from the public IP address to the local IP address of the internal host.</p>
<p>A firewall can also provide encryption services. Two trusted networks may choose to send encrypted traffic to one another as a way to ensure that their communication cannot be eavesdropped on by other untrusted networks on the Internet.</p>
<h2>Firewall Features Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/C58A7F53-1221-4BCD-9F63-3DD25ED340E1.png" /></p>
<h2>Firewall Features Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/08146EF7-844E-4DF4-AF9B-46A4EFE810B9.png" /></p>
<h2>Firewalls and Filtering</h2>
<p>The main mechanism in firewalls is traffic filtering. The firewall stops each packet - whether inbound or outbound - and checks it against the security policy. After performing the check, the firewall will decide whether to allow or discard the packet.</p>
<h2>Filtering Types</h2>
<p>There are two main types of filtering: packet filtering and session filtering. In packet filtering, the firewall examines each packet by itself, and forwards or rejects the packet based on its attributes. In session filtering, a packet is examined within the context of a session. A firewall must maintain some additional state about each connection it receives to perform this type of higher-level filtering.</p>
<h2>Packet Filtering</h2>
<p>A packet-filtering firewall makes decisions on a per-packet basis. Since no other information is needed besides the current packet, the firewall does not have to maintain any state information about other packets it has seen. Packet-filtering firewalls are the simplest and most efficient firewalls, but they are not robust against attacks that span multiple packets, especially when each packet by itself is not indicative of an attack.</p>
<h2>Packet Filtering Firewall</h2>
<p>A packet-filtering firewall is typically set up as a list of rules, where each rule maps one or more packet attributes to an action. The attributes are used to match incoming TCP/IP packet header fields and the actions are typically either forward or discard.</p>
<p>The firewall may define rules that look at many different packet headers. For example, the firewall might inspect the source and/or destination IP address of the packet. Additionally, the firewall may look at the source and/or destination transport-level address (port number). The firewall may also take the IP protocol field - whether TCP, UDP or ICMP - into account.</p>
<p>A firewall with multiple interfaces may also match packets based on which interface the packet was received on or which interface the packet is being sent to. This approach is useful when there are multiple ports in an enterprise network that require multiple security policies.</p>
<p>If a packet doesn't match any of the rules defined in the firewall, then a default action must be taken. There are two default policies: the default discard policy and the default forward policy.</p>
<p>The <strong>default discard policy</strong> says that if no rule matches the packet, then the packet will be discarded. This is a more secure policy because it provides more control over the traffic that is allowed in the network. However, it can be a hindrance to users who wish to engage with new network services and must tell the sysadmin to enable such traffic.</p>
<p>The <strong>default forward policy</strong> says that if no rule matches the packet, the packet should be forwarded. Compared with the default discard policy, this policy is more user-friendly, albeit less secure. The security admin must react to each new security threat and add the appropriate rules to the firewall if they choose to use this policy.</p>
<h2>Firewall Filtering Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/948B9D27-D7EE-499D-945D-B272DEF09A1C.png" /></p>
<h2>Firewall Filtering Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/448612E5-28F9-422A-ADBA-7661F4D4F1EF.png" /></p>
<p>The first example follows the "default drop" rule, which is high security but requires new services to be expressly allowed. The second example follows the "default forward" rule, which is easier to use at the expense of security. The final approach sits in between the two in terms of security and ease of use.</p>
<h2>Typical Firewall Configuration</h2>
<p>Most standard applications that run on top of TCP follow a client-server model. The Simple Mail Transfer Protocol (SMTP), for example, allows client systems to send email to server systems. The client generates new email messages, typically from user input, and the server accepts incoming messages and places them in the appropriate user mailboxes.</p>
<p>SMTP operates by setting up a TCP connection between the client and the server, in which the server uses port 25 and the client uses any port between 1024 and 65535.</p>
<p>The port numbers below 1024 are the <a href="https://www.webopedia.com/quick_ref/portnumbers.asp">well-known port numbers</a> and are assigned permanently to common applications, such as port 25 for SMTP and port 80 for HTTP. The port numbers between 1024 and 65535 are generated dynamically and have temporary significance only for the duration of the TCP connection from the client to the server.</p>
<p>A packet-filtering firewall that wants to support clients of well-known services must permit inbound network traffic on all these high-numbered ports for TCP-based connections. A firewall that wants to support servers of well-known services must permit inbound network traffic on the well-known port or port ranges associated with those services.</p>
<h2>Packet Filtering Examples</h2>
<p>Let's look at a simplified rule set for SMTP traffic where the goal is to allow only inbound and outbound email traffic while denying all other traffic.</p>
<p><img alt="" src="https://assets.omscs.io/notes/756F8FCF-2E3E-4D64-8D5C-C114B81B6610.png" /></p>
<p>The rules described here are applied top to bottom for each packet until there is a match.</p>
<p>The first two rules are required to permit SMTP traffic to flow between an external host and an internal provider. Rule one allows inbound SMTP traffic from an external client. Rule two allows outbound traffic over higher-numbered ports. In other words, the first rule allows the external client to make an SMTP request, and the second rule allows the internal server to respond.</p>
<p>Rules three and four are required to permit SMTP traffic to flow between an internal host and an external provider. Rule three allows outbound SMTP traffic from an internal client. Rule four allows inbound traffic over higher-numbered ports. In other words, the third rule allows the internal client to make an SMTP request, and the fourth rule allows the external server to respond.</p>
<p>The final rule is an explicit statement of the default policy, which is to deny packets that don't match any of the previous rules.</p>
<h2>Modifying the Rules on Source Ports</h2>
<p>There are several problems with the ruleset shown above. For example, rule four allows inbound traffic to any destination port above 1023, whereas the original intent is to only allow inbound traffic that is part of an established SMTP connection. We can make our forwarding rules less permissive by looking at the source port in addition to the destination port.</p>
<p><img alt="" src="https://assets.omscs.io/notes/ABCE8E65-91D6-45D5-99B0-8F4737FD6E60.png" /></p>
<p>Now rule four only allows incoming traffic to high-numbered ports if that source port for that traffic is 25; that is, incoming connections are only allowed from mail servers.</p>
<p>We can make these rules even more precise. When a TCP connection is established, the ACK bit is set on the packet header. Because the intent of rule four is to allow inbound SMTP traffic that is part of an established connection, we can check that this bit is set before forwarding the packet.  </p>
<p><img alt="" src="https://assets.omscs.io/notes/8BD6C2F2-39BC-4795-B4E8-B469D9C1286B.png" /></p>
<h2>Packet Filtering Advantages</h2>
<p>The main advantage of packet-filtering firewalls is their simplicity and ease of implementation. Packet-filtering firewalls are also very efficient and impose very little overhead. Finally, the rules for packet-filtering firewalls can be very general, since they don't have to take higher-level applications into account.</p>
<h2>Packet Filtering Weaknesses</h2>
<p>Since packet-filtering firewalls do not examine upper-layer application data, they cannot prevent attacks that exploit application-specific vulnerabilities. If a packet-filtering firewall allows traffic to a given application, it allows all traffic to flow to that application indiscriminately.</p>
<p>Additionally, the logging capabilities of packet-filtering firewalls are limited. A firewall cannot log information about packet data that it doesn't examine. For example, a firewall may allow FTP traffic over port 21, and it may log the presence of FTP traffic,  but it cannot log the actual FTP data, such as which files are being transmitted.</p>
<p>Since packet-filtering firewalls make decisions on a per-packet basis, they can't defend against attacks that span multiple packets.</p>
<p>Finally, our SMTP example shows that packet-filtering rules tend to have a small number of conditions, which may be too permissive. An attacker might craft traffic that exploits these misconfigurations.</p>
<h2>Packet Filtering Firewall Countermeasures</h2>
<p>Let's discuss some attacks on packet-filtering firewalls and the appropriate countermeasures.</p>
<p>In a <strong>source IP address spoofing</strong> attack, the attacker sends packets from an outside host but with a falsified source IP address matching an internal host. Since firewalls are typically configured to forward traffic from one internal host to another, the attacker hopes that using a spoofed internal source IP address will make untrusted external traffic look like safe internal traffic.</p>
<p>To counter this attack, the firewall must discard all packets with an internal source IP address that arrive on an external interface. This countermeasure is often implemented at the router external to the firewall.</p>
<p>In a <strong>source routing attack</strong>, an attacker specifies the route a packet should take as it crosses the Internet. The hacker hopes that their selected route will bypass security measures and checks along the way. The countermeasure for this attack is to configure the firewall or router to discard all packets that use this option.</p>
<p>In a <strong>tiny fragment attack</strong>, the attacker uses <a href="https://en.wikipedia.org/wiki/IP_fragmentation">IP fragmentation</a> to create extremely small packet fragments and then splits the TCP header information across separate fragments. This attack is designed to circumvent filtering rules that depend on TCP header information.</p>
<p>Typically, a packet filter will make decisions based on the first fragment of a packet. The attacker hopes that the firewall only examines the first fragment and that the remaining fragments - containing header information that would normally cause a packet to be dropped - are passed through.</p>
<p>This attack can be defeated by forcing the first fragment of a packet to contain a predefined minimum amount of transport header information. If the first fragment is rejected, all of the subsequent fragments should also be rejected.</p>
<h2>Packet Filtering Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/97AF2EAE-DC71-4E99-AF2D-49520F5D1BD1.png" /></p>
<h2>Packet Filtering Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6C72F7E1-2A20-4826-8080-A48DEC8CEDB5.png" /></p>
<h2>Stateful Inspection Firewall</h2>
<p>In a <strong>stateful inspection firewall</strong>, a packet is analyzed within a larger context. This context often consists of the other packets present in the TCP connection through which the packet is transmitted.</p>
<p>To evaluate an incoming packet within this context, the firewall must record and maintain information about active connections. When a new packet arrives, the firewall updates the information about the connection accordingly and then decides whether the packet should be forwarded based on this context.</p>
<p>A stateful firewall can have a much higher-level view of traffic than a packet-filtering firewall. For example, it may be able to tell that an inbound SMTP packet is a response to a previously outbound packet. Additionally, it can reassemble multiple packets of a connection and inspect the application data, such as the names of files being transmitted during an FTP session.</p>
<h2>Connection State Table</h2>
<p>Here is an example of a connection table.</p>
<p><img alt="" src="https://assets.omscs.io/notes/9087DB7C-BBD3-4E41-A3B4-006F1A814AC0.png" /></p>
<p>The firewall may maintain internal data structures that are linked to the connection table. For example, the HTTP response of a web server serving a page can span multiple packets, so the firewall might maintain a data structure that keeps track of the HTML that it has already delivered. This data structure will allow the firewall to perform a more specific analysis of the connection.</p>
<h2>Application Level Gateway</h2>
<p>An <strong>application-level gateway</strong> also referred to as an application proxy, is an application-specific firewall that essentially acts as a <em>relay</em> of application-level traffic. From the perspective of an internal client, the gateway is the external server. From the perspective of the external server, the gateway is the internal client.</p>
<p>To use an application proxy, a user first contacts the gateway using an application protocol such as FTP or HTTP. The gateway then asks the user for the name of the remote server, and the user responds with authentication information which the gateway relays. When the server responds, the gateway will analyze the response and potentially deliver it to the user.</p>
<p>The gateway must implement the correct application logic to correctly analyze the server response. For example, if the gateway is proxying web traffic, it must be able to process HTTP responses just like a web browser.</p>
<p><img alt="" src="https://assets.omscs.io/notes/0F2BC2EA-9483-4F84-A55F-752DEA103A60.png" /></p>
<p>The advantage of using an application proxy is that we can restrict certain application features. For example, a web proxy can prevent active scripts in web pages by removing them from the HTML returned by the remote server. Since application proxies have more application-specific context than packet filters, they tend to be more secure.</p>
<p>The main disadvantage of proxies is that they incur additional overhead since they must examine and forward all traffic in both directions between the client and server. Additionally, we must install or write proxying code for each application we want to protect.</p>
<h2>Filtering Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/5BE501CE-84FD-4BC6-A5A8-1334384E7466.png" /></p>
<h2>Filtering Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1F34A051-C027-4F76-BEA7-4BF6151DE243.png" /></p>
<h2>Bastion Hosts</h2>
<p>Application-level gateways typically reside on a dedicated machine called a <strong>bastion host</strong>. These machines are made to be very secure.</p>
<p>Bastion hosts execute a secure version of the operating system and are configured to allow only essential network traffic, such as web and DNS traffic. Additionally, they can require user authentication, even for traffic originating from an internal host.</p>
<p>Each proxy running on the bastion host is configured to allow access only to specific host systems on the internal network. This configuration ensures that compromised proxies don't lead to attacks on the entire internal network.</p>
<p>Each proxy module installed on the bastion host is a very small software package designed with simplicity and security in mind. For example, a typical Unix email application may contain over 100,000 lines of code while an email proxy might contain fewer than 1,000.</p>
<p>A proxy typically performs no disk access other than reading its initial configuration file. This makes it difficult for an attacker to install a Trojan horse on the bastion host and affect the proxy.</p>
<p>Finally, each proxy typically runs as a non-privileged user in a private, secure directory on the bastion host. If a proxy is compromised during an attack, it cannot easily compromise the entire bastion host or affect other proxies.</p>
<h2>Host Based Firewalls</h2>
<p>While firewalls are typically installed at network perimeters, host-based firewalls can be used to enforce a host-specific security policy. Similar to a network firewall, a host-based firewall is a software module used to filter and restrict inbound and outbound traffic. Host-based firewalls are commonly installed on important internal servers.</p>
<h2>Host Based Firewall Advantages</h2>
<p>There are several advantages to host-based firewalls. First, since these firewalls are host-specific, each instance can implement filtering rules that are tailored to the application it protects. Second, a host-based firewall can stop both internal and external attacks, while a perimeter-resident firewall can only protect against external attacks.</p>
<p>We typically deploy host-based firewalls in addition to network firewalls to provide an additional layer of protection.</p>
<h2>Personal Firewalls</h2>
<p>Personal firewalls are often deployed at home routers to protect home networks. These firewalls tend to be simpler than host-based firewalls or network-perimeter firewalls because home networks are often less complex than enterprise networks.</p>
<p>The main goal of the personal firewall is to protect the computers in the home network. For example, it can detect and block incoming remote access attempts and outgoing connections to external servers that are known for performing botnet C&amp;C. Therefore, even when a home computer has been compromised, it cannot participate in malicious activities.</p>
<p>Here are some of the common network services that are typically blocked by a personal firewall. A user may configure the firewall to allow one or more of these services if desired.</p>
<p><img alt="" src="https://assets.omscs.io/notes/90CE711E-FEEB-437B-AFD5-491E31E617CB.png" /></p>
<h2>Advanced Firewall Protection</h2>
<p>Besides disabling and enabling certain services, personal firewalls can also provide advanced features.</p>
<p>A firewall can be configured to operate in "stealth mode": dropping all unsolicited packets it receives from the Internet to hide the system(s) behind it.</p>
<p>A user can configure the firewall to drop all UDP and ICMP packets and only accept TCP packets to certain ports.</p>
<p>Additionally, most firewalls have logging capabilities and they can record all unwanted traffic and activities.</p>
<p>Finally, a user might be able to configure the firewall to only allow certain applications - such as those signed by public keys issued by a valid certificate authority - to accept connections from the Internet.</p>
<h2>Personal Firewalls Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/318AE0E6-A077-413E-9B08-A6E3263B8E08.png" /></p>
<h2>Personal Firewalls Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/AE45FA72-0C13-4F06-A89A-620E2894EBFC.png" /></p>
<p>If the device is not always protected by the corporate network, as is the case in scenarios 1 and 3, then the personal firewall is needed for additional security.</p>
<h2>Deploying Firewalls</h2>
<p>The figure below illustrates a common firewall configuration used by enterprise networks.</p>
<p><img alt="" src="https://assets.omscs.io/notes/C7E026AC-ADFE-4493-B4CA-20AAFABB1090.png" /></p>
<p>An external firewall is placed at the edge of the local area network, just inside of the boundary router that connects the corporate network to the Internet. Additionally, one or more internal firewalls protect the bulk of the enterprise network.</p>
<p>Between the internal firewall and the external firewall is a network known as a <strong>demilitarized zone</strong> (DMZ). Systems that require external connectivity but need some protections are typically located in the DMZ, such as corporate web, email, and DNS servers.</p>
<p>The external firewall provides some basic, first-line defense, while still allowing public access to systems in the DMZ. The internal firewall provides additional protection; in particular, it protects the internal trusted network from less-trusted traffic originating in the DMZ.  </p>
<h2>Internal Firewalls</h2>
<p>Compared with the external firewall in the diagram above, the internal firewall performs more stringent filtering. This is because the internal network requires more protection than the public-facing systems in the DMZ.</p>
<p>The internal firewall protects the remainder of the enterprise network from attacks launched from the DMZ. For example, if a public-facing web server is compromised, the internal firewall can block attack traffic originating from that server.</p>
<p>Additionally, the internal firewall controls access to the DMZ from the internal network. Only authorized traffic from the internal network can reach the DMZ to change, say, a setting on a public-facing web server. For example, such traffic may be limited to having a source IP address of a sysadmin's workstation.</p>
<p>Multiple internal firewalls can be used to protect different parts of the internal network from each other; that is, even if one part of the internal network has been compromised, the other parts are still being protected by their local firewalls.</p>
<h2>Distributed Firewall Deployment</h2>
<p>A distributed firewall configuration typically includes standalone network firewalls, host-based firewalls, and personal firewalls.</p>
<p>The standalone network firewalls protect the internal network from attacks from the Internet. Additionally, host-based firewalls protect against internal attacks and provide protection tailored to specific machines and server applications. Finally, personal firewalls protect personal computers regardless of where they are in the network.</p>
<p>Security administrators may aggregate and analyze logs from all of the firewalls in the network to get a high-level view of network traffic and compromise. For example, if admins see that multiple host-based firewalls are logging the same attack, they may conclude that a worm is spreading inside the internal network.</p>
<h2>Firewall Deployment Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/EFDA0A4D-B9D3-417D-9025-2E23F564DDE1.png" /></p>
<h2>Firewall Deployment Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A765E6A6-3A0E-4F47-86B5-F56A9C0E3BFA.png" /></p>
<h2>Stand Alone Firewall Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/DCDD7C22-F6A1-449E-A7B5-013C5D1324A4.png" /></p>
<h2>Stand Alone Firewall Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F83D170A-A182-4CD1-A70E-A816AB4D8FD7.png" /></p>
<h2>Firewall Topologies</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/31FA6A2A-41A1-40DA-8B28-9C99B912A953.png" /></h2>
<p>id: information-security-hashes
title: Hashes
course: information-security
lecture: hashes</p>
<hr />
<h1>Hashes</h1>
<h2>Hash Functions</h2>
<p>A <strong>hash function</strong> can be applied to a block of data of any size and produces a fixed-size output, typically in the range of 128-512 bits. Given a message $m$, computing the hash $H(m)$ should be very easy.</p>
<p>These properties make hash functions practical for security applications. We need our hash functions to be able to handle arbitrary input and compute their output efficiently.</p>
<p>The following properties are required for hash functions to be secure.</p>
<h3>One-Way Function</h3>
<p>Given $H(m)$, it should be computationally infeasible to find $m$. We call such a non-invertible function a <strong>one-way function</strong>.</p>
<p>Alice can authenticate a message by hashing a secret value and appending it to the message. If an attacker intercepts this message and the hash function is not one-way, then the attacker can find the input that computes the hash value. That is, the attacker can invert the hash function to obtain the secret value from its hash.</p>
<h3>Weak Collision-Resistant Property</h3>
<p>Given input data $m1$, it should be computationally infeasible to find another input value $m2 \neq m1$, such that $H(m1) = H(m2)$. This property of hash functions is the <strong>weak collision-resistant property</strong>.</p>
<p>Suppose that Alice wants to send a message to Bob, and she wants to ensure that the message arrives to him unmodified. She can create an encrypted hash of the message and send both the message and the hash to Bob.</p>
<p>When the attacker intercepts the message and encrypted hash code, they can recompute the (unencrypted) hash code of the message. If the weak collision property is not present, then the attacker can find another message such that the hash value of that message is the same as the hash value of the original message.</p>
<p>Even though the hash code is encrypted, the attacker only needs to find a message that reproduces the unencrypted hash code, since the encryption of two identical hash codes produces the same result.</p>
<p>As a result, the receiver is unable to tell that an attacker has modified the message because the modified message has the same hash code as the original message, and thus the same encrypted hash code.</p>
<p><img alt="" src="https://assets.omscs.io/notes/199B4A9A-827F-427B-9D14-4A453A38889B.png" /></p>
<h3>Strong Collision-Resistant Property</h3>
<p>The <strong>strong collision-resistant property</strong> states that it should be computationally infeasible to find two different inputs $m1 \neq m2$, such that $H(m1) = H(m2)$.</p>
<p>The strong collision-resistant property implies the weak collision-resistant property; that is, while the latter only requires that a hash function is collision-resistant regarding a specific input message, the former requires collision resistance for any pair of given messages. Thus, a hash function cannot meet the strong collision-resistant property without also satisfying the weak collision-resistant property.</p>
<p>Suppose that Bob does some work for Alice, and he wants her to pay him later. He can draft an IOU message and ask Alice to digitally sign it as a way of agreeing to pay it. To sign the IOU, Alice first hashes it and then signs the hash using her private key. Later, Bob can present this IOU message, along with the signature, to Alice or Alice's bank to retrieve the payment.</p>
<p>If the strong collision-resistant property is not present, Bob can find two different messages that have the same hash code: one requesting Alice to pay a small amount $X$, and another requesting her to pay a more substantial amount $XXX$.</p>
<p>Bob can present the IOU for $X$ to Alice and have Alice sign it. Later, Bob can present the signature with the message for $XXX$ and ask Alice to pay it. Because the two messages have the same hash value, Alice cannot deny that she has signed the message agreeing to pay $XXX$.</p>
<p><img alt="" src="https://assets.omscs.io/notes/1870D722-FE9F-4F55-97C5-8C8C38E4C7C9.png" /></p>
<h2>Hash Function Weaknesses</h2>
<p>To understand the constraints and potential weaknesses of hash functions, we need to understand two concepts: the pigeonhole principle, and the birthday paradox.</p>
<h3>Pigeonhole Principle</h3>
<p>Imagine we have nine pigeonholes. If we have nine pigeons, then we can place each pigeon in one hole. Generally, for $n$ pigeons and $m$ holes, each pigeon can occupy an unoccupied hole when $m = n$.</p>
<p>If we add another pigeon, then there must be one hole occupied by two pigeons. Generally, if $n &gt; m$, then at least one hole must have more than one pigeon.</p>
<h3>Birthday Paradox</h3>
<p>How many people do you need in a room before you have a greater than 50% chance that two of them have the same birthday?</p>
<p>There are 365 birthdays, and we can think of these birthdays as pigeonholes. Then, the probability that two people in the room have the same birthday is the probability that two people occupy one pigeonhole.</p>
<p>Obviously, with 366 people, there is a 100% chance that two people have the same birthday.</p>
<p>If we only want a good chance, say 50%, that two people share a birthday, how do we calculate how many people we need in the room?</p>
<p>We can reframe the problem to ask instead: how many people do we need in a room before the probability $p$ that everyone has a unique birthday drops below 50%?</p>
<p>When we place the first person $f$ in the room, $p = 1$. Since there are no other people in the room, $f$ is guaranteed to have a unique birthday.</p>
<p>When we place the second person $s$ in the room, there are only 364 unique days left, since $f$ has already taken one day. The probability that $s$ doesn't share $f$'s birthday is $364 / 365$, and thus the overall probability $p$ drops from 1 to $364 / 365$.</p>
<p>The third person, $t$, is in a similar situation. Since two people precede them, there are only 363 available birthdays left. As a result, $p$ drops to $364 / 365 * 363 / 365$. We multiply the probabilities because we need to make sure that $s$ doesn't violate the uniqueness constraint <em>and</em> $t$ doesn't either. Technically, this is a conditional probability.</p>
<p>Generally, for $k$ possible birthdays and $n$ individuals in the room, we can calculate the $p$ as:</p>
<p><code>bash
p = (1 / k)^n * (k! / (k - n)!)</code></p>
<p>We can steadily increase $n$ to determine when $p$ dips below 0.5. For $k = 365$ and $n = 23$, we see that:</p>
<p><code>bash
p = (1 / 365)^23 * (365! / (365 - 23)!) = 0.492703</code></p>
<p>Since $p$ is the probability that no birthdays overlap, the probability that one or more birthdays overlap is $1 - p = 0.507297$.</p>
<p>Analytically, the probability of repetition given $k$ possible events and $n$ selected events, is approximately $n^2/2k$. This probability is 0.5 when $n = \sqrt{k}$. For example, if $k =  365$, then $\sqrt{k} = 19$ approximately, which is close to the correct answer of 23.</p>
<h3>Back to Hash Functions</h3>
<p>Once we understand the pigeonhole principle and the birthday paradox, we see that some of the properties of hash functions seem to contradict each other.</p>
<p>Remember, a hash function produces a fixed-size output from an input of arbitrary size. Since there are an infinite number of arbitrarily-sized inputs, and a finite number of fixed-size hash codes, many inputs can be mapped to the same output hash value. In other words, we have many more pigeons than pigeonholes.</p>
<p>This setup seems to violate the property of collision resistance. However, the collision resistance properties only speak to computational infeasibility, not mathematical impossibility. From a security perspective, a collision that is infeasible to find is as good as one that doesn't exist.</p>
<p>The larger the number of output hash values, the harder it is to find a collision. We can reduce the probability of a collision by increasing the length of the hash code.</p>
<h2>Determining Hash Length</h2>
<p>To reduce the chance of collision, we need to use hash functions that produce longer hash values, but how many bits is enough?</p>
<p>Suppose a hash function produces hash codes that are $l$ bits long. As a result, this function can produce $2^l$ possible hash values. According to the birthday paradox, we have a 50% chance of finding a collision after processing $\sqrt{2^l} = 2^{l/2}$ messages.</p>
<p>Therefore, if $l = 64$, then there are $2^{64}$ hash values, and an attacker only needs to search $2^{32}$ messages to find a collision. This search is entirely feasible with modern computing power. In practice, hash values are at least 128 bits long.</p>
<h2>Hash Size Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/4782A47E-5391-43F5-A80C-CA9F02FDBD71.png" /></p>
<h2>Hash Size Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/EC0A4B95-7A5E-4C5B-87AD-6D39D17FA04C.png" /></p>
<p>Given a hash length $n$, an attacker needs to hash $2^{n / 2}$ messages to find a collision. For $n = 128$, an attacker needs to compute $2^{64}$ hashes.</p>
<h2>Secure Hash Algorithm</h2>
<p>The original secure hash algorithm is SHA-1, which produces a hash value of 160 bits. The subsequent SHA-2 family of algorithms, which operate similarly to SHA-1, produce hashes of 256-, 384-, and 512-bits long.</p>
<p>The following table compares the SHA parameters.</p>
<p><img alt="" src="https://assets.omscs.io/notes/C2D62752-3F78-4D50-9280-D473532E1547.png" /></p>
<p>Message digest size refers to the length of the hash value. As we know, SHA-1 produces 160-bit hashes, and SHA-512 produces 512-bit hashes.</p>
<p>Message size is the size limit on the input. These limits do not have any effect in practice, because most, if not all, messages are much smaller. For example, SHA-1 caps the message size at 2^64 bits. Given that one terabyte is 2^43, SHA-1 can hash a message that is over two million terabytes long.</p>
<p>As we move from left to right in the table, each subsequent algorithm produces a hash value with more bits. Consequently, each subsequent hash function is more secure than the last. For example, with a hash value size of 160 bits, the search space for an attacker to find a collision with SHA-1 is 2^80 messages. For SHA-512, that search space grows to 2^256 messages.</p>
<h2>Message Processing</h2>
<p>The following figure shows the overall processing of a message to produce a hash value.</p>
<p><img alt="" src="https://assets.omscs.io/notes/44BE949B-28F2-415D-B39B-0C86214F8749.png" /></p>
<p>Before any processing can start, we must pad the message to a multiple of 1024 because the hash function processes the message in 1024-bit blocks. First, we store the length of the original message in the final 128 bits of the last block. Next, we fill in the space between the end of the original message and the last 128 bits with 1 followed by as many 0s as necessary.</p>
<p>After padding, the message is processed one 1024-bit block at a time. The output of processing the current block becomes the input to processing the next block. That is, when processing the second block, the input includes not only the second message block but also the output of the processing of the first message block.</p>
<p>For the first message block, the input includes an <strong>initialization vector</strong> (IV), a 512-bit value hardcoded in the algorithm.</p>
<p>The following figure shows the processing of a single message block.</p>
<p><img alt="" src="https://assets.omscs.io/notes/E7BCDFC8-DF87-4A7E-B680-75AE0BF28B67.png" /></p>
<p>Processing a single block involves 80 rounds of operations that operate on both the current message block $m$ and the output of processing the previous block.</p>
<p>The inputs to each round include the result from the previous round, some constant $k$, and some words $w$ derived from $m$. $k$ provides randomized values to eliminate any regularities in $m$.</p>
<p>The operations at each round include <a href="https://en.wikipedia.org/wiki/Circular_shift">circular shifts</a> and primitive boolean functions based on AND, OR, NOT, and XOR.</p>
<p>The result of processing the current block becomes input for processing the next block, and the result of processing the final block is the hash code for the entire message.</p>
<h2>Hash Based Message Authentication</h2>
<p>Using hash values for message authentication has several advantages. For example, hash functions are very efficient to compute, and libraries for hash functions are widely available.
On the other hand, a hash function such as SHA cannot be used directly for message authentication because it does not rely on a secret.</p>
<p>There have been several proposals to incorporate a secret key into an existing hash function. HMAC has received the most support thus far and has been adopted for use in other protocols such as IPSec and TLS.</p>
<p>The following diagram illustrates how HMAC works.</p>
<p><img alt="" src="https://assets.omscs.io/notes/68F165A1-0C6B-44D3-86DB-304093AF2695.png" /></p>
<p>HMAC involves a hash function $H$ and a secret key $k$. The message $m$ consists of multiple blocks of $b$ bits. For example, in SHA-512, each block is 1024 bits, so $b = 1024$.</p>
<p>First, $k$ is padded to $b$ bits, which is accomplished by appending zeroes to $k$. The padded key is then XORed with $ipad$, a constant designed to eliminate any regularities in the key.</p>
<p>The result is a $b$-bit value $s1$. $s1$ is prepended to $m$, and then the combination $s1 + m$ is hashed using $H$ to produce an $n$-bit hash value. For example, if the hash function is SHA-512, then $n = 512$.</p>
<p>Next, the $n$-bit hash value is padded to $b$ bits. The padded key is then XORed with $opad$, another constant designed to eliminate regularities in the key. The result is a $b$-bit value $s0$.</p>
<p>The padded hash $h$ is then appended to $s0$, and the entire message $s0 + h$ is hashed. The $n$-bit result is the output of the HMAC procedure.</p>
<h2>HMAC Security</h2>
<p>The security of HMAC depends on the cryptographic strength of the underlying hash function. For HMAC to be secure, the underlying hash function must satisfy the properties of non-invertibility and collision resistance.</p>
<p>Furthermore, compared with a cryptographic hash function, it is much harder to launch a successful collision attack on HMAC because HMAC uses a secret key.</p>
<p>For example, suppose the attacker obtains the HMAC of message $m1$ and wants to find another message $m2$ such that $HMAC(m2) = HMAC(m1)$ .</p>
<p>Without the secret key, there is no way the attacker can compute the correct HMAC value for $m2$. Thus, the attacker can't determine whether $m1$ and $m2$ have collision in HMAC.</p>
<p>In summary, because of the use of the secret key, HMAC is much more secure than a cryptographic hash function alone.</p>
<h2>Hash Function Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/AD311597-0FE3-4399-B9A1-11A70E568C55.png" /></p>
<h2>Hash Function Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/137488B0-4ADC-4B1E-AD86-DFA5067E6565.png" /></h2>
<p>id: information-security-introduction-to-cryptography
title: Introduction to Cryptography
course: information-security
lecture: introduction-to-cryptography</p>
<hr />
<h1>Introduction to Cryptography</h1>
<h2>Decryption</h2>
<p><strong>Encryption</strong> is the process of converting data into a form that is unintelligible to the unintended or unauthorized party. We call the original data <strong>plaintext</strong>, and the unintelligible data <strong>ciphertext</strong>. An authorized party can reverse this process; that is, they can <strong>decrypt</strong> the ciphertext to reveal the plaintext.</p>
<p><img alt="" src="https://assets.omscs.io/notes/2BD18913-D8BD-40C3-B4BC-C101BAE8BA1B.png" /></p>
<p>The decryption process always recovers the original plaintext because there is a one-to-one mapping between plaintext and ciphertext.</p>
<p>Encryption protects data confidentiality because only the authorized party with the proper <strong>secret key</strong> can read the data.</p>
<p>Encryption also provides other security services. We can use encryption for integrity checking to ensure that no one has tampered with a message. We can also use encryption to verify the authorship of a message.  Encryption also serves as a method by which one user can authenticate themselves with another.</p>
<h2>Encryption Basics</h2>
<p>Encryption has been used for thousands of years. There is evidence that ancient Egyptians used <strong>ciphers</strong> - encryption schemes - and one of the most famous ciphers is the letter-based <a href="https://en.wikipedia.org/wiki/Caesar_cipher">Caesar cipher</a> from Roman times.</p>
<p>The ancient ciphers were all <em>symmetric ciphers</em>, an encryption scheme that still enjoys widespread use today. <em>Asymmetric ciphers</em> are much newer, only having been invented in the late 1970s.</p>
<p>Most modern security protocols use both types of encryption. Parties wishing to communicate typically use asymmetric ciphers to authenticate themselves with one another and to establish and exchange a symmetric encryption key. Each party encrypts and decrypts subsequent communications using this key. Senders may also use asymmetric ciphers to sign the data to prove authenticity.</p>
<h2>Attacks on Encryption</h2>
<p>Given that encryption plays such an essential role in security, we can expect that attackers are always trying to break our ciphers. The goal of these attackers is to recover the plaintext from the ciphertext or to uncover the encryption key.</p>
<p>An attacker can quickly get their hands on our ciphertext. For example, they may use a packet sniffing tool to capture encrypted packets you send over the Internet, and they might try to recover the plaintext from these packets. We should always assume that an attacker can capture the ciphertext we transmit over the Internet.</p>
<p>Instead of uncovering one piece of plaintext from one piece of ciphertext, the attacker may try to discover the encryption key so that they can decrypt all subsequent communications encrypted using that key. There are several attack methods to achieve this goal.</p>
<h3>Brute-force</h3>
<p>The simplest, most inefficient strategy is the <strong>brute-force</strong> method. In this attack, the attacker tries all possible keys one by one until they find the one that decrypts the ciphertext properly into plaintext.</p>
<p>How does the attacker know that the decryption has worked properly? Typically the attacker knows what the plaintext should resemble. For example, if the plaintext is an English sentence, then only the correct key can decrypt the ciphertext into text that reads like English.</p>
<p>This method is very inefficient because the number of possible keys can be huge. As a result, brute-force often requires an unfeasible amount of time to be successful.</p>
<h3>Cryptanalysis</h3>
<p>In cryptanalysis, the attacker knows the encryption algorithm and perhaps some characteristics of the data, such as the distribution of certain letters or words. An attacker can perform a much more directed search of the keyspace with cryptanalysis as opposed to brute-force.</p>
<h3>Implementation attacks</h3>
<p>The attacker can also exploit implementation or systems issues. For example, researchers were able to deduce the values of certain bits in an encryption key by observing the power consumption in a cryptosystem. As a result, they were able to reduce the size of the keyspace significantly.</p>
<h3>Social-engineering attacks</h3>
<p>The weakest link in a security system is often the naive users who can be exploited using social engineering tricks. For example, an attacker can call an unsuspecting user and pretend to be a sysadmin who has forgotten their key.</p>
<h2>Encryption Attack Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/DAF48208-84E4-496E-B228-B4C8B0B841CA.png" /></p>
<h2>Encryption Attack Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/462EA39F-5754-47D1-B624-335F35CF3647.png" /></p>
<p>In a brute-force attack, the attacker must try all potential keys. The only way to make this task more difficult is to increase the length of the key, thus increasing the size of the keyspace.</p>
<h2>Simple Ciphers Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/88162C87-3BE8-476A-BC36-E9B325A11A04.png" /></p>
<h2>Simple Ciphers Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B6279774-5618-4B04-8081-1499BCF75299.png" /></p>
<p>Since "A" maps to "D", "B" maps to "E", and so forth, we can just "rewind" each letter in the ciphertext by three to obtain the plaintext.</p>
<h2>Simple Ciphers</h2>
<p>Caesar's cipher - an example of a <strong>shift cipher</strong> - maps each letter to another letter by shifting it a fixed amount. If we represent each letter in the alphabet as a number - A = 1, B = 2,  , Z = 26 - then we can represent this encryption scheme for a given <code>letter</code> and a given <code>shift</code> as</p>
<p><code>bash
(letter + shift) mod 26</code></p>
<p>The secret key in this scheme is the value of <code>shift</code>. Since there are only 26 possible keys (any shift higher than 26 wraps back around), an attacker only needs to try at most 26 keys before being able to decrypt any message encrypted with Caesar's cipher.</p>
<p>A generalization of this scheme allows arbitrary mapping of one letter to another; that is, this scheme no longer requires shifting each plaintext letter by the same fixed amount. These generalized ciphers are referred to as <strong>substitution ciphers</strong> or <strong>monoalphabetic ciphers</strong>.</p>
<p>The substitution alphabet is the secret key in this scheme. The number of possible alphabets is vast. If I wanted to create such an alphabet, I would have 26 options for mapping "A", 25 options for mapping "B", and so forth. Put another way, there are 26! (2^88) possible alphabets. An attacker cannot brute-force this scheme.</p>
<p>Instead of attempting to try every key, an attacker can analyze the statistical frequency of letters in the ciphertext. For example, in English, the most frequently used letter is "E". If the most common letter in the ciphertext is "X", then there is a high probability that "E" maps to "X".</p>
<p>An attacker can use statistical analysis to decrypt the message directly or at least drastically reduce the size of the keyspace over which they subsequently run a brute-force attack.</p>
<h2>Letter Frequency of Ciphers</h2>
<p>Here is the frequency distribution of English letters.</p>
<p><img alt="" src="https://assets.omscs.io/notes/D1DF722B-FFB6-4EEF-A1BB-25E0B0A9480B.png" /></p>
<p>Using this frequency distribution, we should be able to make some educated guesses to decipher the following ciphertext:</p>
<p><code>bash
IQ IFCC VQQR FB RDQ VFLLCQ NA RDQ
CFJWHWZ HR BNNB HCC HWWHBSQVQBRE
HWQ VHLQ</code></p>
<p>To start, we notice that the letter "Q" is the most frequent in our ciphertext. In English, the most common letter is "E", so there is a high probability that "Q" is the plaintext letter "E".</p>
<p>Then we can look at the three-letter words, <code>RDQ</code> and <code>HWQ</code>, which both end in "E". It is likely that one of these words is "ARE", while the other is "THE".</p>
<p>We also have the word <code>HR</code>, which can be "AT". If so, then <code>HWQ</code> is "ARE" and <code>RDQ</code> is "THE". If "H" is "A", then the word <code>HCC</code> is likely "ALL".</p>
<p>If we continue with this process, using both the frequency distribution of the letters in the English language along with our knowledge of English words to help us, we can uncover the following plaintext:</p>
<p><code>bash
WE WILL MEET IN THE MIDDLE OF THE
LIBRARY AT NOON ALL ARRANGEMENTS
ARE MADE</code></p>
<p>In practice, we might also look at the frequency distribution of letter pairs and even triples in addition to single letters.</p>
<h2>Monoalphabetic Cipher Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/693FC6D9-96D7-4E8D-8736-0D2D2CD8165D.png" /></p>
<h2>Monoalphabetic Cipher Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/43C05969-AD5E-4A44-A49D-590BD32B62FD.png" /></p>
<h2>Vigenere Cipher</h2>
<p>While a substitution cipher uses a single alphabet, a <strong>polyalphabetic cipher</strong> uses multiple substitution alphabets. The Vigenere cipher is the most well-known polyalphabetic cipher.</p>
<p>We can represent the Vigenere translation with the following matrix, <code>M</code>, whereby the ciphertext for a given plaintext <code>P</code> and key <code>K</code> resides at column  <code>P</code>, row <code>K</code> in <code>M</code>.</p>
<p><img alt="" src="https://assets.omscs.io/notes/957CCAC1-F7A3-458B-9BFD-B38188C4863E.png" /></p>
<p>Suppose we want to encrypt the plaintext "ATTACKATDAWN" using the Vigenere cipher with "LEMON" as the key.  Since Vigenere encryption proceeds characterwise, the key must be as long as the plaintext. We generate the <strong>keystream</strong> "LEMONLEMONLE" by repeating the key until the required number of characters are present.</p>
<p>To encrypt "A", we look at column "A" and row "L" of the matrix. The first character of the ciphertext is "L". To encrypt "T", we look at column "T" and row "E" of the matrix. The second character of the ciphertext is "X". To encrypt "T", we look at column "T" and row "M" of the matrix. The third character of the ciphertext is "F".</p>
<p>We can continue in this fashion to transform "ATTACKATDAWN" into "LXFOPVEFRNHR".</p>
<h2>Vigenere Cipher Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/C188A430-4FD1-41CB-B6F3-1991645DB0E1.png" /></p>
<h2>Vigenere Cipher Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/4F4575D2-8431-473F-9F1B-AF4BC57359C6.png" /></p>
<h2>What Should be Kept Secret?</h2>
<p>While we should always keep our encryption keys a secret, our encryption algorithms should be public.</p>
<p>According to <a href="https://en.wikipedia.org/wiki/Kerckhoffs%27s_principle">Kerckhoff's principle</a>:</p>
<blockquote>
<p>A  cryptosystem should be secure even if everything about the system, except the key, is public knowledge.  </p>
</blockquote>
<p>In general, we keep our encryption algorithms open so that they can be analyzed and improved by the broader community. More importantly, we don't have to rely on the secrecy of the algorithm for its security - the so-called "security by obscurity" principle. In practice, we should exclusively use the widely-known algorithms and standards.</p>
<h2>Types of Cryptography</h2>
<p><strong>Secret key cryptography</strong> uses a single key for encryption and decryption, which means that the sender and the receiver must possess the same key.</p>
<p><strong>Public-key cryptography</strong> uses two keys - a public and a private key - that are linked together mathematically. A user keeps their private key secret and announces their public key to other users.</p>
<p>The public key is used for encryption, and the private key is used for decryption. For example, Alice can use Bob's public key to encrypt a message that only Bob can decrypt because only Bob has the corresponding private key that can decrypt the message correctly.</p>
<p>The private key is also used for signing a message, and the public key can be used to verify the signature. For example, Alice can sign a message using her private key, and anyone knowing her public key can verify that only Alice can produce this signature.</p>
<h2>Hash Functions</h2>
<p>Hash functions are a third class of cryptographic functions. A <strong>hash function</strong> computes a fixed-length output - typically in the range of 128-512 bits - from a message of any size. This output is commonly referred to as a <em>hash</em> or <em>message digest</em>. Hash functions do not use keys.</p>
<p>We typically use hash functions for authentication and message authenticity/integrity. To provide these services, hash functions must satisfy the following properties.</p>
<h3>Efficiency</h3>
<p>A hash function should be able to compute a hash efficiently enough to make software and hardware implementations of the function practical.</p>
<h3>One-way function</h3>
<p>For a given hash function <code>H</code> and a given hash value <code>v</code>, finding the original message <code>m</code>, such that <code>H(m) = v</code> should be computationally infeasible.</p>
<p>Suppose Alice wants to authenticate herself to Bob. She can hash a secret <code>S</code> that she shares with Bob and send the hashed value to him. Bob can verify that  Alice sent the message by hashing their shared secret himself and comparing it with the value he received.</p>
<p>Because Alice transmits the hash value over the Internet, we must assume that an attacker can intercept the message. If the hash function does not satisfy the one-way property, the attacker can reverse the function and recover <code>S</code> from its hash.</p>
<p>If the attacker knows <code>S</code>, they can impersonate Bob to Alice or Alice to Bob.</p>
<h3>Weak collision resistance</h3>
<p>Given a hash function <code>H</code> and a message <code>m1</code>, it should be computationally infeasible to find another message <code>m2</code> such that <code>H(m2) = H(m1)</code>.</p>
<p>This property is essential for message authenticity and integrity protection.</p>
<p>Suppose Alice sends a message <code>M</code> to Bob, and she wants to make sure Bob knows that she is the real author of <code>M</code>. Alice can do this by sending <code>M</code>  along with a signed hash of <code>M</code>.</p>
<p>If the weak collision-resistant property is not present, an attacker may be able to craft a different message <code>M'</code>, such that the hash of <code>M'</code> is the same as the hash of <code>M</code>.</p>
<p>If Bob receives <code>M'</code> and the original signed hash of <code>M</code>, Bob has no way of knowing that the message is not from Alice.</p>
<h3>Strong collision-resistant</h3>
<p>Given a hash function <code>H</code>, it should be computationally infeasible to find two messages <code>m1</code> and <code>m2</code> such that <code>H(m2) = H(m1)</code>.</p>
<p>This property is stronger because it prevents an attacker from coming up with any two different messages that have the same hash value.</p>
<p>Suppose Alice owes Bob money. Bob can write an IOU message that Alice can hash and sign using her private key. If Bob can find two different messages that have the same hash value, one that requires Alice to pay a small amount, and another that requires her to pay a large amount, Bob may send Alice the message for the smaller amount and later claim that Alice owes him the larger amount.</p>
<h2>Hash Functions for Passwords</h2>
<p>The one-way property of hash functions - a hash function should be easy to compute, but impossible to invert - makes them a great candidate for password verification.</p>
<p>When a user authenticates themselves to a system, they often supply a password. The system hashes the supplied password and compares this hash against the saved hash of the password for that user. The system grants access if the two values match, denying access otherwise.</p>
<p><img alt="" src="https://assets.omscs.io/notes/AD80CACB-6AB4-4DA1-9911-CAF3D486D978.png" /></p>
<p>The advantage of this scheme is that the system only has to store the hashed passwords. If the system chose to store the cleartext passwords, then anyone who has access to the system can impersonate anyone else registered on the system after reading the password file.</p>
<p>If an attacker gains access to a system, they can steal the hashed passwords and compare the hashes against a dictionary of commonly-used passwords and their hashes to find matches. We must avoid using common passwords like "password" and "123456".</p>
<h2>Hash Function Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/333D362C-324B-4AE9-9256-66111A0EAA3B.png" /></p>
<h2>Hash Function Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9FCFF378-D376-46B5-8734-E5DB63549DCA.png" /></p>
<p>The <strong>avalanche effect</strong> states that a small change in the input to a hash function causes a large change to the output. We want this in place as a way to obscure similar passwords. Without the avalanche effect, an attacker may be able to deduce password <code>A</code> from its hash value if he knows that the hash of a string <code>B</code> is similar to <code>A</code>'s hash.</p>
<h2>Symmetric Encryption</h2>
<p>Symmetric encryption uses the same key for both encryption and decryption. The encryption algorithm takes the plaintext and the key as input and produces the ciphertext using substitution and permutation. The decryption algorithm reverses the encryption process, reproducing the original plaintext from the key and the ciphertext.</p>
<p><img alt="" src="https://assets.omscs.io/notes/DE62E9FB-9D84-40E9-8188-FA81DA9D5E9C.png" /></p>
<h2>Comparison of Encryption Algorithms</h2>
<p>The most important symmetric algorithms are the <a href="https://en.wikipedia.org/wiki/Data_Encryption_Standard">Data Encryption Standard</a> (DES) block cipher and the <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">Advanced Encryption Standard</a> (AES) block cipher. A <strong>block cipher</strong> encrypts plaintext in fixed-size blocks and produces ciphertext blocks of equal size. DES and AES use different key sizes and block lengths.</p>
<p><img alt="" src="https://assets.omscs.io/notes/B43E6CEB-8431-4738-AA7A-1DBAEEEFB90C.png" /></p>
<p>Since a longer key indicates a larger keyspace, DES and AES can be distinguished by the amount of time necessary to successfully conduct a brute-force attack. The following table shows how much time is required to brute-force various ciphers with different key lengths.</p>
<p><img alt="" src="https://assets.omscs.io/notes/AC07E8B6-686C-4967-9320-8013388C4B49.png" /></p>
<p>Note that DES - now seen as insecure - is breakable within an hour using a supercomputer. Ciphers with key lengths of 128 bits or greater are effectively unbreakable using modern processing power.</p>
<h2>Symmetric Encryption Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1E31561D-622A-48AB-8B4B-D46F37A11AD1.png" /></p>
<h2>Symmetric Encryption Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/5F18ADCF-329B-4A37-9876-305990D371B2.png" /></p>
<h2>Asymmetric Encryption</h2>
<p>While symmetric encryption uses the same key for encryption and decryption, <strong>asymmetric encryption</strong> uses two keys: one for encryption and the other for decryption. The two keys are paired together mathematically such that if one key encrypts a message, only the other key can decrypt it.</p>
<p>To communicate using asymmetric encryption, a user must first generate a pair of keys. The <strong>public key</strong> can be sent to other users, while the <strong>private key</strong> must be known only to the user. A user might have a collection of public keys, one for each user with whom they communicate regularly.</p>
<p>If Bob wants to send a private message to Alice, Bob must first obtain Alice's public key. With Alice's public key in hand, Bob encrypts his message to Alice using an asymmetric encryption algorithm such as <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)">RSA</a>. Bob then transmits the ciphertext to Alice, which she can decrypt using her private key.</p>
<p><img alt="" src="https://assets.omscs.io/notes/8215B680-F699-4223-BADB-64C030A6CF44.png" /></p>
<h2>Asymmetric Encryption Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2CAA6C73-F6D0-4797-B4A7-FABFA269EFF6.png" /></p>
<h2>Asymmetric Encryption Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1374D8F4-378E-4CD8-9B80-511E87EA2F3C.png" /></p>
<h2>Digital Signatures</h2>
<p>The public key in public-key encryption is genuinely public. Any user can broadcast their public key to the world for any other user to consume. Although this approach is very convenient, it has a significant weakness: any user can forge such a public announcement.</p>
<p>For example, an attacker can pretend to be Bob and send a public key to Alice. When she goes to send a message to the real Bob using the imposter's key, the attacker can intercept and decrypt the message. If Bob discovers that an attacker is forging his identity, he can send Alice his real public key, but a better solution to the problem is one that prevents the forgery in the first place.</p>
<p>Bob can prevent the forgery by obtaining a <strong>public key certificate</strong> from a certification authority (CA). Bob can contact the CA and provide them with his authentication information, such as his driver's license or his user id, as well as his public key.</p>
<p>The CA then constructs Bob's certificate using his identification, his public key, and some other information, such as the period of validity for the certificate. Finally, the CA hashes and signs this information with their private key and then appends this hash to the certificate.</p>
<p>Now Bob can send his public key certificate to Alice. When Alice receives the certificate, she can extract the key as well as the information about Bob and the certificate itself. Alice can then hash the certificate and use the CA's public key to decrypt the signed, appended hash. If the two hashes match, she can be sure that no one has tampered with the certificate.</p>
<p><img alt="" src="https://assets.omscs.io/notes/DA7D2F48-C67B-4112-94EC-2459B17D9893.png" /></p>
<p>The underlying assumption is that the CA is a trusted party by everyone involved. In practice, the CA is a well-known company, such as VeriSign, Microsoft, Google, or Apple. Their public keys are already in your software - such as your browser - so they can automatically validate certificates that they have signed.</p>
<h2>Digital Envelopes</h2>
<p>Public-key encryption is typically used to establish a symmetric key, which is then used to encrypt subsequent communications amongst parties.</p>
<p>Suppose Alice and Bob wish to communicate securely.</p>
<p>Alice first creates a random symmetric key that she wants to share with Bob and encrypts her message to Bob using this key. She then encrypts the symmetric key with Bob's public key and transmits a <strong>digital envelope</strong> containing both the message and the encrypted key to Bob.</p>
<p><img alt="" src="https://assets.omscs.io/notes/68B24E81-900B-4504-8D8C-74143A815C77.png" /></p>
<p>When Bob receives the envelope, he can use his private key to decrypt the encrypted symmetric key. With the decrypted key in hand, he can decrypt the actual message from Alice.</p>
<p><img alt="" src="https://assets.omscs.io/notes/258777EB-CFF5-4D68-B65F-793FFE4B1737.png" /></p>
<h2>Encryption Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/623ADEEA-F8E3-4CC7-A61B-51EC26C8F93B.png" /></p>
<h2>Encryption Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/CB248B54-A4DA-49D9-A9DC-477AE73A38B3.png" /></h2>
<p>id: information-security-intrusion-detection
title: Intrusion Detection
course: information-security
lecture: intrusion-detection</p>
<hr />
<h1>Intrusion Detection</h1>
<h2>Defense in Depth</h2>
<p>Recall the <em>defense in depth</em> principle: we need multiple layers of defense mechanisms. We typically deploy prevention systems to block attacks, but some intrusion attempts are always going to get through. If we can't stop an attack, at the very least, we need to detect it. Specifically, we need to deploy intrusion detection systems to inform us when an attack occurs.</p>
<h2>Intrusion Examples</h2>
<p>An intrusion is any attack that aims to compromise the security goals of an organization. The following activities are all examples of intrusion.</p>
<p><img alt="" src="https://assets.omscs.io/notes/A81B7CB1-5D34-4455-926E-A6E8F4F47C05.png" /></p>
<h2>Intrusion Detection Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6FCC8EA1-D76B-4CD2-A7B2-C959F599631A.png" /></p>
<h2>Intrusion Detection Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/D8BA0592-C705-4DEA-8677-C198872DAD54.png" /></p>
<h2>Intrusion Detection System (IDS)</h2>
<p>An <strong>intrusion detection system</strong> (IDS) can be quite effective against well-known or less sophisticated attacks, such as large scale email phishing attacks.</p>
<p>However, as attack techniques become more sophisticated, IDS's become less effective. For example, attackers can blend attack traffic with normal activities, making detection of these attacks much more difficult.</p>
<p>The most sophisticated attackers, such as state-sponsored individuals, may use new, zero-day exploits. IDS's are not effective against brand new types of attacks.</p>
<p><img alt="" src="https://assets.omscs.io/notes/273BDEC1-5082-48B8-AF4B-63F124572832.png" /></p>
<p>Since IDS's are not completely effective, they need to be part of the broader defense-in-depth strategy for an organization.</p>
<p>Other standard security strategies include:</p>
<ul>
<li>encrypting sensitive information</li>
<li>providing detailed activity audit trails</li>
<li>using robust authentication and access control practices</li>
<li>actively managing operating system/application security</li>
</ul>
<h2>Intruder Behavior</h2>
<p>The techniques and behavioral patterns of intruders are continually evolving to exploit newly discovered weaknesses and evade detection and countermeasures. However, attackers generally follow the same high-level steps when conducting an attack.</p>
<p>The following diagram illustrates these steps.</p>
<p><img alt="" src="https://assets.omscs.io/notes/FA43CDAE-2AD3-46FF-9FB1-FAD88B9BB62E.png" /></p>
<p>The first step is target acquisition and information gathering. An attacker identifies the target systems using publicly available technical and non-technical information.</p>
<p>From a technical perspective, the attacker might use network tools to analyze target resources, such as determining which network services are accessible over the Internet. A less technical step might involve looking at organizational email patterns - like lastname.firstname@company.com -  to discern the addresses of some high-level executives.</p>
<p>The second step is the initial access. An attacker gains access by exploiting a remote network vulnerability. For example, a network service may have a buffer overflow vulnerability that an attacker can exploit remotely. Alternatively, an attacker can gain access through social engineering by, for example, sending an email with a malicious attachment to a company executive.</p>
<p>The third step is privilege escalation. In this step, the attacker tries to use a local exploit to escalate their privilege from an unprivileged user to a root user on the target system.</p>
<p>The fourth step is information gathering or system exploit. After an attacker gains sufficient privilege on a system, they can find out more about the network and the organization, and even move to another target system to advance the exploit further.</p>
<p>The fifth step is maintaining access. An attack might not be a one-time action; that is, an attacker may choose to come back from time to time or continue the exploit over an extended period. The attacker may install backdoors or other malicious software on the target system to maintain access.</p>
<p>Finally, the attacker must cover their tracks. They can edit or disable the system audit logs to remove evidence of attack activities. Alternatively, they might install rootkits to hide any installed malware.</p>
<h2>Intruder Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/62299D09-AF06-4DCC-8C70-37251796390A.png" /></p>
<h2>Intruder Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/BE79FB0F-8998-4A34-9B1D-89C3DF2DFA2E.png" /></p>
<h2>Types of Backdoors Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/7BB48E4A-080C-41DF-BDFF-981789BA55DC.png" /></p>
<h2>Types of Backdoors Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/72F9A46A-F7C2-43E0-84F0-BC956FF413A6.png" /></p>
<p>Read more <a href="http://www.infoworld.com/article/2606776/hacking/155947-Biggest-baddest-boldest-software-backdoors-of-all-time.html#slide3">here</a>, <a href="https://www.gnu.org/philosophy/proprietary-back-doors.html">here</a>, and <a href="https://www.eecs.berkeley.edu/~daw/teaching/cs261-f07/scribenotes/1025-brian.pdf">here</a>.</p>
<h2>Elements of Intrusion Detection</h2>
<p>For intrusion detection to be possible, we need to make some important assumptions. First, we have to assume that we can observe system, network, and user activities. Second, we have to assume that we can distinguish intrusive activities from ordinary activities.</p>
<p>When building an intrusion detection algorithm, we must consider the following. First, we need to identify the behavioral <em>features</em> and activities that we want to capture from the system. Second, we must synthesize our detection <em>models</em>; that is, we need to stitch together the evidence we collect to determine whether a pattern of activity represents an intrusion.</p>
<p>An IDS typically includes several modules, including:</p>
<ul>
<li>an audit data preprocessor</li>
<li>a knowledge base</li>
<li>a decision engine</li>
<li>alarm generation and response mechanisms</li>
</ul>
<h2>Components of Intrusion Detection Systems</h2>
<p>The input to an IDS is network and system data that provides a snapshot of the activity currently taking place within a computer system. The <strong>data preprocessor</strong> reads this data and extracts <em>activity records</em> that are important for security analysis.</p>
<p>The <strong>detection engine</strong> analyzes the activity records using detection models packaged with the IDS. If a detection rule determines that an intrusion is happening, the IDS produces an alert.</p>
<p>The <strong>decision engine</strong> responds to the alert and decides the appropriate action according to a <em>decision table</em>. In one case, an action might be tearing down a particular network connection while, in another case, the action might be sending a report to the security admin.</p>
<p><img alt="" src="https://assets.omscs.io/notes/2F43AC16-2FBD-49ED-A24C-48CA492E8E7A.png" /></p>
<p>Again, for the IDS to work correctly, we must be able to assume that system activities are observable and that ordinary and intrusive activities have distinguishable features.</p>
<h2>Intrusion Detection Approaches</h2>
<p>From a modeling and analysis perspective, there are two different approaches to intrusion detection. The <strong>misuse detection</strong> - signature-based - strategy models known intrusions, while <strong>anomaly detection</strong> models look for abnormal behavior, regardless of whether they have explicitly been seen previously in exploits.</p>
<p>From a deployment perspective, we can position an IDS on end hosts or at network perimeters.</p>
<p>From a development and maintenance perspective, we can create build detection models using manual encoding of expert knowledge - basically static rules translated into code - or we can apply machine learning algorithms to data to automatically learn the detection rules.</p>
<h2>Analysis Approaches</h2>
<p>Anomaly detection consists primarily of two phases. In an initial training/profiling phase, the anomaly-based IDS collects system data corresponding to ordinary activity and uses data analysis algorithms to constructs a model representing this baseline state. After, the model continuously analyzes live system activity relative to the baseline to determine whether system activity is anomalous.</p>
<p>Misuse or signature-based detection involves first encoding known attacks into patterns or rules and then comparing current system activity against these patterns to determine if there is a match. Obviously, this approach can only detect known attacks.</p>
<h2>Analysis Detection Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F83D983E-10A9-4BFC-9007-006DA276551C.png" /></p>
<h2>Analysis Detection Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3804546D-535E-4812-99F9-68C4039BA79A.png" /></p>
<h2>Signature Detection Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/54F22B6A-68FA-478A-9A18-6697555EE8C2.png" /></p>
<h2>Signature Detection Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/45F0F4C2-AE2D-4F2E-9598-779B6D797F58.png" /></p>
<h2>A Variety of Classification Approaches</h2>
<p>In the training phase, an anomaly-based IDS develops a model of normal or legitimate behaviors by collecting data from the normal operations of the monitored system or network. In the detection phase, the IDS compares observed behavior against the model and categorizes it as either legitimate or anomalous.</p>
<p>IDS developers can use a variety of approaches to construct these models. The statistical approach applies univariate, multivariate, or time-series models to observed metrics. The knowledge-based approach encodes legitimate behavior into a set of rules using expert knowledge. The machine learning approach uses data mining and machine learning techniques to learn a model from training data automatically.</p>
<p>When we compare these approaches, we need to consider both efficiency - how quickly can a system learn and apply a model - and cost - how much data and computation power we need to build that model.</p>
<h2>Anomaly Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B557672F-381D-4AA9-B3E0-79D35CA0CA65.png" /></p>
<h2>Anomaly Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/EFCDDFD7-05BB-4564-8CD3-6CA8FBF651E7.png" /></p>
<h2>Statistical Approaches</h2>
<p>Statistical approaches use captured system data as training input to develop a model of normal behavior. The earliest approaches used univariate models, where each metric - the CPU utilization of a program, for example - was treated as an independent random variable.</p>
<p>However, this approach was too crude to detect intrusions effectively. Later statistical systems used multivariate models that consider the correlations between the measures. For example, these systems might examine both CPU utilization and memory size of a program together.</p>
<p>More recent systems incorporate time-series models that consider the order and timing between observed events. For example, these systems might examine the amount of time elapsed between when a user logs into a workstation and when that workstation sends an email.</p>
<p>The main advantage of statistical approaches is that they are relatively simple, easy to compute, and they don't have to make many assumptions about behavior. On the other hand, the effectiveness of these approaches relies on selecting the right set of metrics to examine and correlate, which is a difficult task. Additionally, there are complex behaviors that are beyond the capability of these models.</p>
<h2>Knowledge Based Approach</h2>
<p>Knowledge-based approaches require experts to develop a set of rules that describe the normal, legitimate behaviors observed during training. These rules can separate activities into different classes; for example, a rule might state that a secretary <em>normally</em> only uses office productivity programs, like web browsers, email, calendar, and Microsoft office.</p>
<p>These rules can be quite robust, and systems built with this approach are relatively easy to update and improve. On the other hand, these approaches rely on manual efforts of experts, and these experts must have strong knowledge of the data and the domain.</p>
<h2>Statistical &amp; Knowledge Based Approaches Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FD8DAA8E-9BDA-49E7-B155-99D4ED73C602.png" /></p>
<h2>Statistical &amp; Knowledge Based Approaches Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/795F294B-48FC-4667-89FB-BEFB856FF9B3.png" /></p>
<h2>Machine Learning Approaches</h2>
<p>Machine learning approaches can build a model automatically using the labeled, normal training data. A machine learning algorithm takes as input examples of normal data and outputs a model that is then able to classify subsequently observed data as either normal or anomalous.</p>
<p>Machine learning models are powerful in that they can handle small changes or variations in the observed data and can also capture complex interdependencies between different observed features.</p>
<p>For these approaches to be effective, the normal training data must be representative of normal behaviors; otherwise, the learned model can produce many false positives. Additionally, the training phase of machine learning requires a lot of data, and significant time and computational resources. However, once the model is produced, subsequent analysis is typically reasonably efficient.</p>
<h2>Machine Learning Intruder Detection Approaches</h2>
<p>IDS can use a variety of machine learning algorithms.</p>
<p><strong>Bayesian networks</strong> encode the conditional probabilities between observed events - the probability that a user is sending an email if the current time is 2 AM, for example. A system might raise an alert if it observes an event that has a significantly low probability of occurring.</p>
<p><strong>Markov models</strong> are sets of states connected by transitional probabilities. For example, a system can use Markov models to model legitimate website names. The transitional probabilities from one letter to the next in a URL should be similar to that of real dictionary words.</p>
<p>On the other hand, a randomly-spelled website name is anomalous and might indicate a botnet C&amp;C server, since bots don't have to type out URLs.</p>
<p><strong>Neural networks</strong> simulate how human brains perform reasoning and learning and are one of the most powerful machine learning approaches.</p>
<p><strong>Clustering</strong> groups training data into clusters based on some similarity or distance measure and then identifies subsequently observed data as either a member of a cluster or an outlier.</p>
<p>For example, legitimate traffic from an internal network to an internal web server shares common characteristics that can be grouped into clusters based on the web pages visited. On the other hand, an attack may access data on the web server that is rarely visited, making it an outlier.</p>
<h2>Machine Learning Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F832A03B-6CE6-465D-87EB-1766FA05D423.png" /></p>
<h2>Machine Learning Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B66DFC3A-5CAF-4FBF-ACCC-B2EE1F2F0F1E.png" /></p>
<h2>Limitations of Anomaly Detection</h2>
<p>A fundamental limitation of anomaly detection models is that they train using only normal or legitimate data. Since these models do not see any intrusion data during training, they cannot be sure that a general anomaly is evidence specifically of an intrusion.</p>
<h2>Anomaly Detection Example</h2>
<p>Here is an example of a straightforward anomaly detection approach.</p>
<p><img alt="" src="https://assets.omscs.io/notes/95F46611-4D5A-4750-B2EE-B3580E4659A3.png" /></p>
<p>First, the system establishes a normal, statistical runtime profile of a program. The system generates this profile by running the program many times, recording important metrics - CPU utilization and memory size, for example - each time, and then computing the mean and variance for each captured metric.</p>
<p>Once the IDS builds the profile, it can then compare subsequent system activity against this profile. If it observes that activity deviates from the means beyond the allowed variances, the IDS outputs an alert.</p>
<p>Again, the main drawback of the anomaly detection approach is that it can produce relatively high false-positive rates because an anomaly can be a new, unobserved, yet normal activity.</p>
<h2>Misuse or Signature Detection</h2>
<p>Misuse or signature-detection systems surface intrusions by comparing activity data against a local database of known intrusion patterns. If they detect a match in activity patterns, they can conclude that an intrusion has occurred; otherwise, the system is likely functioning normally.</p>
<h2>Anomalous Behavior Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/73D531B9-DAB0-4B29-93CE-057BE5A1F4B0.png" /></p>
<h2>Anomalous Behavior Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9E4397E7-D80E-4A34-8B6F-5F22F297369E.png" /></p>
<h2>Signature Approaches</h2>
<p>Many misuse detection approaches use <strong>signatures</strong>,  known patterns of malicious activity data, to categorize current system activity as malicious or benign. To maximize the detection rate and minimize the false-positive rate, the set of signatures against which these systems compare activity needs to be as large as possible. Signature-based approaches are most commonly found in anti-virus software and network intrusion detection systems.</p>
<h2>Signature Approach Advantages &amp; Disadvantages</h2>
<p>Signatures are typically straightforward to understand, and signature matching is very efficient; therefore, signature-based approaches are widely used. On the other hand, significant manual effort must be spent to create new signatures every time a new malware or attack method appears. Additionally, these approaches cannot detect zero-day attacks because those attacks are new and do not yet have known signatures.</p>
<h2>Zero Day Market Place Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/60C770A8-12A9-4FA4-A475-CECF25987C9D.png" /></p>
<h2>Zero Day Market Place Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2AE76DB1-1D8B-448A-8256-C61796C19DE4.png" /></p>
<h2>Rule Based Detection</h2>
<p>In addition to signature-based strategies, a misuse detection system can also use a more sophisticated, rule-based approach. This approach uses rules to represent known intrusions, which typically match multiple signatures.</p>
<p>These rules are not only specific to known intrusions but can also be tweaked to fit the network, as the same intrusion may leave different evidence in different networks depending on the network setup. <a href="https://www.snort.org/">Snort</a> is a widely-known example of a rule-based network intrusion detection system.</p>
<h2>Misuse Signature Intruder Detection</h2>
<p>The IDS matches the observed activities using a set of attack signatures or patterns. If there is a match, the IDS outputs an alert.</p>
<p><img alt="" src="https://assets.omscs.io/notes/442FE44B-A994-48BC-909C-1DCF6161F7E4.png" /></p>
<p>For example, the system may raise an alarm if it spots the so-called "land attack" defined in the picture above. Again, such a simple approach cannot detect new attacks since they don't have signatures.</p>
<h2>Attacks Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F5CFF1A9-853F-4258-9A6A-C5ACDD8C643A.png" /></p>
<h2>Attacks Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/4D15090A-E7EB-4230-BD11-E816124BDA06.png" /></p>
<h2>Monitoring Networks and Hosts</h2>
<p>An IDS typically performs passive monitoring; that is, it records and analyzes data about system and network activities while these activities continue to take place.</p>
<p>The IDS doesn't affect activities directly, but rather only outputs alerts. In response to these alerts, the system can intervene and alter activity by, for example, blocking a network connection or terminating a program.</p>
<h2>Network IDS</h2>
<p>We can deploy an intrusion detection system at the perimeter of a network or subnet to monitor inbound and outbound network traffic. Such a system is called a <strong>network intrusion detection system</strong> (NIDS).</p>
<p>NIDS's typically use a packet-capturing tool like <code>libpcap</code> to obtain network traffic data. The captured packet data contains the complete information about network connections; for example, TCP handshake information, as well as all of the URL requests from the client and the returned page contents from the server.</p>
<p>Since a NIDS can see all of the data sent and received by a user's machine, it can raise an alert if it detects something has gone awry. If the user's machine is infected by a bot malware, for example, the NIDS will see attempts to connect to a website for command and control, and it can generate the appropriate alert.</p>
<h2>Network Based IDS (NIDS)</h2>
<p>A NIDS monitors traffic in real-time or close to real-time so that it can react to intrusions promptly. It can analyze traffic in multiple layers of the network stack, responding to network-, transport-, or application-level protocol activity.</p>
<p>A NIDS can include several sensors, each of which typically monitors the traffic of a subnet and reports its findings to a backend management server. This server correlates evidence across multiple sensors to provide intrusion detection across the whole network.</p>
<p>Additionally, a NIDS may provide one or more management consoles for use by human analysts needing visibility into network activity.</p>
<h2>Host IDS</h2>
<p>We can also deploy an IDS in an end host. Most host-based IDS's use <code>ptrace</code>  to obtain the system calls made by a program as a way to monitor program behavior.</p>
<p>System call data is crucial for security monitoring because the operating system manages critical system resources. Therefore, whenever a program requests a resource, such as memory allocation or access to the filesystems, networks, or I/O devices, it must make a system call to the operating system.</p>
<p>For example, If a user's browser receives a page containing malicious javascript that breaks the protection in the browser and attempts to overwrite a Windows registry file, the IDS will observe a write system call to the registry file and can generate an alert.</p>
<h2>NIDS Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6B45119B-AA0A-47F6-822D-A5FC37269B12.png" /></p>
<h2>NIDS Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/05B818DD-0EA3-4203-B87D-3DE4FD93663C.png" /></p>
<h2>Inline Sensors</h2>
<p>One way to configure a network IDS is by using <em>inline sensors</em>. The primary motivation for using inline sensors is to enable them to block an attack upon detection. In such cases, an inline sensor performs both intrusion detection and intrusion prevention.</p>
<p>We must place the sensor at a network point where traffic must pass through it for this strategy to be effective. We can deploy an inline sensor as a combination of a network IDS and a firewall in a single piece of hardware, or we can deploy the inline sensor as a standalone inline network IDS.</p>
<h2>Passive Sensors</h2>
<p>More commonly, we deploy network IDS's as passive sensors. A <em>passive sensor</em> only receives a copy of live traffic, and therefore cannot provide any intrusion protection; however, from a network performance perspective, this approach is much more efficient.</p>
<p>The following diagram illustrates a typical passive sensor configuration.</p>
<p><img alt="" src="https://assets.omscs.io/notes/AEC5210B-16A2-42E4-85A8-FDC2647DD69E.png" /></p>
<p>The sensor connects to the network transmission medium, such as an ethernet cable, through a direct physical tap that provides the sensor with a copy of all network traffic carried by the medium.</p>
<p>The network interface card (NIC) for the tap usually does not have an IP address configured for it, which means that the data collection side of the sensor is unreachable outside of the tap. The sensor has a second NIC that connects to the network with an IP address so that it can communicate with one or more backend management servers.</p>
<h2>Firewall Versus Network IDS</h2>
<p>A network IDS performs passive monitoring. While the IDS is copying and analyzing network traffic, the traffic continues to flow to its destination.</p>
<p>Traffic analysis can take a lot of computing power, and a large volume of traffic can overload an IDS, preventing it from detecting intrusion in a timely manner. We call this situation <em>fail-open</em>, meaning that the network is open to intrusion when the IDS fails.</p>
<p>A firewall performs active filtering. All traffic must pass through the firewall, and the firewall performs relatively simpler and more efficient analysis.</p>
<p>A large volume of traffic can overload a firewall as well. When this happens, it prevents all traffic from passing through. We call this <em>fail-close</em>, meaning that when a firewall fails, the internal network is closed to the external network, and is safe from intrusion.</p>
<h2>IDS Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/30738940-A839-4656-B153-027BD6CF97A0.png" /></p>
<h2>IDS Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/8FB406A3-4B50-49BB-AA37-C33F19784845.png" /></p>
<h2>NIDS Sensor Deployment</h2>
<p>Here is an example of an enterprise network configuration. The internal network has multiple subnets, and the enterprise has public-facing services, such as a public web server.</p>
<p><img alt="" src="https://assets.omscs.io/notes/68732232-8261-426E-BC69-10055BE2AFE2.png" /></p>
<p>Recall our lecture on firewalls. We typically want to place an external firewall to protect the entire enterprise network. Additionally, we want to protect the internal network from the public-facing servers. We place these servers in a DMZ, and we use internal firewalls to monitor traffic between the DMZ and the internal subnets. The internal firewalls also monitor traffic between the subnets.</p>
<p><img alt="" src="https://assets.omscs.io/notes/8E0416F9-8E58-43EC-A25E-B721A786C746.png" /></p>
<p>A common location for an IDS sensor is just inside the external firewall, a position which has several advantages.</p>
<p>An IDS in this position has an excellent vantage point. It can see attacks from the outside world aimed at the internal network as well as the public-facing servers in the DMZ.</p>
<p>Additionally, because the IDS in this position monitors all outgoing traffic across the entire enterprise network, it can also detect attacks originating from a compromised server either in the DMZ or the internal network.</p>
<p>As well, since the IDS sits just inside the external firewall, we can compare the logs of the IDS against the logs of the firewall to see whether the firewall missed an attack it should have prevented.</p>
<p>We can also place our IDS between the external network and the Internet. The main advantage of this location is that the IDS can see all attempted attacks aimed at the enterprise network, including those attacks that might be filtered by the external firewall.</p>
<p>For example, if the external firewall is overloaded, it not only drops incoming attack packets, but it might not even have the resources to log these packets. An IDS at this location can see the packet and log it.</p>
<p>We can also deploy the IDS at a subnet boundary. Compared with the IDS at the perimeter, which has to examine all traffic, an IDS at this location can perform a more detailed analysis of traffic data since it has less traffic to monitor. Additionally, a subnet IDS can detect intrusions from inside the network.</p>
<p>As well as protecting a subnet, an IDS can also protect the workstations or networks of important personnel or departments. An IDS at this location focuses on targeted attacks, such as attacks aimed at financial transaction systems.</p>
<p>Compared with an IDS at the network perimeter, which must examine traffic across the whole network, an IDS at this location can instead focus exclusively on traffic to high-value systems.</p>
<p><img alt="" src="https://assets.omscs.io/notes/764D22DC-D141-4A48-AAC3-AE83FF81C10C.png" /></p>
<h2>NIDS Sensor Deployment Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/599591ED-6BDC-4FCF-BA83-BBC590E815E7.png" /></p>
<h2>NIDS Sensor Deployment Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/63258409-141A-434F-B9CD-8DF34C46C864.png" /></p>
<h2>Snort</h2>
<p><strong>Snort</strong> is an open-source, easily configurable, lightweight network IDS that can be easily deployed on most nodes of a network, including end hosts, servers, and even routers.</p>
<p>Snort can perform real-time packet capture, protocol analysis, and packet content-searching, and it consumes only a small amount of memory and processor time to perform its tasks.</p>
<p>Snort can detect a variety of intrusions based on the rules configured by a sysadmin. Helpfully, there is a community that maintains an extensive set of Snort rules that can be further configured by sysadmins for the needs of their networks.</p>
<h2>Snort Components</h2>
<p>The Snort system has four logical components.</p>
<p>The <strong>packet decoder</strong> processes each captured packet to identify the protocol headers at the data link, network, transport, and application layers.</p>
<p>The <strong>detection engine</strong> performs the actual work of intrusion detection and checks each packet against a set of rules to determine if the packet matches a characteristic of a rule. If the engine finds a match, it triggers the action specified by the matching rule or rules; otherwise, it discards the packet.</p>
<p>Each rule specifies what <strong>logging</strong> or <strong>alerting</strong> steps the system should take. The logger stores the detected packet in a human-readable format. A sysadmin can then use the log files for later analysis. Alternatively, the system can send alerts to a file, database, or email, among other options.</p>
<p><img alt="" src="https://assets.omscs.io/notes/257640DB-55BF-4CE2-976C-DEFE66F72F9B.png" /></p>
<h2>Snort Configuration</h2>
<p>Snort can be configured as inline or passive. In passive mode, it merely copies and monitors traffic, and the traffic does not pass through it directly. In other words, in passive mode, Snort is configured for intrusion detection only.</p>
<h2>Snort Rules</h2>
<p>Snort uses a simple and flexible rule definition language. Each rule consists of a row header and a number of options.</p>
<p><img alt="" src="https://assets.omscs.io/notes/7F70B878-2CA1-4400-B42A-F491DBB3CE79.png" /></p>
<h2>Snort Rules Options</h2>
<p>We specify our intrusion detection logic in the rule options, of which there are four main categories.</p>
<p><strong>Metadata</strong> options allow us to provide information about the rule but do not have any effect on intrusion detection.</p>
<p>We specify the logic to examine the packet payload in the <strong>payload</strong> options, and we specify the logic to examine the packet headers in the <strong>non-payload</strong> options.</p>
<p><strong>Post-detection</strong> options allow us to specify actions that the system will fire after a match has occurred, such as storing the packet information in a table so that we can correlate it with other packets.</p>
<h2>Snort Rule Actions</h2>
<p>The most important field in the Snort rule header is the <strong>action</strong> field, which tells Snort what to do when a packet matches a rule.</p>
<p>The following table describes the possible actions, the last three of which are only available in inline mode.</p>
<p><img alt="" src="https://assets.omscs.io/notes/96AC6825-D319-4B58-AD38-C74D47C375F9.png" /></p>
<p>To summarize, a Snort rule includes a header and multiple options. Each option consists of an option keyword, which defines the option, followed by arguments, which specify the details of the option.</p>
<p><img alt="" src="https://assets.omscs.io/notes/EB24765E-CB29-4A24-8F8B-13F7179341F5.png" /></p>
<h2>Snort Rule Example</h2>
<p>Typically, the root user account is only used for specific privileged operations, such as backing up filesystems and setting up subnetworks. A root account rarely sends email, and such an event should trigger an alert.</p>
<p>Here is an example of how Snort can capture and respond to this event.</p>
<p><img alt="" src="https://assets.omscs.io/notes/1F19DBF9-0CB7-4E44-909A-42B098E4A7C4.png" /></p>
<p>It looks for traffic to the SMTP port on any host in the /24 subnet and checks if the content of the email contains "mail from root", which indicates that a root user is attempting to send email. Snort then sends an alert with the following message: "root user attempts to send an email".</p>
<p>The content keyword used above is one of the more important features of Snort. It allows sysadmins to set rules that search for specific content in the packet payload and then trigger responses based on that data.</p>
<h2>Snort Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/73F79545-4C3F-44B2-A4EC-DA4D4E300729.png" /></p>
<h2>Snort Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/207F97E0-2041-461C-864F-27A2D73B4924.png" /></p>
<h2>Honeypots</h2>
<p>Honeypots are another component of the intrusion detection architecture. <strong>Honeypots</strong> are decoy systems designed to lure attackers away from critical systems.</p>
<p>By diverting attackers from valuable systems to honeypots, we can observe what they are trying to do to our systems and networks. Based on that information, we can develop strategies to respond to their attacks.</p>
<p>A honeypot system gives the appearance that any attack against it is successful. This apparent ease of compromise attracts attackers to a honeypot and keeps them there, which allows us to gather more information about their attacks.</p>
<p>Typically, a honeypot is filled with fabricated information to make it appear as if it is a valuable system on the network. Most importantly, a honeypot is not a real system used by any real user.</p>
<p>A honeypot system is instrumented with monitors and event loggers so that any access to or activity on the honeypot system is logged.</p>
<p>Since a honeypot is not a real system and has no production value, any access to it is not legitimate. Most likely, any inbound connection to a honeypot is a network scan or a direct attack. Any outbound traffic from the honeypot indicates that the system is most likely compromised.</p>
<h2>Honeypots Classification</h2>
<p>A <strong>low interaction</strong> honeypot typically emulates some network services, such as the web server, but does not provide a full version of the service. For example, an emulated web server may be able to "speak" HTTP but might not contain all the web contents and server-side programs.</p>
<p>A low interaction honeypot is typically sufficient to detect basic network scans and probes and warn of imminent attacks. On the other hand, these weakly emulated services may not fool a sophisticated attacker, who might realize early on that these services are not real.</p>
<p>A <strong>high interaction</strong> honeypot essentially replicates a real server or workstation in terms of operating systems, services, and applications. They look realistic, and they can be deployed alongside the real servers and workstations.</p>
<p>Since a high interaction honeypot mimics a system, an attacker might attack it for an extended time without realizing that it is a honeypot. This large attack window gives us more time to learn about the attacks.</p>
<p>On the other hand, making a honeypot look like a real server or workstation is quite challenging. For example, we must emulate user activities and network traffic on the honeypot, which requires a significant amount of programming effort and data storage.</p>
<h2>Honeypot Deployment</h2>
<p>We can deploy honeypots to a variety of locations within a network.</p>
<p><img alt="" src="https://assets.omscs.io/notes/29FCE3CC-C998-4CAF-8E4F-388CF06B73ED.png" /></p>
<p>A honeypot placed outside of the external firewall is useful for checking attempts to scan or attack the internal network. The main advantages of placing the honeypot at this location are that first, it has no side effects, and second, it reduces the amount of attack traffic the firewall has to process. However, a honeypot at this location cannot trap internal attackers.</p>
<p>We can also place a honeypot in the DMZ, alongside public-facing servers, to trap attacks targeted at these services. A honeypot at this location may not be able to trap interesting attacks, because a DMZ is typically not accessible outside of a well-defined set of public-facing services. As a result, the external firewall can block virtually all attack traffic destined for the DMZ.</p>
<p>Finally, we can also place a honeypot in the internal network alongside servers and workstations. The main advantage of this configuration is that it can catch internal attacks. Additionally, it can detect a misconfigured firewall that forwards non-permissible traffic from the Internet to the internal network.</p>
<p>On the other hand, unless we can trap the attacker entirely in the honeypot, the attacker may be able to reach other internal systems.</p>
<p>As well, if we want to continue to attract and trap an attacker, we must continue to allow attack traffic from the Internet to reach the honeypot. This step might involve opening up the external firewall to allow this attack traffic to enter, which carries a considerable security risk.</p>
<h2>Honeypot Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6BBDB4A2-6E49-4DD1-B761-1BED24EB3322.png" /></p>
<h2>Honeypot Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/C6889A78-B3F7-4738-B4CF-B81149D61644.png" /></p>
<h2>Evaluating IDS</h2>
<p>We typically use accuracy metrics to evaluate the detection algorithm. We use <strong>detection rate</strong> or <strong>true positive rate</strong> to measure how well an IDS can detect an intrusion. More specifically, the detection rate measures how likely the IDS outputs an alert, given that an intrusion is present. We can also use the <strong>false negative rate</strong>, the probability that, given an intrusion, an alert is not triggered.</p>
<p>Alternatively, we can look at the <strong>false alarm rate</strong>. This rate measures the probability that the IDS generates an alert, given that there is no intrusion. We can also use the <strong>true negative rate</strong>, the probability that an alert is not triggered given an intrusion is not present.</p>
<p>We might also want to know the <strong>Bayesian detection rate</strong> of an IDS; that is, the probability that an intrusion has occurred, given that an alert is raised.</p>
<p>We can more formally summarize these metrics, using the probability <code>A</code> of an alarm being raised and the probability     <code>I</code> of an intrusion occurring.</p>
<p><img alt="" src="https://assets.omscs.io/notes/57BBCA28-01CA-4BFA-917B-BF8CC3D42C11.png" /></p>
<p>The detection rate is the probability of <code>A</code>, given <code>I</code>. The false negative rate is the probability of not <code>A</code>, given <code>I</code>. The false alarm rate is the probability of <code>A</code>, given not <code>I</code>. The true negative rate is the probability of not <code>A</code>, given not <code>I</code>. The Bayesian detection rate is the probability of <code>I</code> given <code>A</code>.</p>
<p>In addition to the detection algorithms, we can also evaluate IDS's in terms of their system architecture. We want a scalable IDS that can function in high-speed networks. Additionally, we want a resilient IDS that is not easily disabled by attacks that target the IDS.</p>
<h2>Bayesian Detection Rate</h2>
<p>The following formula defines the Bayesian detection rate, given probability <code>A</code> of an alert and prior probability <code>I</code> of an intrusion.</p>
<p><img alt="" src="https://assets.omscs.io/notes/0AB889A0-22E4-46AA-8D55-3E4D565664BB.png" /></p>
<p>We can calculate <code>I</code> by counting the number of packets that flow through our network during a particular time period and taking the percentage of packets that contain evidence of intrusion activities.</p>
<p>There is an interesting phenomenon involving the Bayesian detection rate, called the base-rate fallacy. The <strong>base-rate fallacy</strong> states that even if the false alarm rate <code>P(A|I)</code> is very low, the Bayesian detection rate <code>P(I|A)</code> is still low if the base-rate <code>P(I)</code> is low.</p>
<p>For example, given a detection rate <code>P(A|I) = 1</code>, a false alarm rate <code>P(A|I) = 10^-5</code>, and a base rate of intrusion <code>P(I) = 2 * 10^-5</code>, the Bayesian detection rate <code>P(I|A)</code> is only 66%.</p>
<p>This low base rate may or may not be realistic, depending on where you measure it. For example, tens of millions to hundreds of millions of packets may pass through the entire network, and only a few hundred might contain intrusion activity. Thus, measured from the perspective of the entire network, this base rate can be quite realistic.</p>
<p>One way we can mitigate the base rate fallacy is to reduce the false alarm rate to zero, or as close to zero as possible; indeed, this is one of the main goals of modern IDS vendors.</p>
<p>Alternatively, we can deploy the IDS to the appropriate layer such that, at that layer, the base rate is sufficiently high. Modern-day IDS's use a hierarchical architecture to achieve this high base rate.</p>
<p>We can also use multiple independent models. This approach is similar to medical diagnosis, where multiple tests are used to reduce the overall false positive rate and increase the Bayesian detection rate.  </p>
<h2>Architecture of Network IDS</h2>
<p>With the Bayesian detection rate and the base-rate fallacy in mind, let's discuss the system architecture of a network IDS.</p>
<p>Typically, the volume of packet data in a network is enormous - on the order of tens of millions of packets per day - and only a few might involve any activity related to intrusion. Therefore, according to the base-rate fallacy, if we apply detection algorithms at the packet level, we will see meager Bayesian detection rates.</p>
<p>Instead, we should apply detection models to a set of data that has a higher base rate, which requires that we filter out packet data unlikely to be related to intrusion activity.</p>
<p>First, we can apply filters to the packet data by, for example, instructing <code>libpcap</code>  to only capture packets destined for certain services. Second, an event engine analyzes the filtered packet data and summarizes them into security-related events, such as failed logins. Finally, the system applies detection models to the data contained in each security-related event.</p>
<p><img alt="" src="https://assets.omscs.io/notes/CB6269B9-AA5D-47D0-813D-B34B9C7E0BAB.png" /></p>
<p>The system decreases the volume of packet data at each step. Therefore, as long as we capture the intrusion evidence in the event data, the base rate is going to be much higher because the total number of packets is going to be much lower. As a result, the IDS model applied to the event data will yield a higher Bayesian detection rate.</p>
<h2>IDS Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/EE0009BB-048C-4192-8372-0752194F9C8F.png" /></p>
<h2>IDS Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/67B4C307-4630-470A-9E6E-EDB4C4FDC0D8.png" /></p>
<h2>Eluding Network IDS</h2>
<p>Now let's talk about how an attacker can evade an IDS so that their attack can proceed undetected.</p>
<p>Recall that a network IDS performs passive monitoring; that is, it takes a copy of the network traffic destined for the end host and analyzes it. Therefore, for the IDS to detect the intrusion happening at the end host, it must see the same traffic as the end host.</p>
<p>However, this parity is not always present, and an attacker can exploit this to evade the IDS. The reason that the IDS and the end host see different traffic is because they are using two different operating systems that process traffic in different ways.</p>
<p>In particular, TCP/IP protocol specifications have ambiguities that lead to different implementations in different operating systems. As a result, an IDS running on Unix and an end host running on Windows may not process certain packets in precisely the same fashion.</p>
<p>For example, options such as time-to-live (TTL), or error conditions associated with fragments and checksums are handled in different ways in different operating systems.</p>
<p>By exploiting these differences, the attacker can slip attack traffic past the IDS undetected while still impacting the destination end host.</p>
<h2>Insertion Attack</h2>
<p>An attacker can insert misleading data into the packet stream to cause the IDS to miss an attack. For example, an attacker might include a packet with a bad checksum value into an otherwise malicious stream of packets. The IDS may accept this packet, but the end host might reject it. As a result, the end host receives the attack, and yet the IDS doesn't detect it.</p>
<p>Here is an illustration of this <strong>insertion attack</strong>.</p>
<p><img alt="" src="https://assets.omscs.io/notes/4C4B5117-A854-4C05-BFCF-65CA01BE6169.png" /></p>
<p>The attacker sends the out-of-order packets that both the IDS and the end host reassemble according to sequence numbers. One of the packets <code>X</code> has a bad checksum value. The IDS accepts <code>X</code>, and sees the packet stream <code>ATXTACK</code>, which looks benign. On the other hand, the end host rejects <code>X</code> and, as a result, sees the <code>ATTACK</code>.</p>
<h2>Evasion Attack</h2>
<p>The attacker can also hide part of the attack to evade IDS detection. An IDS may discard a packet fragment that overlaps with a previous fragment, but an end host may accept both fragments. Therefore, an attacker can send an attack embedded in overlapping packet fragments through the IDS to the end host.</p>
<p>Here is an illustration of this <strong>evasion attack</strong>.</p>
<p><img alt="" src="https://assets.omscs.io/notes/759DCECB-7802-4BF0-ABFC-A160B7C81552.png" /></p>
<p>The attacker sends the out-of-order packets that both the IDS and the end host reassemble according to sequence numbers. In this scenario, the two <code>A</code>'s contain overlapping fragments; as a result, the IDS drops the second <code>A</code>, and so it only sees the stream <code>ATTCK</code>. On the other hand, the end host accepts both fragments, even though they overlap. Therefore, the end host sees the <code>ATTACK</code>.</p>
<h2>DOS Attacks on Network IDS</h2>
<p>Attackers can also use denial of service (DOS) attacks to disrupt the network intrusion detection process. Similar to DOSing a network server, an attacker can send a lot of traffic to an IDS to process, which results in the exhaustion of resources such as CPU, memory, and network bandwidth.</p>
<p>As a result, the IDS may not be able to analyze subsequent traffic, and such traffic may contain actual attacks. Knowing this, the attacker can first disable the IDS through a DOS attack and then launch the real attack.</p>
<p>Another attack approach involves abusing the reactive nature of intrusion detection. When the IDS outputs an alert, a security admin must analyze the alert. Therefore, the attacker can overload the system by sending a lot of traffic that triggers alerts; for example, purposely crafting and sending packets that contain signatures of attacks.</p>
<p>The goal with this attack is first to overwhelm the response system and the security admins and then send the real attack traffic. The attack traffic will generate an alert but, because the security admins are busy analyzing alerts of fake attacks, the alert will not be analyzed until it is too late.</p>
<h2>Intrusion Prevention Systems (IPS)</h2>
<p>In addition to intrusion detection systems, there are also <strong>intrusion prevention systems</strong> (IPS) on the market. Instead of merely sending alerts like an IDS, an IPS tries to block an attack when it detects malicious activity.</p>
<p>Similar to an IDS, an IPS can be deployed at the end host, the network perimeter, or some combination of different locations depending on network needs.</p>
<p>An IPS also uses similar detection algorithms as an IDS. For example, it can use anomaly detection algorithms to detect abnormal behavior and then stop such behavior.</p>
<p>The main difference between an IPS and a firewall is that while a firewall typically only uses simple signatures of attacks to block traffic, an IPS can use very sophisticated detection algorithms.</p>
<h2>IDS Attack Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/85CA9C14-3D97-4B61-BCCE-F2C703BCDC0D.png" /></p>
<h2>IDS Attack Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/B0C3AD98-1CF0-4438-9A0E-81511D82D085.png" /></h2>
<p>id: information-security-ipsec-and-tls
title: IPSec and TLS
course: information-security
lecture: ipsec-and-tls</p>
<hr />
<h1>IPSec and TLS</h1>
<h2>Goals of IPSec</h2>
<p>If Alice receives a packet with Bob's source IP address, she cannot be sure that the packet is really from Bob. Since IPv4 does not enforce source IP address authentication, IP spoofing - forging a packet's source IP address - is a commonly used technique in cyber attacks.</p>
<p>For example, bots in a botnet can use source IP spoofing and DNS to mount a denial of service attack at a victim website. The bots query many different DNS servers requesting the full TXT record of a domain, which often contains many bytes of information. By spoofing the source IP address of their traffic to point to a victim website, the bots can direct the aggregate DNS response, which can be massive, to the victim website, overwhelming its servers.</p>
<p>IPSec provides security services at the IP layer, including</p>
<ul>
<li>authentication of source IP addresses</li>
<li>confidentiality and integrity protection of packet data</li>
<li>authenticity of packet data; in particular, preventing packet replay</li>
</ul>
<p>Of course, a network application or protocol can implement its own specific security mechanisms to achieve these goals, but since all network applications must run on top of IP, IPSec ensures secure networking for the many applications that are ignorant about security.</p>
<h2>Spoofing Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1DD688E5-257A-4BD1-A26F-EA39E51D9B39.png" /></p>
<h2>Spoofing Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/D5A3CBE4-FC07-4B05-9A8E-58657B7FB1DB.png" /></p>
<p>If you spoof your IP address, responses to your packets will not reach you. Therefore, IP spoofing is only useful for unidirectional communication.</p>
<h2>IPSec Modes</h2>
<p>IPSec supports two operational modes: transport mode and tunnel mode. In <strong>transport mode</strong>, security protection is provided to traffic end to end, from one host to another. In <strong>tunnel mode</strong>, the protection typically is provided to traffic from the gateway of one network to the gateway of another network. Virtual private networks (VPNs) utilize tunnel mode.</p>
<p><img alt="" src="https://assets.omscs.io/notes/CA683B2D-615D-498E-BC9C-881607CE8DD4.png" /></p>
<h2>Tunnel Mode</h2>
<p>Tunnel mode is the more commonly used operation mode. Suppose we have two end hosts <code>A</code> and <code>B</code> belonging to the same company, but in two different local area networks (LANs) separated by the Internet. If there is an IPSec tunnel between the gateways of the two LANs, then traffic from <code>A</code> to <code>B</code> is automatically protected.</p>
<p><img alt="" src="https://assets.omscs.io/notes/E8EE4DC2-4B60-4D3C-BE51-FB34B5847565.png" /></p>
<p><code>A</code> emits unencrypted packets, and the gateway encrypts them before they leave the LAN. On the receiving side, the gateway to <code>B</code>'s LAN decrypts the packets and forwards them to <code>B</code>.</p>
<p>The gateway of <code>A</code>'s network encapsulates traffic from <code>A</code> to <code>B</code> by adding a new IP header that specifies its IP as the source IP and the IP of <code>B</code>s gateway as the destination IP to make sure the protected packet is delivered to <code>B</code>'s gateway first.</p>
<p><img alt="" src="https://assets.omscs.io/notes/9A599212-0357-4B7A-98AA-29869A72E7CB.png" /></p>
<p>The gateway also includes an IPSec header, which contains information about the protection mechanism used.</p>
<p>The original packet now becomes the data/payload of the new IP packet.</p>
<h2>IPSec Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/71C27E26-B59A-479C-B58D-E5DE2CB8C25C.png" /></p>
<h2>IPSec Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/ED223658-281B-41DC-B9FB-C1A4C7947B46.png" /></p>
<h2>IPSec Architecture</h2>
<p>IPSec offers several protocols to perform various functions. These include a key exchange protocol - like the <strong>Internet Key Exchange</strong> (IKE) - used for negotiating protection parameters such as cryptographic algorithms and keys, as well as two types of protection protocols: <strong>Encapsulating Security Payloads</strong> (ESP) and <strong>Authentication Headers</strong> (AH).</p>
<p><img alt="" src="https://assets.omscs.io/notes/F2FFA3D5-C965-41B7-8237-CD8771328F1D.png" /></p>
<h2>Encapsulated Security Payload (ESP)</h2>
<p>ESP provides confidentiality protection through IP packet payload encryption. Additionally, ESP provides message authentication to the encrypted payload and IPSec header.</p>
<h2>ESP Modes Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3008B283-1683-4743-A65C-803E545D9BE3.png" /></p>
<h2>ESP Modes Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FE6C0D73-4AD5-4227-ABC2-90E2C64533BD.png" /></p>
<h2>ESP in Transport Mode</h2>
<p>Here is the new packet layout when IPSec operates in transport mode and uses ESP.</p>
<p><img alt="" src="https://assets.omscs.io/notes/5B03D84E-96A4-4BC1-A2A0-81E1FA994785.png" /></p>
<p>An ESP header is inserted after the original IP header and includes the security parameter index and sequence number, which we will discuss shortly. The ESP header also includes the initialization vector (IV) used for encryption.</p>
<p>The ESP trailer contains padding information and a next header field, which contains information about the type of data contained in the payload, such as TCP or UDP data.</p>
<p>The packet payload and the ESP trailer are both encrypted, but the ESP header is not because it provides information about how to decrypt the payload, specifically in the security parameter index header. For example, this header can contain information about which algorithm and shared key to use for decryption.</p>
<p>The ESP header and encrypted payload are hashed together with a secret key, and the hash value is appended to the packet. This hash value serves as a message authentication code (MAC) that the receiver can use to verify the authenticity and integrity of the message.</p>
<h2>ESP Tunnel Mode</h2>
<p>Here is the packet layout when IPSec operates in tunnel mode with ESP.</p>
<p><img alt="" src="https://assets.omscs.io/notes/86B40971-737C-4DE3-A765-9BBA482B5AB6.png" /></p>
<p>An ESP header is added after the new IP header, and the packet payload - which contains the entire original packet plus the ESP trailer - is now encrypted. Similarly, the MAC is computed over the entire original packet, plus the ESP header and trailer. Therefore, even the original IP header fields, including the original source and destination IP address, are encrypted and authenticated.</p>
<h2>Authentication Header</h2>
<p>ESP does not authenticate the headers of the transmitted IP packet. If we want to authenticate the entire packet, we can use an authentication header (AH), which contains a MAC for the complete packet.</p>
<p>There are several fields in the IP header - such as the time to live (TTL) field - which may change in transmission. The values of these fields cannot be authenticated, and are often zeroed out when computing the MAC.</p>
<p>While AH does not provide encryption, we can use ESP first to encrypt the payload and then apply AH to authenticate the entire packet.</p>
<p>If AH is used in transport mode, the AH header is inserted after the original IP header.</p>
<p><img alt="" src="https://assets.omscs.io/notes/E2BC20AE-1147-4A1B-A2A7-6B10FCE93493.png" /></p>
<p>If AH is used in tunnel mode, the AH header is inserted after the new IP header.</p>
<p><img alt="" src="https://assets.omscs.io/notes/D87CFA42-65A4-4D3D-B99A-213C18B4905C.png" /></p>
<h2>ESP and AH Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FD580F5D-A007-460F-B7C0-878B746040A9.png" /></p>
<h2>ESP and AH Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/5F059246-E05A-48FE-89DA-01D8F01B2249.png" /></p>
<h2>Internet Key Exchange</h2>
<p>If two parties wish to communicate securely, they typically need to use a security protocol that performs mutual authentication and key exchange.</p>
<p>For two end hosts or gateways to use IPSec for secure communications over the Internet, that protocol is the Internet Key Exchange Protocol (IKE).</p>
<p>IKE allows the two parties to decide the security policies for the traffic between them. Additionally, it allows the parties to agree on a set of security parameters, such as which cryptographic algorithms to use for encryption and hashing. Finally, it allows two parties to establish a shared key for confidential communication.</p>
<h2>Security Association</h2>
<p>The security parameters for a particular type of traffic - for example, all TCP connections from host <code>A</code> to host <code>B</code> - are described in a <strong>security association</strong> (SA).</p>
<p>Security associations are asymmetric. For the TCP example above, we need one SA to describe traffic flow from <code>A</code> to <code>B</code> and another to describe traffic flow from <code>B</code> to <code>A</code>.</p>
<p>An end host may need many SAs and uses an SA database (SADB) to store them. Each SA has a unique index in the SADB known as the <strong>security parameter index</strong> (SPI).</p>
<p>When <code>A</code> and <code>B</code> agree on the security parameters for their communications, each side creates an identical SA entry in their local SADB. Then, <code>B</code> communicates the SPI for its copy to <code>A</code>, which saves it as the SPI for its copy.</p>
<p>Whenever <code>A</code> and <code>B</code> communicate, they include the SPI on any outgoing packet so the receiver can find the corresponding SA and process it according to the agreed-upon security parameters.</p>
<p>The security parameters define the security mechanisms and are determined by the security policies, which are stored in a security policies database (SPDB).</p>
<h2>SPD and SADB Fit Together</h2>
<p>An SPD entry describes a security policy that decides the security parameters, which are stored in an SA in the SADB. The unique index for the SA of the receiver is the SPI that the sender includes in the IPSec packet header.</p>
<p><img alt="" src="https://assets.omscs.io/notes/73C87C5F-F83F-4A4F-A18A-8F3A96C11ED1.png" /></p>
<h2>SPD and SADB Example</h2>
<p>Recall that transport mode provides end to end traffic protection, while tunnel mode provides traffic protection only between the gateway of the outbound network and the gateway of the inbound network.</p>
<h3>Transport Mode</h3>
<p>Suppose a policy dictates that all traffic from <code>A</code> to <code>B</code> must be authenticated using HMAC with MD5 as the embedded hash function.</p>
<p><code>A</code>'s SPD stores this policy, and both <code>A</code> and <code>B</code> store an SA in their SADB containing the negotiated paramters for the policy. For example, <code>A</code>'s SA stores the secret key for HMAC and the SPI to index the SA in <code>B</code>'s SADB.</p>
<p><img alt="" src="https://assets.omscs.io/notes/AB73C33F-AAF8-47F3-BF2D-5D20241F8C30.png" /></p>
<p>When <code>A</code> sends traffic to <code>B</code>, it includes the SPI in the IPSec header so that <code>B</code> can use it to look up its SA and then process the traffic appropriately.</p>
<h3>Tunnel Mode</h3>
<p>Suppose a policy states that any traffic from <code>A</code>'s subnet to <code>B</code>'s subnet must be sent to <code>B</code>'s gateway <code>D</code>, and must be processed using ESP with 3DES.</p>
<p>Since <code>C</code> is the gateway of the <code>A</code>'s subnet, <code>C</code>'s SPD stores this policy, and its SADB stores the SA that has the 3DES key and the SPI for looking up the SA in <code>D</code>'s SADB.</p>
<p><img alt="" src="https://assets.omscs.io/notes/44BDBF46-EF1B-4E64-8062-CC61D76FBDCD.png" /></p>
<h2>Outbound Processing</h2>
<p>Before <code>A</code> sends a packet, it first examines the security policies in the SPD to see if the traffic needs IPSec protection. If an applicable SPD entry exists, then <code>A</code> retrieves the corresponding SA from the SADB and processes the packet accordingly.</p>
<p><img alt="" src="https://assets.omscs.io/notes/D9D88BD4-2C98-430E-8210-F130CB7C0E64.png" /></p>
<h2>Inbound Processing</h2>
<p>When <code>B</code> receives the packet, it uses the SPI in the IPSec header to look up the SA in the SADB and processes the packet accordingly. Next, <code>B</code> looks up the SPD to ensure that  <code>A</code> secured the packet correctly according to the policy. If so, <code>B</code> delivers the packet to the upper layer application.</p>
<p><img alt="" src="https://assets.omscs.io/notes/D1DCF0E4-3F0B-49E6-9B10-052EF546B0E1.png" /></p>
<h2>Anti Replay</h2>
<p>The IPSec header contains a <strong>sequence number</strong> field, which is designed to prevent replay attacks. This field is only used if AH is requested, or if the authentication option in ESP is selected.</p>
<p>To utilize sequence numbers, a host <code>H</code> must maintain a sliding window of size <code>n</code> - which should be at least 32. Although packets may arrive out of order, their sequence numbers should be within the window of size <code>n</code>.</p>
<p>Suppose <code>H</code> maintains a window where <code>n = 50</code>, which contains the sequence numbers from 100 to 149.</p>
<p>If a packet arrives with a sequence number less than 100, <code>H</code> rejects the packet. If a packet arrives with a sequence number greater than 149, <code>H</code> accepts the packet and adjusts the window to cover this packet's sequence number. For example, if <code>H</code> receives a packet with sequence number 199, <code>H</code> adjusts its window to cover 150 through 199.</p>
<p>Suppose <code>H</code> maintains a window where <code>n = 50</code>, which contains the sequence numbers from 100 to 149.</p>
<p>If a packet arrives with a sequence number between 100 and 149, <code>H</code> checks the number to see if it has already been seen. If yes, <code>H</code> rejects the packet; otherwise, <code>H</code> accepts the packet and records the sequence number as having been seen.</p>
<h2>IPSec Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/E4D8DF00-E68F-47D6-AEBD-1B28A0557F04.png" /></p>
<h2>IPSec Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2A1B6B61-7F65-43B9-84D8-6B281D0FD29C.png" /></p>
<h2>Internet Key Exchange</h2>
<p>Before <code>A</code> and <code>B</code> can communicate securely, they must agree upon the security parameters for their communication, such as the encryption and authentication algorithms and keys that they plan to use. In other words, they need to establish an SA before any protected communication can begin.</p>
<p>The Internet Key Exchange (IKE) protocol facilitates the establishment of one or more IPSec SAs between hosts. This protocol works in two phases. First, the hosts establish an IKE SA to protect the SA negotiation itself. The IKE SA is bi-directional; that is, it protects the SA negotiation traffic from both sides. Next, the hosts use this SA to protect the negotiations of multiple IPSec SAs.</p>
<h2>IKE Phase I</h2>
<p>The first phase of the IKE protocol serves to establish a general security association that can be used to establish multiple IPSec security associations in the second phase.</p>
<p>First, both sides negotiate the protection mechanism to use - AH or ESP - and also agree upon which cryptographic algorithms to use, such as AES or HMAC with SHA-1.</p>
<p>Then, they establish a shared secret key using a protocol such as Diffie-Hellman. Both sides can use either a pre-shared key, digital signatures, or public-key encryption to authenticate the key exchange.</p>
<h2>IKE Phase I Example</h2>
<p>Let's look at an example of phase one of the IKE protocol. For this example, we assume that both sides have a pre-shared secret key.</p>
<p><img alt="" src="https://assets.omscs.io/notes/896968E8-497D-453A-9342-A249EA63A196.png" /></p>
<p>First, the initiator sends the cryptographic algorithm it proposes, along with a cookie, to the responder. The cookie is a value that the initiator can easily compute, and the responder can easily verify, such as a hash over the initiator's IP address and the current timestamp together.</p>
<p>The cookie proves that the initiator has done some computation and is serious about following through with the protocol. In general, cookies help to mitigate denial of service attacks where an initiator can send many requests to a responder at little to no cost.</p>
<p>After verifying the cookie, the responder sends back its choice of cryptographic algorithm and its own cookie to the initiator.</p>
<p>Second, the two parties exchange <code>Yi</code> and <code>Yr</code> - the public components of the Diffie-Hellman key exchange - combined with nonce values <code>Ni</code> and <code>Nr</code>  to prevent replay attacks.</p>
<p>Third, both the initiator and the responder compute the same shared key according to the Diffie-Hellman key exchange as well as other keys necessary for the IKE SA.</p>
<p>Finally, they exchange hash values to authenticate the newly established key using their pre-shared secret key.</p>
<h2>Diffie Hellman Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0914FC25-D4BF-4506-A396-5CE9A634DE1D.png" /></p>
<h2>Diffie Hellman Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/70D29C1C-2681-4AD3-9215-1608F8762907.png" /></p>
<h2>Diffie-Hellman and Pre-shared Secret</h2>
<p>In our example, the initiator and the responder have a pre-shared secret key, and, using this key as well as the information exchanged between them, they can both compute shared keys using a pseudorandom function.</p>
<p>Each party can build a <strong>pseudorandom function</strong> using HMAC and SHA-1 to generate a pseudorandom bitstream. SHA-1 has a property whereby the change in a single bit of input produces a new hash value with no apparent connection to the preceding hash value. This property forms the basis for <em>pseudorandom number generation</em>.</p>
<p>The pseudorandom function <code>PRF</code> receives two pieces of data as input - a key and a data block - both of which are passed down to HMAC.</p>
<p>First, the initiator and the responder compute a root shared secret, <code>SKEYID</code>. Each party computes this value by invoking <code>PRF</code>, using the pre-shared key as the key and the previously exchanged nonce values <code>Ni</code> and <code>Nr</code> as the data block.</p>
<p>Next, they compute a shared key to use for IPSec SA, <code>SKEYID_d</code>. Each party computes this value by invoking <code>PRF</code>, using <code>SKEYID</code> as the key, and the following four values as the data block: <code>K</code>, the shared secret key computed using Diffie-Hellman; <code>Ci</code> and  <code>Cr</code>, the cookies previously exchanged between the initiator and the responder, and; the number 0.</p>
<p>Both parties compute the keys for IKE message authentication and encryption in a similar fashion.</p>
<p><img alt="" src="https://assets.omscs.io/notes/D3DCDF23-F2F5-451C-A06A-E13EF32A6829.png" /></p>
<h2>Authentication of the Key Exchange</h2>
<p>Now let's take a look at how the initiator and responder authenticate the key exchange. Both parties hash the information they have exchanged, using <code>PRF</code> with <code>SKEYID</code> as the key.</p>
<p>The input data block passed to <code>PRF</code> contains the public components of the Diffie-Hellman exchange, the cookies, the offered cryptographic algorithms, and the identities of the initiator and responder.</p>
<p><img alt="" src="https://assets.omscs.io/notes/DD6005C8-D00D-4542-B8D0-74BFC4E419F9.png" /></p>
<p>Each party can verify the hash value computed by the other because these values are based on information shared by both parties. By verifying these values, each party can authenticate the exchange.</p>
<h2>IKE Phase II Keys</h2>
<p>The second phase of IKE deals with establishing IPSec SAs. Multiple SAs can be negotiated using the protection of the same IKE SA established in the first phase of IKE. The two phases work similarly, differing primarily in how the IPSec keys are derived.</p>
<p>If the hosts do not require <a href="https://en.wikipedia.org/wiki/Forward_secrecy">perfect forward secrecy</a> (PFS), then they can derive all SA keys using one of the shared keys, <code>SKEYID_d</code>, computed in IKE phase one. The weakness of this approach is that if <code>SKEYID_d</code> is somehow leaked, then all of the IPSec SA keys are compromised.</p>
<p>Stronger security requires PFS. With PFS, both sides exchange new nonce values and perform new key exchanges before each IPSec SA negotiation. Therefore, unless the pre-shared master secret key is compromised, the keys for the current IPSec SA are secure, even if other keys previously computed have been compromised.</p>
<h2>IPSec Summary</h2>
<p>To summarize, if host <code>A</code> and host <code>B</code> want to communicate, the typical IPSec workflow is as follows.</p>
<p><img alt="" src="https://assets.omscs.io/notes/3142EBB7-04DF-45C7-BD06-0F98E0BFED77.png" /></p>
<p>Suppose this is the first time that <code>A</code> sends data to <code>B</code> that, according to policy, requires protection. The gateway of <code>A</code>'s network and the gateway of <code>B</code>'s network first use the IKE protocol to negotiate the IKE SA and then use that IKE SA to negotiate the IPSec SAs.</p>
<p>Then, the routers can use the SAs to create an IPSec tunnel between them, which protects the traffic from <code>A</code> to <code>B</code>. For example, the packet data can be encrypted and, optionally, the header information and packet data can be authenticated, depending on the SAs used.</p>
<p>When A terminates the connection to B, the IPSec tunnel between the two routers also terminates.</p>
<h2>IKE Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/62A969AA-6E08-43A4-88D5-465C92149EE4.png" /></p>
<h2>IKE Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/8F57DD12-F29F-4F16-9039-41BC4E1A0509.png" /></p>
<h2>SSL and TLS</h2>
<p>One of the most widely used security services is <strong>Secure Sockets Layer</strong> (SSL) and the follow-on standard, <strong>Transport Layer Security</strong> (TLS). TLS is designed to make use of TCP to provide a reliable end-to-end secure service.</p>
<p>TLS can be provided as part of the underlying transport protocol suite, which allows all applications above the transport layer to benefit from the provided security services.</p>
<p>Alternatively, TLS can be embedded in specific application packages. For example, most web browsers come equipped with SSL, and most web servers have implemented the protocol.</p>
<p>TLS is not a single protocol, but rather two layers of protocols, illustrated by the following figure.</p>
<p><img alt="" src="https://assets.omscs.io/notes/65B1167C-7106-4FC3-832C-4B409CEA39BC.png" /></p>
<p>The <em>record protocol</em> provides basic security services to various higher-layer protocols, such as HTTP or SMTP.</p>
<p>Additionally, TLS defines three application-level protocols - the <em>handshake protocol</em>, the <em>change cipher spec protocol</em>, and the <em>alert protocol</em> - which are used in the management of TLS exchanges.</p>
<h2>TLS Concepts</h2>
<p>A <strong>TLS session</strong> is an association between a client and a server created by the handshake protocol. A session defines the set of cryptographic parameters to be used by each connection within the session. By defining the parameters at the session level, we avoid having to perform the expensive security negotiation process for each new connection.</p>
<p>A <strong>TLS connection</strong> is a transport layer relationship between a client and a server. Whereas a TLS session defines a long-term relationship, a TLS connection is transient; for example, if the client closes the connection, the connection terminates, even though the session may remain intact.</p>
<h2>SSL Record Protocol</h2>
<p>The SSL record protocol provides two services for SSL connections - confidentiality and message integrity - both of which are made possible by the handshake protocol. That is, the handshake protocol establishes secret keys for use in encryption and message authentication code (MAC) generation, and the record protocol uses these keys to provide those services.</p>
<p>This figure shows the overall transformation of application data using the SSL record protocol.</p>
<p><img alt="" src="https://assets.omscs.io/notes/F81A463F-AA04-40D7-8642-A65207C72CCF.png" /></p>
<p>First, the host <code>H</code> fragments the application data into blocks that can fit in a TCP segment. Next, <code>H</code> compresses each block and computes a MAC over the compressed data. Third, <code>H</code> encrypts the compressed message and MAC using symmetric encryption. Finally, <code>H</code> prepends a header to the encrypted, authenticated message that includes fields specifying message length and protocol version.</p>
<p><code>H</code> transmits the data in a TCP segment. The receiving end applies the transformation steps in reverse - decryption, verification, decompression, and reassembly - before delivering the data to the application.</p>
<h2>The Handshake Protocol</h2>
<p>The handshake protocol allows a client and server to negotiate security parameters, ultimately resulting in the creation of a TLS session between them.</p>
<h3>Phase One</h3>
<p>In phase one, the client and server share their respective security capabilities. The client initiates this phase by sending a <code>client_hello</code> message to the server, which contains several parameters: TLS version number, session ID, crypto suite, compression method, and initial random numbers.</p>
<p><img alt="" src="https://assets.omscs.io/notes/3857F12D-FEAD-41FD-8E6F-07EB9811BEE5.png" /></p>
<p>After sending the <code>client_hello</code> message, the client waits for the <code>server_hello</code> message, which contains the same parameters. Therefore, at the end of phase one, both client and server know each other's security capabilities.</p>
<p><img alt="" src="https://assets.omscs.io/notes/DACA89D1-C0E1-41BD-87A5-A942AE1EE5A6.png" /></p>
<h3>Phase Two</h3>
<p>The details of phase two depend on the underlying public-key encryption scheme in use. In some cases, the server passes a certificate to the client, possibly with some additional key information, and may request a certificate from the client. Regardless, the final message must be <code>server_hello_done</code>, which indicates the end of this phase.</p>
<p><img alt="" src="https://assets.omscs.io/notes/CDAC2AB9-1772-4F62-9A46-6335941C7410.png" /></p>
<h3>Phase Three</h3>
<p>In phase three, the client should first verify the server's certificate. For example, the client should be able to validate that a reputable certificate authority signed the certificate.</p>
<p>After verification, the client can send key exchange information to the server. For example, the client can generate a secret key, encrypt it using the server's public key, and send it to the server.</p>
<p>Depending on the application requirements, the client may send a certificate to the server to authenticate itself. If a website is public-facing, then the authentication is typically one-way; that is, the client needs to authenticate the server, but the server need not authenticate the client. On the other hand, internal or private web servers may require mutual authentication.</p>
<p><img alt="" src="https://assets.omscs.io/notes/75D3F3E4-858C-412D-BDD4-C0BD5AB73DCA.png" /></p>
<h3>Phase Four</h3>
<p>In phase four, the client sends a <code>change_cipher_spec</code> message to the server and copies the pending security parameters to the current cipher spec. It then signals the completion of the handshake protocol.</p>
<p>In response, the server sends its own <code>change_cipher_spec</code> back to the client to signal that it also agrees on the exchanged security parameters. Then the server sends its own message to signal the end of the handshake.</p>
<p><img alt="" src="https://assets.omscs.io/notes/B6BFE767-B3C0-4C1B-A015-128C6BE88D1A.png" /></p>
<p>At this point, the handshake is complete, and the client and server can begin to exchange application layer data, which will be protected using the negotiated security parameters.</p>
<h2>TLS and SSL Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/BE0FFF58-FFF7-4072-8B4C-77297F71EFFD.png" /></p>
<h2>TLS and SSL Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/34823FD7-F6DD-46F3-A29D-2FEE62D8D7FA.png" /></p>
<h2>While transport layer protocols do rely on the IP layer, TLS does not specifically rely on IPSec.</h2>
<p>id: information-security-law-ethics-and-privacy
title: Law, Ethics, and Privacy
course: information-security
lecture: law-ethics-and-privacy</p>
<hr />
<h1>Law, Ethics, and Privacy</h1>
<h2>US Laws Related to Online Abuse</h2>
<p>People can do many different things online. Some of these activities can be very productive while others can be quite harmful. We can examine the various laws in place that offer protection against different types of online abuse.</p>
<p>For example, consider cybercrime. We know that things like theft and extortion are illegal in the physical world. We've discussed similar activities that take place in the digital realm, such as data theft, identity theft, and ransomware. Thankfully, there are laws that offer us protection against cybercrime just as there are laws that protect us from "real" crime.</p>
<p>Additionally, consider creators of digital objects, such as software or digital music. In the non-digital world, we have ways to protect intellectual property with copyrights, patents, and trade secrets. There is a set of laws that control the copying and distribution of digital objects.</p>
<p>It's important to think about how these laws should be applicable in the context of digital objects. For example, a digital object may be copied and transmitted much more easily than a physical object.</p>
<p>A third area we can think about is our privacy as Internet users. We spend a lot of time online, visiting different websites, using different services, and searching for different things. It's very easy for entities that we interact with digitally to collect a lot information about us. A lot of people worry about the concept of Big Brother watching everything they do, and would like some protection.</p>
<h2>Legal Deterrents Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2762F482-BE0A-4124-B408-52E8CF242DA8.png" /></p>
<h2>Legal Deterrents Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/C646AE0D-9888-4239-97C1-3A1146256E8E.png" /></p>
<h2>Cost of Cybercrime Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/057806B3-A791-476B-86A5-038EE90E5789.png" /></p>
<h2>Cost of Cybercrime Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6D22EA68-A8BE-4C7B-A409-DE34882F3328.png" /></p>
<h2>US Computer Fraud and Abuse Act (CFAA)</h2>
<p>The first U.S. law related to cybercrime and illegal online activities is the <strong>U.S Computer Fraud and Abuse Act</strong> (CFAA). The goal of this act was to define what types of online actions constitute criminal activity and then outline sanctions against those actions.</p>
<p>The CFAA primarily focuses on unauthorized access to computers and the data contained therein. Attackers who break into systems can alter the confidentiality, integrity, or availability of the data on these systems. Additionally, they can tamper with the integrity and availability of the service itself, rendering it unable to carry out its functions on behalf of its user. Since computer systems and computer data are valuable, we would like to protect them from these kinds of activities.</p>
<p>Initially, the CFAA only covered access to computers containing information related to national security and defense. Later, the CFAA extended its scope to include computer systems containing financial information, as many people care about the safety and security of their money. More recently still, the CFAA broadened its scope even further to cover any <strong>protected computer</strong>: any computer connected to the Internet.</p>
<p>Additionally, the CFAA makes it illegal to distribute malware or other software that allows a user to gain unauthorized access to a computer system.</p>
<p>Finally, the CFAA addresses passwords specifically. Trafficking in computer passwords - selling stolen passwords on the black market - is illegal as well.</p>
<h2>Digital Millennium Copyright Act Part 1</h2>
<p>The <strong>Digital Millennium Copyright Act</strong> (DMCA) concerns intellectual property and digital content. The problem it helps to address is <strong>piracy</strong> - the illegal copying and theft of digital objects.</p>
<p>DMCA says that content creators can copyright their digital objects. As a result, these objects can now receive the same protections as copyrighted objects in the non-digital world.</p>
<p>Additionally, DMCA makes it a crime to circumvent or disable any measures concerning copyright protection and anti-piracy. Not only that, but DMCA also makes it a crime to manufacture and distribute any software or device that can disable anti-piracy protections.</p>
<h2>Digital Millennium Copyright Act Part 2</h2>
<p>The DMCA does have space for some exceptions, primarily for research and educational purposes. For example, if you are researching the strength and security of an anti-piracy measure, you may need to tamper with that measure deliberately. Additionally, libraries can generally make some limited number of copies of digital objects without being considered in violation of the law.</p>
<p>One of the criticisms that these laws face is that they are too vague and broad, which means that different groups can have different interpretations. On one side, parties like the Recording Industry Association of America have filed suits against entities they believe violated the law, while organizations like the Electronic Frontier Foundation worry about the broad scope of the laws and the potential for abuse brought on by the laws themselves.</p>
<h2>Computer Abuse Laws Enforcement</h2>
<p>While the mere presence of laws like CFAA and DMCA is helpful, to a degree, to deter attackers from committing digital crimes, the enforcement of these laws remains challenging for several reasons.</p>
<p>First, connecting malicious computer activity with an attacker can be difficult. For example, an attack may originate from a user's laptop without that user's knowledge at all. Clearly, the user is not to blame; instead, an attacker likely infected their machine with malware or bot code. Because of maneuvers like this, the process of pinning an attack to its exact source can be quite challenging.</p>
<p>To make matters worse, the Internet has no national boundaries. Attackers that digitally cross borders - hacking into a computer in the United States using a computer in Russia, for example - can only be brought to justice through transnational coordination. Many countries are unable or simply unwilling to cooperate with other countries in this context.</p>
<p>Additionally, lawmaking is a slow process, and the stakes are high for focused attackers. As a result, cybercriminals evolve quickly and continue to work around the laws that we put in place. Technology and creativity proceed more quickly than legislation.</p>
<h2>Melissa Virus Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1E28C362-6E6A-4677-A362-568C16915225.png" /></p>
<h2>Melissa Virus Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/12204048-15EC-4A75-89EE-83966EC45C6D.png" /></p>
<h2>Unauthorized Access Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0E4D483F-7A30-44CE-BF76-1BFC3C06BB0B.png" /></p>
<h2>Unauthorized Access Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/56C7B39C-4F63-4C1A-A02A-863642EC8401.png" /></p>
<h2>DMCA Exclusions Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/C3F16DFB-FD7A-4E37-8D5C-B49D85D292A9.png" /></p>
<h2>DMCA Exclusions Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/BACA7BA9-90D0-4402-81DF-724AB70FEB5A.png" /></p>
<h2>Ethical Issues</h2>
<p>Laws are manifestations of what we, as a society, determine to be right and wrong. Laws are not subjective on an individual level, and external entities, such as police officers and judges, enforce and arbitrate laws on behalf of society at large.</p>
<p>Ethics are much more personal and help guide our actions based on an internal sense of right and wrong. Something that feels ethical to you might not feel ethical to me. Organizations that we join - <a href="https://en.wikipedia.org/wiki/Association_for_Computing_Machinery">ACM</a>, <a href="https://en.wikipedia.org/wiki/Institute_of_Electrical_and_Electronics_Engineers">IEEE</a>, or Georgia Tech, for example - may have additional ethical standards or codes of conduct by which they ask us to abide. We stick to our ethics not for fear of going to jail, but rather because they outline what we perceive to be right and appropriate in the world.</p>
<p>Consider finding a vulnerability in a widely-used software product. What is the ethical disclosure of this vulnerability? On the one hand, public disclosure alerts attackers to the vulnerability. On the other hand, deciding not to disclose the vulnerability removes any motivation for a vendor to fix it. That being said, attackers may have discovered the vulnerability already, so a public disclosure may inform users that they should stop using the software, at least until a patch is out.</p>
<p>Situations like this are present throughout the digital world, and handling them with finesse requires thoughtfulness and a desire to do the right thing.</p>
<h2>Computer Ethics Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2D3BCFF6-7747-4664-B3BD-037CB1DAA9D2.png" /></p>
<h2>Computer Ethics Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/7C9A2833-34E5-4F26-8E01-E81F4ECC0B0F.png" /></p>
<h2>Responsible Disclosure Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/DD897D09-0FCE-487F-9E2A-AE7B1BED3CD0.png" /></p>
<h2>Responsible Disclosure Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/63AB025B-A11C-43E2-80B2-74825F271520.png" /></p>
<h2>Privacy Definition</h2>
<p>Justice Louis Brandeis made his famous statement about the "<a href="https://en.wikipedia.org/wiki/Louis_Brandeis#Olmstead_v._United_States_(1928)_%E2%80%93_Right_of_privacy">right to be let alone</a>" almost 100 years ago; clearly, concerns about privacy are not new. That being said, privacy in the digital era looks different than privacy in the early twentieth century. When we talk about privacy online, we are primarily referring to a user's ability to control how data about him or her is collected, used, and shared by someone else.</p>
<h2>Privacy is Not a New Problem</h2>
<p>People have always worried about what others - friends, family, adversaries, the government - know about them, whether it be their whereabouts, activities, or preferences. In the modern, digital context, websites and other software capture, use and distribute our information at an unprecedented scale.</p>
<h2>What is Private</h2>
<p><img alt="" src="https://assets.omscs.io/notes/40BAD00E-8C37-48A7-8D03-A07A050E8404.png" /></p>
<h2>What is Not Private</h2>
<p><img alt="" src="https://assets.omscs.io/notes/926229E1-84F7-45BB-BBC2-C715979D0B6D.png" /></p>
<h2>Institutional Privacy</h2>
<p>Privacy refers to the ability of an individual to control the data about them that is collected and shared. Of course, privacy doesn't have to only apply to individuals. Indeed, there may be reasons that universities, hospitals, charities, and even political action committees may want to keep information private.</p>
<h2>Privacy Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6222EA4E-3B0D-472F-991C-FBEEFACF61A5.png" /></p>
<h2>Privacy Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1F9A054B-54D7-423A-979A-609AFF05841F.png" /></p>
<p>Read more <a href="https://www.pewresearch.org/internet/2015/05/20/americans-attitudes-about-privacy-security-and-surveillance/">here</a>.</p>
<h2>Right to Be Forgotten Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/CCE71B10-21D1-492A-A2E5-7EDF4CAD7CC4.png" /></p>
<h2>Right to Be Forgotten Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B5ADC3E6-8457-4465-93F3-56D856A5E848.png" /></p>
<h2>Threats to Privacy Part 1</h2>
<p>While we have some idea of what types of information we believe should be private in an online context, we should realize that our desires for privacy are not always respected.</p>
<p>For example, when we talk about network requests from, say, a browser to a server, we have to understand that our communication must pass through the greater Internet. While people generally believe that information regarding which websites they visit should be private, traffic sniffing and analysis are threats to that belief. An attacker who observes the packets sent between you and a website can violate the confidentiality of this information.</p>
<p>Additionally, large scale surveillance is a threat to privacy. Some law enforcement officials claim that allowing encryption without providing a backdoor allows criminals to communicate in complete secret, while others argue that we are currently in the golden age of surveillance. Every piece of information about us is tracked and collected.</p>
<p>Finally, it may be possible for others to infer information about us, even if they don't possess it directly. For example, when we talked about database inference attacks, we discussed how different data setups, combined with public information an attacker already has, make it easy to de-anonymize data about specific individuals. In the world of big data and data mining analytics today, these inferences are becoming more common.</p>
<h2>Threats to Privacy Part 2</h2>
<p>Social media poses a threat to privacy, as well. While we use these social sites as a tool for communicating with our friends and sharing with the people around us, we also share all of the information we create with companies like Facebook and Twitter.</p>
<p>Additionally, web tracking serves to reveal information about our browsing habits. Obviously, when we visit a web site, the owner of that site knows that we visited, but the owner can also choose to pass that information along to third parties for analysis. For example, an e-commerce site may let Google know that you visited so that Google can serve you an advertisement for the site later on.</p>
<p>Finally, we enable this behavior. We frequently pass over our information to vendors - whether our name, phone number, or email address - for small discounts in the form of digital coupons and loyalty program memberships. We violate our own privacy, in a sense, by feeding information into a system that we know is designed to exploit us.</p>
<h2>Privacy Threats to Online Tracking Info</h2>
<p>One threat to privacy in the context of online tracking concerns information collection. Many of us are aware that certain websites and services collect information about us because most platforms require us to agree to such collection. If companies did not tell us they were collecting information about us but did it regardless, we might consider them to be invading our privacy.</p>
<p>Once a company has our information, we might be concerned with how they use it. Information is powerful, and a company that does not disclose how they use the information they collect might wield it in a way that invades our privacy.</p>
<p>Additionally, we might be curious as to how long a company might keep such information. People change, and information that was valid at one time in the past may not be valid in the present.</p>
<p>Perhaps a company has all the best intentions with our data. We might not be worried about them specifically, but we might want to examine their business partners and other entities with whom they share data. These partners may not use best practices for keeping our data safe from attackers, and the entities that they partner with might be even less professional.</p>
<p>A company may specify all of these factors - what data they collect, what they do with the data, how long they keep the data, and with whom they share the data - in a document known as a <strong>privacy policy</strong>.</p>
<p>Indeed, the privacy policy itself can serve as a threat to privacy. Imagine reading and agreeing to a policy that later is changed to be much more lax concerning data collection, use, and distribution. A privacy policy that can change at any time, to any degree, without subsequent consent, is as bad as no privacy policy at all.</p>
<p>Finally, we also have to consider the security implications of collecting and storing all of this information. Since attackers have no regard for privacy and consent, we can assume that they will treat our data in the worst way possible. Companies need to address how they safeguard our data even in the face of theft.</p>
<h2>Example: Google Privacy Policy</h2>
<p>While most websites have privacy policies, few of us honestly look at them carefully, if at all. Let's look at some components of Google's privacy policy.</p>
<p>Some information that Google collects about us is the information that we give it. For example, when we create a new account in Gmail, we likely provide our name, alternative email address, and phone number.</p>
<p>Other information is collected less visibly. When we visit certain websites or use Google services, it can record the actions we perform and the content we consume.</p>
<p>Google uses cookies - a general website-based tracking mechanism - to keep various pieces of state on our browsers as we move about the internet. As a result, Google can collect information about us even when we are not connected to a particular Google service at the moment.</p>
<p>Additionally, Google captures information about the device we use to communicate with their services. For example, when our browser connects to Gmail, it passes along information such as our operating system, our IP address, and network information.</p>
<p>Google's original killer feature was search, and so Google naturally collects and retains your search queries to understand what kind of information you are interested in consuming.</p>
<p>If you use Google Voice, Google has information about who you call and how long you talk. Additionally, some Google services may collect location information.</p>
<h2>Google: How is Info Used</h2>
<p>We saw how Google collects information about us, and what type of information it collects, so now we have to ask how Google uses that information. Google has two primary uses for the data it collects about us.</p>
<p>First, it uses the data to personalize our experience with its services. Two random people are likely interested in quite different types of information, and the more information that Google has about them, the more it can tailor an experience to them.</p>
<p>For example, a doctor searching for "lens" might be referring to the part of the eye, while a photographer might be looking for the part of the camera. Without collecting (or inferring) the occupation of both searchers, Google might serve the same search result to two contextually different queries.</p>
<p>Second, Google uses the data to serve better-targeted advertisements. Google makes its money selling ads and, the more it knows about you, the better it can understand which products and services you are likely to buy. This knowledge allows it to charge a higher premium for ad delivery using its network.</p>
<h2>Google: Who is it Shared With</h2>
<p>Now that we understand how Google collects and uses our information, we can begin to look at how and with whom Google shares our information.</p>
<p>Google allows us to opt-in to sharing our information with other businesses and services. For example, if we use a "Log in with Google" button on a third party website, Google makes us confirm that we indeed consent to give this third party our information.</p>
<p>Additionally, Google may share information with individuals who provide user support to an organization to which we belong. These individuals include, for example, domain administrators and resellers. Google also shares information with affiliates, which are other trusted businesses or people.</p>
<p>Finally, Google can share the information with the government for legal reasons, and it has improved its transparency in recent years concerning what kind of information it shares with the government or law enforcement.</p>
<h2>Google: Information Security</h2>
<p>Our conversation would not be complete without an examination of the security regarding our information and privacy.</p>
<p>Many Google services use HTTPS for encryption of data transmission, as well as encryption for data persistent on their servers. Additionally, Google requires two-factor authentication and makes you enter your password and a token before giving you access to your account on a new device.</p>
<p>Google also provides transparency around changes to its privacy policy. Basically, its stance on privacy policy changes is that you have to explicitly consent to any changes that may reduce your rights concerning your privacy. In other words, any changes that make the privacy more lax require your agreement before those changes go into effect with your data.</p>
<h2>EFF Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/D70E4126-197A-493A-BA09-CC58D8168CEF.png" /></p>
<h2>EFF Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/348B6806-8887-4721-BE27-1A1404BAA50A.png" /></p>
<p>Read more <a href="https://www.eff.org/who-has-your-back-government-data-requests-2015">here</a></p>
<h2>Google Privacy Policy Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/64E48411-D40C-4D92-83B3-38F2EFA1B704.png" /></p>
<h2>Google Privacy Policy Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/4C61BFC4-01BA-4D4F-B9D0-BE25ED2BCEC5.png" /></p>
<h2>Legal Deterrents Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/432B96FF-19C1-405F-A90E-302E9828A709.png" /></p>
<h2>Legal Deterrents Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/27460EF1-8AF8-4584-A28B-017A21AF6522.png" /></p>
<h2>Facebook Privacy Policies</h2>
<p>Now that we have discussed what a particular privacy policy might address, we can talk about how well a company adheres to its policy. For this example, we are going to look at Facebook.</p>
<p>Facebook has not done a good job of sticking to its privacy policy. In fact, the U.S. Federal Trade Commission (FTC) had to step in to make sure Facebook stopped doing things with user's information without their consent.</p>
<p>Facebook did numerous things that violated the privacy of its users. For example, it made information that users had designated as private, particularly regarding friend lists, public without their consent.</p>
<p>Additionally, Facebook made personal information available to applications of friends, which means that a friend could access information through an application that a user didn't agree to share.</p>
<p>Furthermore, Facebook shared information with advertisers that they had promised not to share. Finally, Facebook said that certain applications were verified when they were not verified, thus misleading users.</p>
<p>As a result, the FTC has taken action against Facebook and mandated that it acts in specific ways to rectify the situation.</p>
<p>For example, Facebook now has to undergo a third-party privacy audit every two years for the next twenty years. The FTC has decided that it cannot take Facebook's word concerning privacy, and so a third party must independently verify that Facebook is doing the right thing.</p>
<p>Additionally, Facebook is prohibited from misrepresenting privacy and security settings provided to its users. If they say something is not public, it should not be public.</p>
<p>Finally, the FTC also requires that Facebook gets consent from users before sharing any information in a way that exceeds their privacy settings.</p>
<p>Essentially, consent is the focal point when it comes to privacy. If you give express, affirmative consent to a particular action, a company can perform that action. Since Facebook did not get consent before using users' information, the FTC had to impose sanctions on them.</p>
<h2>Privacy Enhancing Technologies</h2>
<p>We've talked about how privacy is a good thing, so now let's examine some of the tools and technology we can use to enhance our privacy online.</p>
<p>One of the privacy threats that we discussed was traffic analysis. Through traffic analysis, attackers can understand who is talking to whom by looking at the source and destination information embedded in a packet.</p>
<p>If we don't want anyone to see this information, we can use a technology called <strong>TOR</strong>. Using a TOR client, a user can route their traffic through a random path of TOR nodes to their destination. Each node only knows its immediate predecessor and successor and cannot tell where a packet originated or where it is ultimately headed.</p>
<p><img alt="" src="https://assets.omscs.io/notes/F9C377F0-175D-4510-BDE0-A599B417A717.png" /></p>
<p>Because of this setup, we can use TOR to implement anonymous communication and prevent attackers from learning about the parties with whom we communicate.</p>
<h2>TOR</h2>
<p>Now that we've taken a brief look at <a href="https://www.torproject.org/">The Onion Router</a> (TOR) let's dive deeper into how it works and what services it can provide to us.</p>
<p>First, a TOR client uses a directory service to get a set of TOR nodes that can help us route a message from point A to point B. The client picks some random subset of the nodes and orders them. This order forms the path that the traffic traverses as it passes from A to B.</p>
<p>Next, the client encrypts the message as follows. It first encrypts the message with the public key of the final node. Then, it encrypts that result with the public key of the second to last node. It works backward until it finally encrypts the bundle with the public key of the first node.</p>
<p>This strategy results in a message that is encrypted in layers, hence the "onion". As the traffic passes through the network, each node decrypts its layer, unwrapping the message one decryption at a time. The final node reveals the plaintext packet and forwards it the last hop to its destination.</p>
<h2>Controlling Tracking on the Internet</h2>
<p>Browsers give us some control with regard to how we are tracked on the Internet. There are a few techniques we can employ to try to reduce the amount of information collected about us.</p>
<p>For instance, we can block third-party cookies. When we visit a site like newyorktimes.com, it can place cookies on our browser. Additionally, it can embed content from other third-party sites, like Facebook, Twitter, and Google, and those sites can also place cookies in our browser. By blocking third-party cookies, we reduce tracking to just the site that we are currently visiting.</p>
<p>Additionally, you can tell your browser that you don't want to be tracked. Many browsers allow you to set flags like this, and they pass that information along to the websites that you visit. Whether the website honors the request is a different story.</p>
<p>You can also delete your cookies periodically, block popups, and use private browsing. Each of these activities helps to reduce the amount of information an entity can capture about you.</p>
<h2>Fandango Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F0D3B2E7-12CD-439C-AE8A-5A181E96F01C.png" /></p>
<h2>Fandango Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2DF69546-F0D9-44EC-9646-6C087EFF93F9.png" /></p>
<h2>Tracking Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/AA9789FF-1BD5-42A4-91C5-7894D1E4F442.png" /></p>
<h2>Tracking Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/C431A102-4377-4BB8-9C40-BA2D6CA46F6B.png" /></h2>
<p>id: information-security-malicious-code
title: Malicious Code
course: information-security
lecture: malicious-code</p>
<hr />
<h1>Malicious Code</h1>
<h2>What is Malware Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/40637903-CAAE-402C-9F8D-DC289CB7EC62.png" /></p>
<h2>What is Malware Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/07625575-7DE3-4F7F-AEF7-5E0B1178E7A7.png" /></p>
<h2>Types of Malware</h2>
<p>There are two major types of malware.</p>
<p>The first type of malware embeds itself in a host program and executes on the system when its host runs.</p>
<p>The second type of malware interacts with systems as independent programs that can run by themselves.</p>
<p>Malware can embed itself in a host through</p>
<ul>
<li>trap doors</li>
<li>logic bombs</li>
<li>Trojan horses</li>
<li>viruses</li>
<li>browser plugins/extensions</li>
</ul>
<p>Examples of independent malware include</p>
<ul>
<li>worms</li>
<li>botnets</li>
<li>advanced persistent threats (APTs)</li>
</ul>
<h2>Trap Doors</h2>
<p><strong>Trap doors</strong> - also known as backdoors - are secret entry points to a system that are typically only known to the developer of the system.</p>
<p>Trap doors are typically activated when a user provides a special sequence of input or a special user ID to the system.</p>
<p>Trap doors can be really helpful for programmers who need or want rapid access to a system without providing the proper user authentication.</p>
<p>Of course, an attacker with possession of a trap door can wreak havoc on a system.</p>
<p>A famous but naive version of a trap door - sometimes referred to as an <strong>easter egg</strong> - is the <a href="https://www.youtube.com/watch?v=-gYb5GUs0dM">flight simulator</a>  embedded in the 1997 version of Microsoft Excel, which was activated by an undocumented series of commands entered by the user.</p>
<h2>Logic Bombs</h2>
<p>A <strong>logic bomb</strong> is essentially a trigger planted in a program. When the triggering condition is met, the planted  code is executed.</p>
<p>For example, the <a href="https://en.wikipedia.org/wiki/Code_Red_(computer_worm)">Code Red</a> worm contained a logic bomb that launched a denial of service attack at the White House web server on a specific date.</p>
<h2>Trojan Horses</h2>
<p>Trojan horses get their name from an ancient Greek story from the Trojan War. From <a href="https://en.wikipedia.org/wiki/Trojan_Horse">wikipedia</a>:</p>
<blockquote>
<p>In the canonical version, after a fruitless 10-year siege, the Greeks constructed a huge wooden horse, and hid a select force of men inside including Odysseus. The Greeks pretended to sail away, and the Trojans pulled the horse into their city as a victory trophy. That night the Greek force crept out of the horse and opened the gates for the rest of the Greek army, which had sailed back under cover of night. The Greeks entered and destroyed the city of Troy, ending the war.  </p>
</blockquote>
<p>In the context of malware, a Trojan horse is a piece of malicious code embedded in a utility program that a user runs frequently. When the utility program runs, the malicious code runs with it.</p>
<p>An example of a trojan horse is a login program that performs keylogging. This program will allow the user to login by calling the real login subroutine - a useful utility - while also stealing the user's credentials.</p>
<p>Many malicious browser extensions/plugins perform keylogging under the guise of offering some helpful utility.</p>
<h2>Viruses</h2>
<p>A <strong>virus</strong> infects a program by modifying the program code so that when a program runs the virus code also runs. A virus is unique in that it is able to spread, much like a real virus.</p>
<p>There are four main stages in the lifecycle of a virus.</p>
<p>The first phase is the <em>dormant</em> phase. In this phase, the virus has infected the host system, but remains idle.</p>
<p>The second phase is the <em>propagation</em> phase. In this phase, the virus multiplies and spreads. It can copy itself into other programs on the same host, or it can send itself to other hosts - by way of an email attachment, for example.</p>
<p>In the <em>triggering</em> phase,  the virus is activated for execution. A user clicking on an email attachment containing a virus may trigger that virus for activation.</p>
<p>The final phase is the <em>execution</em> phase. In this phase, the virus actually performs its malicious work. For example, an executing virus might delete all of the files on disk.</p>
<h2>Host Required Malware Quiz 1</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A4EDCDB2-1BCA-44CE-82D9-F9F87A38CED2.png" /></p>
<h2>Host Required Malware Quiz 1 Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/5FECA411-7C95-4E9C-B485-2FB274E512F5.png" /></p>
<h2>Host Required Malware Quiz 2</h2>
<p><img alt="" src="https://assets.omscs.io/notes/21C54A27-F1F6-4A37-969F-A29DE164F9F5.png" /></p>
<h2>Host Required Malware Quiz 2 Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/049C97B7-000C-4F42-8755-89BDE3A06DB9.png" /></p>
<h2>Virus Structure</h2>
<p>A virus infects a program by modifying the program code. In order to achieve this, the virus code has to be physically inserted into the program file.</p>
<p>When an infected program runs, the virus code runs first. The virus code then runs the original program so that the user doesn't suspect that the program has been infected. Finally, the virus code runs again, often to perform some cleanup to avoid detection.</p>
<p><img alt="" src="https://assets.omscs.io/notes/28595BDF-E52D-41AB-9E4D-19C299539E78.png" /></p>
<p>The first line of the infected program must ensure that the virus runs immediately. This can be achieved with an instruction that calls the <code>main</code> function of the virus.</p>
<p>The virus code must also place a marker on the infected program to indicate that the program has been infected. Without this flag, a program could be repeatedly infected.</p>
<p>When the virus executes, it first finds other programs to infect. It will scan other applications on the system and infect those that do not have the special infected flag set.</p>
<p>In addition to infecting other programs, the virus can perform other malicious activities on the system.</p>
<p>Finally, the virus will transfer control to the original program so that normal work can be performed. This helps to prevent the user from detecting the infection.</p>
<p>The virus can perform other actions in order to avoid detection.</p>
<p>For example, when a virus is inserted into a program file, the size of that file increases. This increase can be a telltale sign that a program has been infected; therefore, the virus code might compress the infected program so that the file size appears unchanged.</p>
<h2>Types of Viruses</h2>
<p>A <strong>parasitic virus</strong> scans non-running programs on the system - for example, those that reside on the hard drive - and then infects those programs.</p>
<p>A <strong>memory-resident virus</strong> is typically part of an operating system. When the operating system runs, the virus is loaded into memory and can infect any running program on the system.</p>
<p>A <strong>macro virus</strong> is a virus embedded in a document. The virus runs when the document is opened.</p>
<p>A <strong>boot sector virus</strong> resides in the boot sector of the hard drive and executes whenever the system is booted.</p>
<p>A <strong>polymorphic virus</strong> "looks different" with each infection. This is achieved by encrypting a portion of the virus code with a randomly generated key during each infection. The purpose of using polymorphic viruses is to avoid detection by anti-virus systems that rely on <a href="https://www.computerhope.com/jargon/v/virus-signature.htm">virus signatures</a>.</p>
<p>Any of these viruses can be polymorphic.</p>
<h2>Boot Sector Virus</h2>
<p>In order to understand a boot sector virus, we need to understand how the boot sector works.</p>
<p><img alt="" src="https://assets.omscs.io/notes/D45893B7-A8E1-43B1-99FC-8276CC5145A1.png" /></p>
<p>A <strong>boot sector</strong> is a special sector on the hard drive of a system. When a system is booted, the code in the boot sector - called the <strong>bootstrap loader</strong> - always runs first.</p>
<p>The bootstrap loader is typically responsible for loading the operating system.</p>
<p>When a boot sector virus infects a system, the virus code is inserted in the boot sector. This ensures that the virus always executes first during system boot.</p>
<p>During system boot, the virus performs its malicious functions,  such as infecting other programs, spreading to other systems, or destroying useful documents.</p>
<p>After the virus executes, it transfers control to the original bootstrap loader in order to give the appearance that the system is functioning normally.</p>
<p><img alt="" src="https://assets.omscs.io/notes/A9F823EB-31F6-4E93-8D78-1AD37DEE40C3.png" /></p>
<h2>Macro Viruses</h2>
<p>A <strong>macro</strong> is a program embedded in a document, such as a Microsoft Word document. A macro typically contains instructions for some useful functions, such as opening a file or starting a new application.</p>
<p>Because a macro is an executable program, it can be infected by viruses just like any other executable programs.</p>
<p>Macro viruses are unique in that users don't typically expect a document to contain a virus. As a result, attackers have had success spreading infected documents via email attachments.</p>
<p>When an unsuspecting user clicks on the email attachment and opens the document, the macro executes, and the macro virus runs.</p>
<p>The macro virus can perform malicious activities such as sending the infected document to every person in the user's address book.</p>
<p>A macro virus can also copy its macro to the global macro file. Whenever a user opens a new document, this now global macro will be copied into the new document, meaning that all new documents on the user's system will be infected.</p>
<h2>Types of Viruses Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/133BBEDD-CE14-4ED3-A8ED-48F539E3E52B.png" /></p>
<h2>Types of Viruses Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6294734B-447D-4C84-9F5E-C80BD8923832.png" /></p>
<p>Macro viruses run when an infected document is opened with a given application. Boot sector viruses run before the operating system is loaded.</p>
<h2>Rootkit</h2>
<p>A <strong>rootkit</strong> is a program that typically modifies some of the code and data structures in an operating system in order to perform some malicious activities.</p>
<p>A rootkit can be used to hide malware from a user.</p>
<p>For example, when the user executes the <code>ls</code> command to list the contents of a directory, the rootkit can change the output of this command so that the user will not see the malware file.</p>
<p>Similarly, when the user executes the <code>ps</code> command to see what programs are running on the system, the rootkit can change the output of this command to hide the running malware.</p>
<p>Here is the functional flow for listing files using the windows command <code>dir</code>.</p>
<p><img alt="" src="https://assets.omscs.io/notes/9474681E-8F39-4A87-B7A7-191C40CF07C0.png" /></p>
<p>Before the rootkit has been embedded, here is what an operating system will typically return when the user lists the files in a directory.</p>
<p><img alt="" src="https://assets.omscs.io/notes/16203A74-AC28-4BD8-9E31-9A74AF188A49.png" /></p>
<p>The installed rootkit intercepts any call to the operating system and then determines whether the call will reveal the malware. If so, the rootkit alters the result to hide the malware; otherwise, it passes the result to the caller unmodified.</p>
<p><img alt="" src="https://assets.omscs.io/notes/E559CAC9-6FCA-4ED3-AEF0-DBAD9ADDCE39.png" /></p>
<p>For example, the rootkit can intercept the directory listing from the <code>dir</code> command and remove the malware entry.</p>
<p><img alt="" src="https://assets.omscs.io/notes/E9070948-A413-4C12-9C50-22D1DDFD6A18.png" /></p>
<h2>Rootkit Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F9D17F35-7B72-4538-9425-77C62F298C1D.png" /></p>
<h2>Rootkit Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F4D927F4-F0EF-4056-9F9C-3979A28E1375.png" /></p>
<h2>Truth and Misconceptions Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/C55A0FCE-82C4-4243-83F9-9FE14B9B1982.png" /></p>
<h2>Truth and Misconceptions Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FE1571D1-8225-4963-ABEA-379773BD8D9A.png" /></p>
<h2>Worms</h2>
<p>Worms are independent malicious programs that typically use network connections to spread from one system to another.</p>
<p>Worms first appeared in the 1990s - coinciding with the rapid expansion of the Internet - and marked a major advance in malware.</p>
<p>Worms later evolved into botnets around 2005, which remain the dominant form of malware we see today.</p>
<h2>The Internet Worm</h2>
<p>One of the most famous worms is the <strong>Morris Worm</strong>, named after its creator Robert Morris. This worm is also referred to as the <em>Internet Worm</em>.</p>
<p>According to Morris, this worm was used to gauge the size of the Internet by measuring how many computers were connected together.</p>
<h3>Programming Error</h3>
<p>However, there was a programming error in the code which transformed this intellectual exercise into a damaging attack.</p>
<p>The worm would ask a target system if it had been infected. Even if the target responded that it had, the worm would infect the system again, one out of seven times.</p>
<p>This reinfection rate proved too aggressive, and many systems that had been infected multiple times crashed.</p>
<p>Sysadmins had to disconnect their servers from the Internet in order to disinfect them. Since many servers were infected, Internet service overall was disrupted.</p>
<h3>Implementation</h3>
<p>When the Morris Worm identified the next target to infect, it looked for several security flaws that it knew how to exploit.</p>
<p>From <a href="http://www.loundy.com/CASES/US_v_Morris2.html">court documents</a>:</p>
<blockquote>
<p>Morris identified four ways in which the worm could break into computers on the network: (1) through a "hole" or "bug" (an error) in SEND MAIL, a computer program that transfers and receives electronic mail on a computer; (2) through a bug in the "finger demon" program, a program that permits a person to obtain limited information about the users of another computer; (3) through the "trusted hosts" feature, which permits a user with certain privileges on one computer to have equivalent privileges on another computer without using a password; and (4) through a program of password guessing, whereby various combinations of letters are tried out in rapid sequence in the hope that one will be an authorized user's password, which is entered to permit whatever level of activity that user is authorized to perform.  </p>
</blockquote>
<p>Specifically, the <code>fingerd</code> daemon was exploited via a buffer overflow vulnerability, and <code>sendmail</code> was exploited via a trapdoor that accepted shell commands.</p>
<p>Once the worm gained access to a target system, it then loaded a small piece of code - the bootstrap loader - which fetched the rest of the worm code. Password-based authentication was used to ensure that only the bootstrap loader could fetch the worm code.</p>
<p>The worm employed a number of tricks to hide itself.</p>
<p>For example, once the worm code was loaded into memory, it deleted its original file from disk and encrypted/decrypted itself as necessary. In addition, the worm even periodically changed its process name and ID, so a sysadmin looking at running programs could not easily discover the worm.</p>
<h3>What We Learned</h3>
<p>Most of the flaws exploited by the Morris Worm were not only well known at the time but also had security patches available. The worm taught us the importance of frequent security scanning and patching.</p>
<p>We also learned that we need to have a fast and coordinated response to a major security incident like the Morris Worm. The US government established the <a href="https://en.wikipedia.org/wiki/Computer_emergency_response_team">Computer Emergency Response Team</a> (CERT), which is responsible for issuing alerts about security flaws and recommendations about patches.</p>
<h2>Worm Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/63C5BA47-1177-48B3-8C53-AB4B8BD90395.png" /></p>
<h2>Worm Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/60DAF027-9368-40B6-AE36-FC6EA78B32B8.png" /></p>
<h2>Malware Prevention &amp; Detection Approaches</h2>
<p>We can prevent malware from infecting our computer systems  by limiting our contact with the outside world. In other words, if we don't accept documents or programs from any external source, we can greatly reduce our chance of infection.</p>
<p>Obviously, this approach imposes a major inconvenience to a computer user.</p>
<p>Instead of preventing infection, we can try to improve how we detect an infection. We can continually improve the monitors that we use to watch for telltale signs of infection.</p>
<p>In addition, we can focus on removal. Once we detect a malware infection, we remove the malware and potentially also patch the system.</p>
<p>Given that prevention severely hampers productivity, detection is the main countermeasure that we use.</p>
<p>There are 4 generations of antivirus software, each with different strategies for detecting malware infection.</p>
<h3>Simple Scanners</h3>
<p><strong>Simple malware scanners</strong> scan program files looking for signatures (patterns) of known viruses. If a scanner finds a signature, it means that the program file has been infected by a known virus.</p>
<p>A <strong>virus signature</strong> is typically a unique sequence of instructions in the virus code or the unique infection marker that the virus would use.</p>
<p>These simple scanners are not effective against polymorphic viruses because each instance of a polymorphic virus is encrypted with a random key, meaning that there is no unique signature across all instances of the same virus.</p>
<h3>Heuristic Scanners</h3>
<p><strong>Heuristic scanners</strong> look for the possible effects of infection. For example, if a program file has been infected, the <a href="https://en.wikipedia.org/wiki/Checksum">checksum</a> of the file will change because the file contents have changed.</p>
<p>This approach can be defeated if the malware deliberately ensures that the checksum after infection remains the same, which can be done by including some additional bytes at the end of the file.</p>
<h3>Activity Traps</h3>
<p><strong>Activity traps</strong> monitor the system by watching for particular kinds of activities that malware would usually perform on a system, such as reading a password file and sending it over the Internet.</p>
<p>These detectors are based on our knowledge of malware activities. Therefore, they are not effective against malware that performs new kinds of malicious activities.</p>
<h3>Full-Featured Analysis</h3>
<p>A full-featured analysis typically involves multiple detection approaches, such as host-based monitoring - which includes activity traps and scanners - and network-based monitoring, which examines network traffic to detect suspicious activity.</p>
<p>This strategy can also include a sandbox-based analysis. A <strong>sandbox</strong> is typically a secure, observable environment on the system that is isolated from the rest of the system.</p>
<p>We can observe a suspicious executable in a sandbox first to ensure that it will not cause any damage to the system or network before allowing it to run outside of the sandbox.</p>
<h2>Malware Prevention &amp; Detection Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/36682CCE-48D2-43A0-B174-A5558BA230E6.png" /></p>
<h2>Malware Prevention &amp; Detection Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/919A3EB0-92AE-4221-BFC5-D339E835C7E6.png" /></p>
<h2>Most Expensive Worm Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/8C469D3D-9061-45F2-8B2F-53D35CBD5A30.png" /></p>
<h2>Most Expensive Worm Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/38A65997-26BC-4D80-A560-169AF0930940.png" /></p>
<h2><a href="https://encyclopedia2.thefreedictionary.com/Top+10+Worst+Computer+Worms+of+All+Time">Source</a></h2>
<p>id: information-security-mandatory-access-control
title: Mandatory Access Control
course: information-security
lecture: mandatory-access-control</p>
<hr />
<h1>Mandatory Access Control</h1>
<h2>Discretionary Access Control</h2>
<p>In the last lesson we talked about access control.</p>
<p>In particular, we focused on <strong>discretionary access control</strong> (DAC), whereby the user who creates a resource is the owner of that resource and can choose to give access to other users.</p>
<h2>Two Problems with DAC</h2>
<p>To illustrate the first problem with DAC, let's consider the following scenario.</p>
<p>Alice owns a file and gives read access to Bob, but not to Charlie. Bob copies the contents into a new file, and shares that file with Charlie. Charlie now has effective access to the file that Alice didn't want to share with him in the first place.</p>
<p>While DAC allows users to control direct access to a file, we can't actually prevent the spread of data contained in that file; that is, we can't control the <em>information flow</em>.</p>
<p>Another problem with DAC is that it doesn't reflect how most organizations treat their data. Most employers do not leave the decisions about data sharing in the hands of their employees, but rather mandate explicit policies about who can share what.</p>
<p>To address these problems, we will explore another model for access control: <strong>mandatory access control</strong> (MAC). In mandatory access control, decisions about sharing information are not made at the discretion of the user.</p>
<h2>DAC Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FFAA8FAE-B0AC-421F-A71A-2B59F7D76D87.png" /></p>
<h2>DAC Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/CC4FCC5B-CC40-4ADC-8AC7-B14CEA595009.png" /></p>
<p>DAC can't control information flow, so we must use MAC.</p>
<h2>Mandatory Access Control (MAC) Models</h2>
<p>Hospitals are a great example of an entity that needs to employ mandatory access control.</p>
<p>Hospitals store and process electronic health records (EHRs), which contain medical information about patients. We regard  health information as highly sensitive and, as such, seek to limit who can access and/or share this information.</p>
<p>In addition, there are regulatory requirements that limit how medical information can be shared and control how patient records can be accessed. <a href="https://www.hhs.gov/hipaa/index.html">HIPAA</a> is the legislation in the United States that dictates how records can be accessed and shared.</p>
<p>Of course, there is a need to share your medical information - if you see a new doctor, for instance.</p>
<p>The point is that these access control decisions are not dictated by the individual performing data entry on the patient's record, but rather by the hospital and the government.</p>
<h2>Implementing MAC</h2>
<p>In mandatory access control, users and resources/documents will have certain labels associated with them.</p>
<p>A <strong>label</strong> is simply an identifier that will tell us how sensitive certain information is, or how privileged a certain user is. Labels can also contain categories, which can be used to group users or documents.</p>
<p>While the TCB does not assign these labels, it uses labels to determine whether a given user can access a given resource.</p>
<p>In order to grant access decisions, we have to be able to compare labels. Labels must have an order so that the system can make consistent decisions.</p>
<p>For example, if <code>A &gt; B &gt; C</code>, the system will deny access to a document with label <code>A</code> to a user with label <code>B</code>, but will grant that user access to a document with label <code>C</code> .</p>
<p>The exact nature of what the labels look like, how we compare them, and the result of the comparison depends on the particular policy being implemented.</p>
<p>In the Department of Defense, the labels will include a clearance level for users and a classification level for documents, as well as a compartment. The compartment is used to describe what kind of information a document contains and what categories of information a user can access.</p>
<p>In the commercial world, we don't have notions of clearance and classification, so the labels will look different.</p>
<p>The concerns are different as well. For example, we may have a policy that prevents conflict of interest. A user may not be able to access resources from which they stand to enjoy a material gain.</p>
<h2>Implementing MAC Example</h2>
<p>In the Department of Defense, documents have classifications and users have clearances.</p>
<p>The sensitivity levels present in the DoD system, in order from most sensitive to least sensitive, are: Top Secret, Secret, Confidential, Restricted, and Unclassified.</p>
<p>A label contains a sensitivity level and a compartment that describes what kind of data is contained in the document.</p>
<p>Let's consider two different documents, which contain information about various arms stockpiles.</p>
<p>One document may have the label <code>(TS, {nuclear, chemical})</code>, identifying it as a top secret document concerned with nuclear and chemical weapons.</p>
<p>The other document may have the label <code>(S, {nuclear, conventional})</code>, identifying it as a secret document containing information about nuclear and conventional weapons.</p>
<p>A document may pertain to multiple topics, so the compartment can have multiple entries.</p>
<p>The <a href="https://en.wikipedia.org/wiki/Bell%E2%80%93LaPadula_model">Bell-LaPadula Model</a> (BLP) makes use of labels and provides a set of rules that determines when a document can be read or written.</p>
<h2>Health Data Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B190798D-AB66-4B7B-938B-ED38D21FBB4C.png" /></p>
<h2>Health Data Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9EF783B9-6360-427A-918C-CDF9773C4034.png" /></p>
<p>BLP is concerned with military/governmental intelligence. HIPAA is concerned with health information.</p>
<h2>Security Clearance Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/4492690A-933D-4088-BCCC-51031EA9A047.png" /></p>
<h2>Security Clearance Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/D0C61525-5A43-4B43-8C64-4CCBC4715B41.png" /></p>
<p>Source: <a href="https://www.washingtonpost.com/news/the-switch/wp/2014/03/24/5-1-million-americans-have-security-clearances-thats-more-than-the-entire-population-of-norway/?noredirect=on">Washington Post</a></p>
<h2>Comparing Labels</h2>
<p>In order to fully implement access control using labels, we need some strategy for comparing labels.</p>
<p>Sensitivity levels in the DoD scheme are ordered as follows:</p>
<p><code>bash
TS &gt; S &gt; C &gt; U</code></p>
<p>This ordering is <em>total</em>, which means that if you pick any two sensitivity levels, you can always determine which level is more sensitive than the other.</p>
<p>Labels also have compartments, which comprise sets of different topics.</p>
<p>Two sets <code>S1</code> and <code>S2</code> can be oriented such that</p>
<ul>
<li><code>S1</code> is contained in <code>S2</code></li>
<li><code>S2</code> is contained in <code>S1</code></li>
<li>Neither set contains the other</li>
</ul>
<p>Sets are compared by containment. A set that contains another set is "greater" than that set. Note that this ordering is <em>partial</em>, because two sets that don't contain each other cannot be ordered.</p>
<p>When we want to order labels, we must look at both the sensitivity level and the compartment</p>
<h2>Comparing Labels Example</h2>
<p>Based on the comparison rules just described, the following chart depicts the circumstances under which</p>
<ul>
<li>one label dominates another</li>
<li>two labels are equal</li>
<li>two labels are not comparable</li>
</ul>
<p><img alt="" src="https://assets.omscs.io/notes/5A925057-513C-4F06-B342-E5D00A71AD2C.png" /></p>
<h2>Ordering Among Labels</h2>
<p>Let's try to compare the following labels.</p>
<p><code>bash
L1 = (TS, {A,B,C})
L2 = (S, {A, B})
L3 = (S, {B, C, D})</code></p>
<p><code>L1</code> dominates <code>L2</code>  because <code>TS &gt; S</code> , and <code>{A, B, C} &gt; {A, B}</code>.</p>
<p><code>L2</code> cannot be compared with <code>L3</code> because while <code>S == S</code>, <code>{A, B}</code> cannot be compared to <code>{B, C, D}</code>.</p>
<p>Similarly, <code>L1</code> and <code>L3</code> cannot be compared. While <code>TS &gt; S</code>, <code>{A, B, C}</code> cannot be compared with <code>{B, C, D}</code>.</p>
<h2>Order Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2F90AB65-3E72-4760-BB6B-28DB02993748.png" /></p>
<h2>Order Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/37633CE2-16DD-45D5-B67D-52318AF4DD6E.png" /></p>
<p>Given any two real numbers, one number is always greater than the other.</p>
<h2>Label Domination Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/11C6E389-14C8-4928-B128-A743249D4F2A.png" /></p>
<h2>Label Domination Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/89DAADB0-D668-480D-8B6D-38C0037CCE42.png" /></p>
<p>While <code>secret &lt; top-secret</code> , <code>{Asia, Europe}</code> cannot be compared with <code>{Europe, South-America}</code>.</p>
<h2>Sensitive Data Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/65E58104-8D29-4E6C-AE31-FCB742D1C233.png" /></p>
<h2>Sensitive Data Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/34881303-A27C-4BB1-807C-03DE3A0016D9.png" /></p>
<p>In order for <code>D1</code> to dominate <code>D2</code>, <code>D1</code> must have a higher sensitivity level than <code>D2</code>.</p>
<p>In addition, the compartment of <code>D1</code> must contain the compartment of <code>D2</code> in order to be 'greater' (based on the ordering rules for sets). For this to be the case, the compartment of <code>D2</code> must be a subset of ("narrower" than) the compartment of <code>D1</code>.</p>
<h2>Using Labels for MAC: Confidentiality</h2>
<p>The <strong>Bell and LaPadula Model</strong> (BLP) is a model that deals with confidentiality. Its development was funded by the DoD.</p>
<p>The model is concerned with disclosure of information and preventing information of one classification level from being shared with individuals possessing a clearance level of lower sensitivity.</p>
<p>Since the model was developed for the DoD, this model assumes the classification/clearance levels of top secret, secret, classified, and unclassified. In addition, a label can have a compartment that describes what a given document is about.</p>
<p>There are two main operations a user can perform with a file - read and write - and so the model defines a rule for each operation.</p>
<h3>Read-Down Rule</h3>
<p>The read rule says that a user with label <code>L1</code> can read a document with label <code>L2</code> only if <code>L1</code> dominates <code>L2</code>.</p>
<p>For example, a user with secret clearance may read a classified document.</p>
<p>This rule is the <em>read-down rule</em>, also known as the <strong>simple security property</strong>. A user can read documents that are classified at their clearance level or lower.</p>
<h3>Write-Up Rule</h3>
<p>The write rule says that a user with label <code>L1</code> can write a document with label <code>L2</code> only if <code>L2</code> dominates <code>L1</code>.</p>
<p>For example, a user with secret clearance may write a top secret document.</p>
<p>This rule is the <em>write-up rule</em>, also referred to as the <strong>star property</strong> (*-property). A user can write documents that are classified at their clearance level or higher.</p>
<p>What is the rationale for write-up?</p>
<p>If I am a user with top secret clearance and I write a secret document, I may - inadvertently or maliciously - include top secret information in that document.</p>
<p>Since users with secret clearance can now read this document, we have broken the containment of top secret information to the top secret clearance level.</p>
<p>For this reason, users are only allowed to write documents at their clearance level or higher.</p>
<h2>Preventing Information Flow with BLP</h2>
<p>Information flow is a problem that cannot be addressed with discretionary access control. Mandatory access control - in particular, the BLP model - solves the information flow problem.</p>
<p><img alt="" src="https://assets.omscs.io/notes/4FE897A0-C072-4EA6-8500-C9D672BA0036.png" /></p>
<p>Basically, we want to ensure that top secret information never ends up in the hands of individuals with less than top secret clearance.</p>
<p>The write-up and read-down rule prevent more sensitive information from flowing into the hands of users with a less sensitive clearance.</p>
<p>On one hand, users with secret clearance are not allowed to read top secret documents.</p>
<p>On the other hand, users with top secret clearance are not allowed to write secret documents, lest they reveal some top secret information in them.</p>
<p>A user with secret clearance is thus unable to access top secret information because: one, they are explicitly prohibited from reading top secret documents, and; two, users with top secret information are prohibited from writing that information into secret documents.</p>
<h2>Unclassified Documents Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/EA4A6F50-B773-4345-BD3C-28CFB3AEA7D4.png" /></p>
<h2>Unclassified Documents Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3D70CF4F-3BC7-40D2-B75C-FB84BB1CE0D8.png" /></p>
<p>Write-down says that individuals cannot write documents with a classification that is less than their security clearance. Therefore, unclassified documents cannot be written by individuals holding a security clearance of classified, secret, or top secret.</p>
<h2>Classified Data Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2BE2011C-6B0A-4D48-BF24-575316A8F447.png" /></p>
<h2>Classified Data Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A699ECFA-0934-4CCD-9C63-056FD1E46428.png" /></p>
<p>Because of the write-up rule, individuals are allowed to write documents at a classification level that is greater than their clearance level. Individuals with unclassified security clearance are thus allowed to write top secret documents.</p>
<h2>BLP Model Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/C4229ADC-2062-4802-BD5C-8BA008F90F29.png" /></p>
<h2>BLP Model Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3D182BB1-66B8-4F82-8795-E5BEEA1C6F11.png" /></p>
<p>For example, if a user is writing to a top secret document, and the classification level suddenly changes to secret, the write-up rule is violated and information is flowing in the wrong direction.</p>
<h2>Other MAC Models</h2>
<p>Instead of focusing on confidentiality, the <strong>Biba Model</strong> focuses on integrity.</p>
<p>Remember, integrity is concerned with information quality, while confidentiality is concerned with information disclosure.</p>
<p>The Biba rules are the inverse of the BLP rules.</p>
<p>When you are concerned about information integrity, you want to <em>read up</em>. Information that is of lower quality than the information that you produce is of no interest to you.</p>
<p>In addition, Biba defines a write down rule. If you can produce information at a certain level of integrity, you can surely produce information at a lower integrity. Therefore, you can write documents at or below your integrity level.</p>
<p>For example, the New York Times may have a high level of integrity. That information can likely be trusted. Supermarket tabloids are low integrity. Information in those documents is likely of poor quality.</p>
<p>The compartment component of the integrity label can capture the topic(s) of the document, similar to BLP.</p>
<p>The point is that low integrity information should never flow into high integrity documents.</p>
<h2>Policies for Commercial Environments Part 1</h2>
<p>In commercial environments, user clearance is not common. However, other requirements exist.</p>
<p>One common requirement is that data should only be accessed by certain applications, and only certain users should be able to gain access to those applications.</p>
<p>For example, only employees in payroll should have access to salary files.</p>
<p>Another requirement that arises in commercial environments is preventing conflict of interest. Users must be prevented from accessing information that can place them in a conflict of interest.</p>
<p>For example, a financial analyst advising a bank should not have access to confidential information from other banks.</p>
<p>Finally, a separation of duty requirement can be important for reducing the possibility of fraud. If a user can take on multiple roles, it can be easier for them to commit fraud.</p>
<p>For example, a user should not be able to both authorize and execute a financial transaction.</p>
<h2>Policies for Commercial Environments Part 2</h2>
<p>Let's look at two different policies that make sense for commercial environments.</p>
<h3>Clark-Wilson Policy</h3>
<p>The <strong>Clark-Wilson Policy</strong> says that users should only be able to access certain applications, and only certain applications can access certain objects in the system.</p>
<p>Put another way, the access that a user has to objects in the system is constrained by the applications they are allowed to use.</p>
<p>Achieving separation of duty through this policy is as simple as blocking access to the set of programs that would allow a user to conduct fraudulent activity.</p>
<h3>Chinese Wall Policy</h3>
<p>The <strong>Chinese Wall Policy</strong> deals with conflict of interest. Specifically, this model dictates that what a user can access now depends on what they have accessed in the past.</p>
<p>If the documents you have accessed so far have no conflict with the document you are currently requesting, access may be granted. Otherwise, access will be denied.</p>
<p>Let's assume we have the following documents in our system.</p>
<p><img alt="" src="https://assets.omscs.io/notes/FF68C6DD-8AB9-4A4C-B4A5-EFCB0EB09B02.png" /></p>
<p>The group of documents in the "Banks" box are referred to as a <strong>conflict class</strong>. Since Wells Fargo, Chase, and Bank of America are all competitors, access to documents about more than one of these banks can present an individual with a conflict of interest.</p>
<p>Similarly, the "Oil Companies" conflict class contains documents about competitors Exxon, Shell and Chevron.</p>
<p>The Chinese wall policy basically says that a user can access any object as long as they have not previously accessed an object from the same conflict class.</p>
<p>For example, once a user accesses a document pertaining to Exxon, they can access a document pertaining to Chase, but cannot access a document pertaining to Shell.</p>
<h2>Clark Wilson Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A286764A-C66E-4C60-9CE7-106440934312.png" /></p>
<h2>Clark Wilson Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A4317935-9B6A-4DB8-869A-1644B8A403F0.png" /></p>
<p>In mandatory access control, sharing decisions are not made at the discretion of the user.</p>
<h2>COI Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FD528D21-BCC6-48D4-A1F4-179CB9A9470B.png" /></p>
<h2>COI Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2A693A0B-93E6-4AE5-B6AB-3869601B5800.png" /></p>
<p>Competition implies that there is a possibility for a conflict of interest. Chinese Wall is best at preventing these situations.</p>
<h2>RBAC Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/18AF82C6-AE0E-4A04-BE46-24C199FAC8DF.png" /></p>
<h2>RBAC Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/E32A017C-052D-4DF1-94CA-ABBD02770338.png" /></p>
<p>In mandatory access control, the company decides who can share what.</p>
<h2>MAC Support Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1F3AB8F6-7244-44E3-91BD-833C137AC8FD.png" /></p>
<h2>MAC Support Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B94746DE-2747-401F-B607-68799681137C.png" /></p>
<h2>Revisiting TCB</h2>
<p>How do we know that a certain system that claims to be a trusted computing base can actually be trusted?</p>
<p>First, it is important to talk about terminology.</p>
<p>When we talk about something being secure, we are usually talking about a binary quality of a system. Either something is secure or it isn't.</p>
<p>When we talk about a system being trusted, we mean that we have a high level of confidence that the system will uphold the requirements that we expect it to uphold.</p>
<p>This high level of assurance is what we expect from the trusted computing based comprised of the operating system and the underlying hardware.</p>
<p>Any other claims we are able to make about the security implemented in the system - access control, for example - depend on the security of the trusted computing base.</p>
<h2>Trusting Software</h2>
<p>Software is supposed to perform a set of functions. If it is going to implement certain functionality, it has to be functionally correct. It should do what it was designed to do.</p>
<p>To implement these functions, the software has to maintain certain data structures and state. Software often exposes an interface/API to allow users to consume and manipulate this state. Malicious users will use these entry points to attempt to compromise the system. The software must maintain the integrity of the data it relies on, especially in the face of malicious input.</p>
<p>The TCB stores and consumes sensitive data. It must protect this data and address the confidentiality/disclosure of this data. It must perform these duties in the presence of untrusted software.</p>
<p>Our assurance in the TCB describes how confident we are in its ability to carry out the above functions. We cannot always demand formal proof that a program works as expected, but there are certain actions that can increase our confidence.</p>
<p>For example, experts can analyze a program and assure the level of trust that a system provides. It is their word on which we derive our trust in the system.</p>
<p>In addition, we think about our requirement/needs as forming a specification of the security expectations we have for a system. Some vendor who builds the TCB (operating system) thus builds the system to those requirements.</p>
<p>The verification of trust should be formally (mathematically) derived where possible, but this level of certification is not always feasible.</p>
<h2>TCB Design Principles</h2>
<p>Trust in the trusted computing base is going to come from a number of design principles we expect a TCB to embody.</p>
<p>A trusted computing base should follow the principle of least privilege. Any time a user is executing, they should be provided with the least amount of privilege required to complete their task.</p>
<p>Remember, a trustworthy system is one that performs with a high likelihood of security. That being said, there is no guarantee. If something goes wrong - a malicious user gains access, for example - least privilege provides damage containment.</p>
<p>A trustworthy system should abide by economy of mechanism. The trusted code should be small and it should be simple. Simple code is easier to analyze and less code means less bugs.</p>
<p>A trustworthy system should have an open design. Trust is not going to come through blindly believing a software vendor. Security by obscurity is a lie. We want open design so we can know exactly how a certain level of security is being achieved.</p>
<p>A trusted system should enforce complete mediation. Every access is checked by the system and attempts to bypass the system must be prevented.</p>
<p>A trusted system should provide fail-safe defaults. This means that the default behavior should be the safest behavior. When we talk about access control, for example, the fail-safe default is to deny access.</p>
<p>Finally, a trusted system should be psychologically acceptable. We have to make the right assumptions about what users are able to do and what they are not able to do. Users avoid security that gets in their way.</p>
<p>Trust comes from building a system with these principles in mind.</p>
<h2>Least Privilege Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/125DFCBE-E30F-4B38-AE98-DB12FA30C0DC.png" /></p>
<h2>Least Privilege Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FC19D98D-46EB-46BE-8AE3-7C75BF6E482B.png" /></p>
<p>The TCB provides high assurance, not certainty.</p>
<h2>TCB High Assurance Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F33DDE22-EF71-4878-9A86-1153AE4C938B.png" /></p>
<h2>TCB High Assurance Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/47F700ED-F1EE-4693-B99C-5117AEEF93A2.png" /></p>
<p>Security by obscurity violates open design.</p>
<h2>Design Principle Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/130DA7AD-F9EE-498B-807C-C00F7111C79B.png" /></p>
<h2>Design Principle Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/D70011C5-D8EA-404D-82A6-7A6C4A77DDDB.png" /></p>
<p>A fail-safe default is one that provides security unless otherwise specified. In this case, the default should be traffic encryption.</p>
<h2>Support Key Security Features</h2>
<p>If we claim a system to be a trusted computing base, it must fulfill certain key requirements. Specifically, the system must implement certain functions that are relevant to security.</p>
<p>For example, the system must address authentication, otherwise it cannot know who is making a request for a resource in the system.</p>
<p>Additionally, the system must perform access control against the objects it protects. We talked about two different kinds of access control.</p>
<p>Systems may support mandatory access control, using the BLP model or other models that we discussed. SELinux is an example of a platform that supports MAC.</p>
<p>Systems can also support discretionary access control, whereby the creator of a resource has control over who can and cannot access it.</p>
<h2>Data Protection</h2>
<p>One of the requirements of a TCB is that it must be tamper-proof. In order to achieve this, an operating system must protect the data it uses.</p>
<p>When we talk about security features of trusted operating systems, one aspect that we can focus on is <strong>object reuse protection</strong>.</p>
<p>During execution, a process can allocate some temporary memory or disk space for storing information. When that process completes, the operating system needs to reclaim those resources to give to other processes.</p>
<p>If a process leaves behind some (potentially sensitive) data and the operating system reallocates the resources containing that data to a new process, the new process can potentially read that data. The operating system will have broken process isolation.</p>
<p>A system must understand that a process can leave behind some artifacts in these reusable resources and must ensure that they are "zeroed out" before being allocated again.</p>
<p><strong>Secure file deletion</strong> refers to the operating system procedure of overwriting reclaimed disk space with varying patterns of zeros and ones in order to obfuscate the original contents.</p>
<p><strong>Secure disk destruction</strong> is not really the job of the TCB, but rather is just a good practice when disposing of a computer. This involves <a href="https://en.wikipedia.org/wiki/Degaussing">degaussing</a> or otherwise physically destroying your disk during disposal.</p>
<h2>Trusted Paths</h2>
<p>A TCB must ensure complete mediation. We have to guarantee that there is no way to get to a resource without passing through the trusted computing base.</p>
<p>We also need to have a trusted path from the user to the secure system. Without the trusted path, a malicious program could spoof the interface of the trusted system.</p>
<p>Alternatively, a malicious program could tap into the communication path between a user and the TCB in the absence of a trusted path.</p>
<p>For example, a keylogger could tap the communication path from the keyboard to the operating system and record your password.</p>
<p>A trusted path confers confidence that a user is communicating exclusively with the trusted computing base.</p>
<h3>Auditing</h3>
<p>We've talked a lot about prevention mechanisms, such as authentication and authorization, which are used to block inappropriate access to system resources.</p>
<p>The reality is that no matter how hard we work at prevention, things will go wrong. With this realization, we have to employ detection mechanisms in addition to prevention mechanisms.</p>
<p>We can keep an <strong>audit log</strong> of what happens in the system, and can use this log to detect unusual behavior that may be indicative of system misuse/abuse.</p>
<p>Naturally, the audit log, like all other data managed by the TCB, must also be tamper-proof.</p>
<p><a href="https://en.wikipedia.org/wiki/Butler_Lampson">Butler Lampson</a> describes the gold standard of security as authentication, authorization and audit. The symbol for gold is "Au" in the periodic table.</p>
<h2>Kernel Design</h2>
<p>One approach for creating a trusted computing base is to design a <strong>security kernel</strong> where you bring the security-relevant functions together and place them at the core of the system you are trying to build.</p>
<p>In this approach, the security mechanisms and enforcement strategies live in the kernel and ensure the proper government of the rest of the system.</p>
<p>Kernel design strives to find the smallest possible system that encapsulates the necessary security mechanisms. This size requirement helps to ensure that the kernel is isolated from other parts of the system. In addition, smaller kernels lend themselves to easier analysis/verification.</p>
<p>Like other trusted computing bases, a security kernel must be tamper-proof and enforce complete mediation.</p>
<h2>Kernel Design and TCB</h2>
<p>The mechanisms that are necessary for the correct enforcement of security policy belong in the security kernel.</p>
<p>Resources are implemented using physical hardware that we attach to the system, and the correct implementation of security blocks direct access to those physical resources.</p>
<p>Complete mediation can also be handled by virtualization. In virtual environments, host operating systems have handles for virtual resources, and the hypervisor allows us to achieve both hardware isolation and logical OS separation.</p>
<h2>Revisiting Assurance</h2>
<p>In addition to describing the functionality that a TCB must possess, we need some <em>assurance</em> that it is actually carrying out those functions.</p>
<p>One basic check involves interacting with the developers of the system and ensuring that they have implemented all of the necessary requirements.</p>
<p>A more structured way to provide assurance is to extensively test the system. There are three main types of testing.</p>
<p>One type of testing looks at functionality. We write tests to ensure that our functions execute and our software is not "buggy".</p>
<p>Another type of testing is <strong>penetration testing</strong>. In penetration testing, the tester approaches the software with the adversarial mindset and specifically tries to uncover vulnerabilities in the system.</p>
<p>The final kind of testing is <strong>regression testing</strong>, which we run when we enhance a system to make sure that new features don't break functionality or hurt performance of existing features.</p>
<p>As a word of caution: testing can only demonstrate the existence of a problem. Tests cannot demonstrate the absence of a problem. For example, you cannot run a suite of tests and then claim that the system is completely secure.</p>
<p>Even better than testing is to have a formal proof that irrefutably verifies the functionality and security of a system.</p>
<h2>Assurance Challenges</h2>
<h3>Functional Testing</h3>
<p>A developer must generate the right set of test cases when testing a system. Test cases demonstrate the existence of problems, and without a sufficient number of test cases, problems may go undiscovered.</p>
<p>In testing a system, you want to have good code coverage. Ideally, you want to be able to test every execution path present in the system, so you can concretely understand any behavior that the system will exhibit when it is deployed.</p>
<p>The problem with this ideal is that execution paths grow exponentially in a system. For example, every <code>if-else</code> construct doubles the number of execution paths that need to be tested.</p>
<p>In addition, a system may behave differently in different execution environments, which also adds to the difficulty of achieving comprehensive testing.</p>
<h3>Penetration Testing</h3>
<p>In penetration testing, we deliberately employ an ethical hacker to attempt to defeat the security measures we have in place.</p>
<p>As the good guys, we have the burden of ensuring that <em>every</em> possible execution path is secure. In penetration testing, the tester just needs to find <em>some</em> execution path containing a vulnerability that can be exploited in order to demonstrate a problem.</p>
<p>If they can't find any issues, this doesn't prove that we don't have a problem. Testing - penetration or otherwise - cannot demonstrate the absence of a problem.</p>
<h3>Formal Verification</h3>
<p>A formal verification is a mathematical specification of a program's behavior. This verification proves which security assertions and properties hold throughout the execution of a system.</p>
<p>There are automated ways to formally verify a program, such as <a href="https://en.wikipedia.org/wiki/Model_checking">model checking</a> and <a href="https://en.wikipedia.org/wiki/Automated_theorem_proving">automated theorem proving</a>.</p>
<p>These approaches typically look at the initial set of state variables in a program and watch how the code changes these variables. Throughout the execution of the program, assertions about security are verified against the program state.</p>
<p>The problem with model checking is the same that we had with testing. The state space grows exponentially which makes this approach unfeasible for anything other than relatively small programs.</p>
<p>Model checking pioneers won the Turing Award in 2007 and this field remains an area of active research.</p>
<h2>Reducing TCB Size Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/11F63B01-9D9D-4070-B054-C4DE0A004584.png" /></p>
<h2>Reducing TCB Size Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B9687C3C-5D80-45A9-9112-224E955CDF88.png" /></p>
<h2>Testing TCB Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/DFED8BC1-EB62-44EB-A00D-06864E69B0AE.png" /></p>
<h2>Testing TCB Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/5F87B5BC-DB54-413C-8348-BF6973C787F5.png" /></p>
<p>Testing can't show the absence of problems.</p>
<h2>Model Checking Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1DD38815-AC14-4050-8BE4-CD4B6545DE3B.png" /></p>
<h2>Model Checking Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B90F59EF-3CF9-42B6-BC7C-6237B4AB68B2.png" /></p>
<h2>Security Evaluations: The Orange Book</h2>
<p>Many people are faced with the problem of trying to evaluate the level of security present in a system.</p>
<p>The Department of Defense created the <a href="https://en.wikipedia.org/wiki/Trusted_Computer_System_Evaluation_Criteria">Trusted Computer System Evaluation Criteria</a> to address this problem.</p>
<p>This document defines a ranking of system security using the following divisions (letters) and classes (numbers).</p>
<p><code>bash
D &lt; C1 &lt; C2 &lt; B1 &lt; B2 &lt; B3 &lt; A1</code></p>
<p>Division D is reserved for systems that do not meet the requirements for a higher division.</p>
<p>A system has to implement authentication and discretionary access control to be considered for division C. A system must implement mandatory access control to be considered for division B. A system must be formally verified via mathematical techniques to be considered for division A.</p>
<p>Most commercial systems have been evaluated at C1, C2, or B1.</p>
<p>In order to advance to B2, a system needs to demonstrate a proof of correctness for the underlying security model and provide a narrative specification for the TCB.</p>
<p>A system that provides a formal verification of TCB correctness is a candidate for B3/A1.</p>
<h2>Security Evaluations: Common Criteria</h2>
<p>After time, multiple countries began to recognize the importance of security evaluation, and TCSEC was replaced by an international standard which combined US, Canadian and European efforts: the <a href="https://en.wikipedia.org/wiki/Common_Criteria">Common Criteria</a>.</p>
<p>The idea is that as a consumer of a system, users specify what security they want to see in their software. Vendors implement  these requirements and make claims about their solution meeting users' needs. The evaluator determines if the claims that are made match the specifications.</p>
<p>The <strong>evaluation assurance level</strong> (EAL) rates the trustworthiness of the system. EAL1 is the most basic rating and EAL7 is the most rigorous.</p>
<h2>TCSEC Divisions Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/812B3058-CB14-4745-9085-7D918AD2AE0F.png" /></p>
<h2>TCSEC Divisions Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/472F8C5A-752D-4F31-B25E-1AB70F353DDF.png" /></p>
<h2>Earning an EAL4 Certification Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1BD7FA8D-A4A3-420D-B034-5DE4ACFF0305.png" /></p>
<h2>Earning an EAL4 Certification Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/54D03A5C-FF37-40C9-A359-3F2B765910B4.png" /></p>
<h2>Cost Benefit Certification Tradeoffs Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0DB30C2E-0FDD-438F-8532-4B6CC06E7977.png" /></p>
<h2>Cost Benefit Certification Tradeoffs Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/FC3F201F-6A8B-4E3B-9725-E8128B9719E5.png" /></h2>
<p>id: information-security-midterm-1-study-guide
title: Midterm 1 Study Guide
course: information-security
lecture: midterm-1-study-guide</p>
<hr />
<h1>Midterm 1 Study Guide</h1>
<h2>DAC</h2>
<p>Which Type of control is based on the identity of the requestor and the access rules state what a requestor can or cannot do?</p>
<ul>
<li>A) Mandatory Access Control (MAC)</li>
<li>B) Role-based access control (RBAC)</li>
<li>C) Discretionary access control (DAC)</li>
<li>D)Attribute-based access control (ABAC)</li>
</ul>
<details>
<summary>Answer</summary>
C. This policy is termed discretionary because an entity might have access rights that permit the entity, by its own volition, to enable another entity to access some resource.

Source: Book Chapter 4.2 Page 131
</details>

<p>What data structure is typically used to implement DAC?</p>
<ul>
<li>A) Linked List</li>
<li>B) 2 Dimensional Matrix</li>
<li>C) Red Black Tree</li>
<li>D) Stack</li>
</ul>
<details>
<summary>Answer</summary> B

Source: Book Chapter 4.3 Page 111
</details>

<p>Access Control Lists make it easy to look up who all the users are that can access a resource, and the type of access they have for that resource.</p>
<p>True or False?</p>
<details>
<summary>Answer</summary>  True

Source: Book Chapter 4.3 Page 111
</details>

<p>Question: What does each entry of an access matrix indicate?</p>
<ul>
<li>A. Access rights of a particular object for a particular subject.</li>
<li>B. Access rights of a particular subject for a particular object.</li>
<li>C. Access rights of a particular subject for a particular directory.</li>
<li>D. Access rights of a particular object for a particular group.</li>
</ul>
<details>
<summary>Answer</summary>  B.

Source: Book pg. 111
</details>

<p>(True/False) DAC is a concept that evolved out of requirements for military information security.</p>
<details>
<summary>Answer</summary>  False, DAC is the traditional method for implementing access control, MAC was created out of military necessity.

Source: Book, Ch 4, Pg. 109
</details>

<p>(True/False) One problem with DAC is that it is not possible to control information flow.</p>
<details>
<summary>Answer</summary>  True

Source: Mandatory Access Control Lecture
</details>

<p>(True/False) DAC is popular with corporations because it reflects how they treat their data.</p>
<details>
<summary>Answer</summary>  False. Employers mandate explicit policies on who can share what.

Source: Mandatory Access Control Lecture
</details>

<h2>Program/Host Privileges -- Program control flow</h2>
<p>Put the following statements, regarding the sequence of calls made made by a function call to the stack, in the correct order:</p>
<ul>
<li>A. Allocate space for local variables by moving the stack pointer down to leave sufficient room for them.</li>
<li>B. Push the parameters for the called function onto the stack.</li>
<li>C. Run the body of the called function.</li>
<li>D. Execute the return function which pops the saved address off the stack and returns control to the calling function.</li>
<li>E. Push the current frame pointer value (which points to the calling routine's stack frame) onto the stack.</li>
<li>F. Executes the call instruction to call the target function, which pushes the return address onto the stack.</li>
<li>G. Pops the old frame pointer value (restoring the link to the calling routine's stack frame).</li>
<li>H. Sets the frame pointer to be the current stack pointer value, which now identifies the new stack frame location for the called function.</li>
<li>I. Set the stack pointer back to the value of the frame pointer.</li>
</ul>
<details>
<summary>Answer</summary>
B, F, E, H, A, C, I, G, D

From text pg 327.
</details>

<h2>Access control mechanisms</h2>
<p>An access control mechanism mediates between a user (or a process executing on behalf of a user) and system resources, such as:</p>
<ul>
<li>a) firewalls</li>
<li>b) routers</li>
<li>c) applications</li>
<li>d) a &amp; b only</li>
<li>f) All of the above</li>
</ul>
<details>
<summary>Answer</summary>
f) All of the above

Textbook, Chapter 4, pg. 108
</details>

<p>Which of the following is granting permission to a system entity to access a system resource?</p>
<ul>
<li>A) Authentication</li>
<li>B) Authorization</li>
<li>C) Audit</li>
<li>D) Allowance</li>
<li>E) None of the Above</li>
</ul>
<details>
<summary>Answer</summary>  B, Authorization determines who is trusted for a given purpose
Source: Book Chapter 4.1 Page 130
</details>

<p>Question: Access control implements a security policy that verifies the credentials of a user. True or false?</p>
<details>
<summary>Answer</summary>  False. Access control implements a security policy that specifies who or what may have access to each specific system resource, and the type of access that is permitted in each instance.

Source: Book pg. 107
</details>

<h2>MAC</h2>
<p>Under Mandatory Access Control(MAC), what two properties provide confidentiality:</p>
<details>
<summary>Answer</summary>
1. No read up: A subject can only read an object of less or equal security level
2. No write down: A subject can only write into an object of greater or equal
security level.

Source: Book Chapter 27 Page 27-4
</details>

<p>A subject is said to have a security clearance of a given level and an object is said to
have a security classification of a given level.</p>
<details>
<summary>Answer</summary>  True

Source: Book Chapter 27 Page 27-4
</details>

<p>For the Bell-Lapadula Model (BLP), the properties needed for the confidentiality form of MAC are:</p>
<ol>
<li>ds-property and *-property</li>
<li>ss-property and *-property</li>
<li>ss-property and ds-property</li>
<li>None of the above</li>
</ol>
<details>
<summary>Answer</summary>  2. (Chapter 27.1)

ss-property (simple security property: no read up
\*-property (star property): no write down

The ds-property is a provision made by BLP for DAC but must be consistent with MAC rules.
</details>

<p>Other MAC models such as Bell and La Padua(BLP Model) is focused on Integrity, and BIBA model is focused on Confidentiality.</p>
<details>
<summary>Answer</summary>  False. BLP focuses on Confidentiality and BIBA focuses on Integrity.

Source: P1:L6 MAC slides | Other MAC models
</details>

<p>Examples of BLP model classfications are High, Medium, and Low.</p>
<details>
<summary>Answer</summary>  False. Examples are Top Secret, Secret, Confidential.

Source: P1:L6 MAC slides | Other MAC models
</details>

<p>MAC cannot be employed with other access control policies, such as DAC, RBAC, and ABAC.</p>
<details>
<summary>Answer</summary>  False. All four access policies (DAC, MAC, RBAC, and ABAC) are not mutually exclusive.

Source: Book, Ch. 4, Pg. 109
</details>

<h2>RBAC</h2>
<p>In the context of Role-Based Access Control Models, What does RBAC2 provide?</p>
<details>
<summary>Answer</summary>  Constraints, mutually exclusive roles, Cardinality

Source: Book Pages 147-148
</details>

<p>______ is based on the roles that users assume in a system rather than a user's identity.</p>
<ul>
<li>A. DAC</li>
<li>B. MAC</li>
<li>C. RBAC</li>
<li>D. ABAC</li>
</ul>
<details>
<summary>Answer</summary>  C

Source: Book pg. 120
</details>

<p>What kind of relationship is a role to a user in RBAC?</p>
<ul>
<li>A) 1 to 1</li>
<li>B) 1 to Many</li>
<li>C) Many to 1</li>
<li>D) Many to Many</li>
</ul>
<details>
<summary>Answer</summary>  D, a role can have many users. a user can have many roles.
Source: Book Chapter 4.5 Page 146
</details>

<p>What aspect of an established RBAC system is likely to change infrequently?</p>
<ul>
<li>A) The set of resources and the specific access rights associated with a particular role.</li>
<li>B) The set of roles in the system.</li>
<li>C) The set of users.</li>
<li>D) A &amp; B</li>
<li>E) None of the above.</li>
</ul>
<details>
<summary>Answer</summary>  D

Source: Book. Ch 4, Pg 120
</details>

<p>The RBAC prerequisite role can be used for the following:</p>
<ul>
<li>A) A way to increase the difficulty of collusion among individuals of different skills or divergent job functions to thwart security policies.</li>
<li>B) For structuring the implementation of the least privilege concept.</li>
<li>C) As a risk mitigation technique for a sensitive or powerful permission.</li>
<li>D) None of the above</li>
</ul>
<details>
<summary>Answer</summary>  B.

Source: Book, Ch 4, Pg 125
</details>

<h2>ABAC</h2>
<p>Question: What are the 3 attributes of ABAC model?</p>
<details>
<summary>Answer</summary>

- a) Subject - active entity: user, application, process, device
- b) Object - passive entity: file, record, network, domain
- c) Environment: date/time, virus activity, network's security level

Source: book p. 127https://www.proprofs.com/quiz-school/story.php?title=mr-f-quiz-network
</details>

<p>Question: How does ABAC model controls access?</p>
<details>
<summary>Answer</summary>  ABAC evaluates attributes of subject/object and access control rule defining allowable operation in a given environment

Source: book p. 127
</details>

<p>In the Attribute-Based Access Control (ABAC) model: current date and time, the current virus/hacker activities, and the network's security level are known as ____</p>
<ul>
<li>A) Object attributes</li>
<li>B) Subjects attributes</li>
<li>C) Environment attributes</li>
<li>D) Access Right</li>
<li>E) None of the Above</li>
</ul>
<details>
<summary>Answer</summary>  C. environments describe the operational, technical, and even situational environment or context in which the information access occurs

Source: Book Chapter 4.6 Page 149
</details>

<p>In a(n) _____ model, authorizations can be defined that express conditions on properties of both the resource and the subject.</p>
<ul>
<li>A. DAC</li>
<li>B. MAC</li>
<li>C. RBAC</li>
<li>D. ABAC</li>
</ul>
<details>
<summary>Answer</summary>  D

Source: Book pg. 126
</details>

<p>The strength of the ABAC approach is its <strong><em>_</em></strong><em> and <strong><em>_</em></strong></em>.</p>
<ul>
<li>A. strictness, performance</li>
<li>B. flexibility, expressive power</li>
<li>C. extensibility, ease of use</li>
<li>D. None of the above</li>
</ul>
<details>
<summary>Answer</summary>  B

Source: Book pg. 126
</details>

<h2>Database and Data Center (Understanding of Inference)</h2>
<p>Question: _____is the process of performing authorized queries and deducing unauthorized information from the legitimate response received.</p>
<details>
<summary>Answer</summary>  Inference

Source: book p.166
</details>

<p>Question: What are the approaches to deal with inference attack?</p>
<details>
<summary>Answer</summary>

- a) Inference detection during DB design: removing data dependencies, using more fine-grained access control roles in RBAC scheme
- b) Inference detection at query time: if inference channel is detected, the query is denied.

Source: book p.167
</details>

<p>Question: A <strong><em>_</em></strong> can provide restricted access to a relational database so a user or application only has access to certain rows or columns.</p>
<ul>
<li>A. primary key</li>
<li>B. view</li>
<li>C. relation</li>
<li>D. tuple</li>
</ul>
<details>
<summary>Answer</summary>  B

Source: Book pg. 153
</details>

<p>Question: <strong><em>_</em></strong> is an attack that exploits a security vulnerability occurring in the database layer of an application (such as queries).</p>
<ul>
<li>A. Trojan horse</li>
<li>B. Logic bomb</li>
<li>C. SQLi</li>
<li>D. Buffer overflow</li>
</ul>
<details>
<summary>Answer</summary>  C

Source: Book pg. 156
</details>

<p>Question: Improper handling of user input can result in a SQL injection. True or false?</p>
<details>
<summary>Answer</summary>  True. The attack is viable when user input is either incorrectly filtered for string literal escape characters embedded in SQL statements OR user input is not strongly typed.

Source: Book pg. 156
</details>

<p>Question: SQLi attacks can be grouped into three main categories: <strong><em>_</em></strong>, <strong><em>_</em></strong>_, and ______.</p>
<ul>
<li>A. parameterized, user input, blind injection</li>
<li>B. second-order injection, out-of-band, parameterized</li>
<li>C. inferential, blind injection, inband</li>
<li>D. inband, inferential, out-of-band</li>
</ul>
<details>
<summary>Answer</summary>  D

Source: Book pg 158
</details>

<p>Question: What are the main avenues of attack for SQL injection?</p>
<ul>
<li>A. Cookies</li>
<li>B. Server variables</li>
<li>C. User input</li>
<li>D. Second-order injection</li>
<li>E. Physical user input</li>
<li>F. All of the above</li>
<li>G. None of the above</li>
</ul>
<details>
<summary>Answer</summary>  F

Source: Book pg. 158
</details>

<p>Question: Defensive coding is an effective way to dramatically reduce the threat from SQLi. True or false?</p>
<details>
<summary>Answer</summary>  True

Source: Book pg. 160
</details>

<p>Question: In a DBMS, what happens in the following scenario assuming each of these steps are followed sequentially? Assume the grant option is always used.</p>
<ul>
<li>Ann grants access right to Bob.</li>
<li>Ann grants access right to Chris.</li>
<li>Bob grants access right to David.</li>
<li>David grants access right to Ellen.</li>
<li>Chris grants access right to David.</li>
<li>David grants access right to Frank.</li>
<li>Ellen grants access right to Jim.</li>
<li>
<p>Bob revokes access right from David.</p>
</li>
<li>
<p>A.David no longer has the access right.</p>
</li>
<li>B. David, Ellen, Frank, and Jim no longer have the access right.</li>
<li>C. David, Ellen, and Jim no longer have the access right.</li>
<li>D. Ellen and Jim no longer have the access right.</li>
</ul>
<details>
<summary>Answer</summary>  D. In most implementations, the revocation is cascaded. In this case, since Chris also granted access to David, then David won't have his access revoked, but Ellen since her access was granted after Bob (and before Chris) had granted access to David. Frank's access remains since David granted access to him after Chris granted access to David.

In general terms, if the access right would exist anyway, then the revoke is not cascaded.

Source: Book pg. 163
</details>

<h2>TCB (what it is, what it is comprised of, what it does)</h2>
<p>The Trusted Computing Base or TCB has 3 main requirements which of the following is not a requirement.</p>
<ul>
<li>A.) Complete mediation between the OS and the hardware resources and applications. In addition the OS must make sure the application has the necessary authorizations.</li>
<li>B.) The OS must be tamperproof.</li>
<li>C.) The OS must must be able to go from user to kernel mode without errors</li>
<li>D.) The OS must be correct and ensures that protected resources are used properly</li>
</ul>
<details>
<summary>Answer</summary> C

Lectures 2 OS and Security
</details>

<h2>Injection attacks and how to defend them</h2>
<p>Question: _____attack occurs when user input is incorrectly filtered for string escape characters or user input is not strongly typed.</p>
<details>
<summary>Answer</summary>  SQLi

Source: book p.156
</details>

<p>Question: Illegal/logically incorrect queries return often overly descriptive errors from the application server and allow an attacker to gather important information about the server. This is part of what type of attack?</p>
<details>
<summary>Answer</summary>  inferential attack

Source: book p.159
</details>

<p>Question: Which of the following are proper measures to defend against SQLi attacks?</p>
<ul>
<li>a) user input validation</li>
<li>b) parameterized query insertion</li>
<li>c) SQL DOM</li>
<li>d) a and b</li>
<li>e) All of the above</li>
</ul>
<details>
<summary>Answer</summary>  e)

Source: book p.160
</details>

<p>Which of the following Detection methods to prevent SQLi attacks define a training phase to learn normal behavior?</p>
<ul>
<li>A) Anomaly-based</li>
<li>B) Signature-based</li>
<li>C) Code analysis</li>
<li>D) None of the above</li>
</ul>
<details>
<summary>Answer</summary>  A. Anamoly based attempts to define normal behavior then detect behavior patterns outside the normal range.

Source: Book Chapter 5.4 Page 182
</details>

<h2>Viruses: Their types and what they do</h2>
<p>There are <strong><em>_</em></strong>__ generations of antivirus software.</p>
<ul>
<li>A.     Two</li>
<li>B.     Three</li>
<li>C.     Four</li>
<li>D.     Five</li>
</ul>
<details>
<summary>Answer</summary>  C

From: https://www.proprofs.com/quiz-school/story.php?title=mr-f-quiz-network
</details>

<p>A <strong><em>_</em></strong>___ virus is a virus that mutates with every infection, making detection by the "signature" of the virus impossible.</p>
<ul>
<li>A.    Metamorphic</li>
<li>B.    Encrypted</li>
<li>C.    Polymorphic</li>
<li>D.    Stealth</li>
</ul>
<details>
<summary>Answer</summary>  C

From: https://www.proprofs.com/quiz-school/story.php?title=mr-f-quiz-network
</details>

<p>Which of the following viruses are classified by concealment?</p>
<ul>
<li>A) Macro Virus</li>
<li>B) Encrypted Virus</li>
<li>C) Polymorphic Virus</li>
<li>D) Metamorphic Virus</li>
<li>E) B, C, D</li>
<li>F) All of the above</li>
</ul>
<details>
<summary>Answer</summary>  E. viruses in B,C,D fit this description. Macro viruses are classified by Target rather than concealment

Source: Book Chapter 6.3 Page 215
</details>

<p>Which phase does a virus place a copy of itself into other programs?</p>
<ul>
<li>A) Dormant Phase</li>
<li>B) Propagation Phase</li>
<li>C) Triggering Phase</li>
<li>D) Execution Phase</li>
</ul>
<details>
<summary>Answer</summary>  B

Source: Book Chapter 6.3 Page 211
</details>

<p>Which type of document is not known to carry macro viruses?</p>
<ul>
<li>A. Microsoft Word Document</li>
<li>B. Plain Text File</li>
<li>C. Adobe PDF File</li>
<li>D. Microsoft Excel File</li>
</ul>
<details>
<summary>Answer</summary>  B

Source: page 212 Chapter 6.3
</details>

<p>Macro Viruses will manipulate, call functions on the host document's content only.</p>
<p>True/False?</p>
<details>
<summary>Answer</summary>  False

Source: page 213 Chapter 6.3. Their ability to interact with other parts of the system is demonstrated by the "Melissa" macro virus, which uses a Windows system registry to keep track of infection status.
</details>

<p>Metamorphic Viruses are harder to detect than Polymorphic Viruses.</p>
<p>True/False?</p>
<details>
<summary>Answer</summary>  True

Source: page 215 Chapter 6.3. Also https://searchsecurity.techtarget.com/definition/Metamorphic-virus
</details>

<h2>Access Control lists</h2>
<p>Question: Access Control Lists may have default entry that should always follow the rule of least privilege. True/False?</p>
<details>
<summary>Answer</summary>  True

Source: book p.111
</details>

<p>Question: Each element of the Access Control List contains the following:</p>
<ul>
<li>A.) Permitted Access Rights</li>
<li>B.) Users</li>
<li>C.) All of the Above</li>
<li>D.) Capability Tickets</li>
<li>E.) All of the above</li>
</ul>
<details>
<summary>Answer</summary>  C

Page 111
</details>

<p>The columns of an Access Control Matrix are Access Control Lists.</p>
<details>
<summary>Answer</summary>  True. The matrix may be decomposed by columns, yielding
access control lists (ACLs) (see Figure 4.2b). Decomposition by rows yields capability lists (see Figure 4.2c).

Source: Book chapter 4.3 page 133
</details>

<p>Most of the operating systems use <strong><em>_</em>. In addition to this </strong>__ is more efficient for finding access rights</p>
<ul>
<li>A.) ACLs &amp; C-List</li>
<li>B.) TCB &amp; Chmod</li>
<li>C.) Revocation &amp; ACL</li>
<li>D.) C-List &amp; ACLs</li>
</ul>
<details>
<summary>Answer</summary>  A

Source: Lecture 5 notes
</details>

<h2>Project 1</h2>
<p>Name: Chris Taylor</p>
<p>Question: The <strong><em>_</em></strong>__ contains the base address of data stored within the stack for the current procedure.</p>
<details>
<summary>Answer</summary>  EBP Register

Source: Quite possibly on the exam
</details>

<p>Which of the following functions can lead to a buffer overflow vulnerability:</p>
<ul>
<li>A.) gets() &amp; fgets()</li>
<li>B.) gets() &amp; strcpy()</li>
<li>C.) main() &amp; gets()</li>
<li>D.) strncpy() &amp; gets()</li>
</ul>
<details>
<summary>Answer</summary> B
</details>

<p>Both the stack and heap grow up in memory address space. (True/False)</p>
<details>
<summary>Answer</summary>  False. The stack grows down in memory while the heap grows up.
</details>

<p>What data structure is implemented in heap memory?</p>
<ul>
<li>A. Chunk</li>
<li>B. Pointer</li>
<li>C. Frame</li>
<li>D. Buffer</li>
</ul>
<details>
<summary>Answer</summary>  A
</details>

<p>An attacker exploits a program and launches a shell. With which privilege level are the instructions executed?</p>
<ul>
<li>A. User</li>
<li>B. Root</li>
<li>C. System</li>
<li>D. Host Program</li>
</ul>
<details>
<summary>Answer</summary>  D. The attacker's shellcode is run with the privileges of the exploited program. Source: L2 "Shellcode Privileges"
</details>

<p>Which of the following does not get stored in a stack?</p>
<ul>
<li>A) return address</li>
<li>B) local variables</li>
<li>C) arguments</li>
<li>D) global Variables</li>
<li>E) Meta Data</li>
<li>F) base pointer</li>
<li>G) D,E</li>
<li>H) E,F</li>
<li>I) D,E,F</li>
</ul>
<details>
<summary>Answer</summary>  G. Global Variables are stored in the data segment in memory. Meta Data is stored with allocated chunks of a heap.

Source: https://www.geeksforgeeks.org/memory-layout-of-c-program
</details>

<h2>Unix File access control</h2>
<p>What are the 3 main types of subject/principals in unix?</p>
<details>
<summary>Answer</summary>
user, group, world/other
</details>

<p>What are the "classic" 3 permissions afforded to the subjects in unix-like?</p>
<p>Read (r), Write(w), Execute(x)</p>
<p>A user (U) can run with the permission of the file creator (C) under what condition(s)?</p>
<ul>
<li>a) U has execute privileges</li>
<li>b) C has read, write, and execute permissions</li>
<li>c) Set User ID</li>
<li>d) Set Group ID</li>
<li>e) a nd c</li>
<li>f) all of the above</li>
</ul>
<details>
<summary>Answer</summary>  E
</details>

<p>What contents exist inside of a file's inode?</p>
<details>
<summary>Answer</summary>
Owner ID, Group ID and 12 protection bits
</details>

<p>What is an inode (index node)?</p>
<ul>
<li>A.) An inode is part of a linked list design for memory storage</li>
<li>B.) An inode is a special directory only to bee seen by root</li>
<li>C.)An inode is a control structure that contains information needed by the OS for a file.</li>
<li>D.) An inode is a user permission for a given user group.</li>
</ul>
<details>
<summary>Answer</summary>  C

Page 117
</details>

<p>True or False: An inode contains all information about a file?</p>
<details>
<summary>Answer</summary>
False

inode's don't contain the file name and actual data
Source: Internet
</details>

<h2>Role hierarchy</h2>
<p>Question: The concept of inheritance enables one role to implicitly include access rights associated with a subordinate role. What role-based access control makes use of this concept?</p>
<details>
<summary>Answer</summary>  Role hierarchy

Source: book p.124
</details>

<h2>Security and IoT</h2>
<p>Question:
______interconnects IoT devices with higher-level networks, translates protocols, and may perform basic data aggregation function.</p>
<details>
<summary>Answer</summary>  Gateway

Source: book p.446
</details>

<p>Typically gateways implement secure functions what are the two common security mechanisms:</p>
<ul>
<li>A.) IPsec and Firewalls</li>
<li>B.) TLS and IPsec</li>
<li>C.) Checksums and CRC Mechanisms</li>
<li>D.) Canary Values and ASLR mechanisms</li>
</ul>
<details>
<summary>Answer</summary>  B

Page 448
</details>

<p>Which of the following is NOT key component in IOT enabled devices</p>
<ul>
<li>A)Actuator</li>
<li>B)Sensor</li>
<li>C)Microcontroller</li>
<li>D)Transceiver</li>
<li>E)Back Bone network</li>
<li>F)Radio-frequency Identification (RFID)</li>
</ul>
<details>
<summary>Answer</summary>  E. backbone network connects geographically dispersed fog networks as well as provides access to other networks that are not part of the enterprise network.

Source: Book Chapter 13.4 Page 466-467
</details>

<p>Which of the following are NOT a typical use case for botnets?</p>
<ul>
<li>A) Spamming</li>
<li>B) DDos attacks</li>
<li>C) Spear phishing</li>
<li>D) Sniffing traffic</li>
</ul>
<details>
<summary>Answer</summary>  C. Spear phishing is a targeted attack whereas botnets are typically used as a swarm to work in concert to perform their attacks.

Source: Book P207
</details>

<h2>Malwares</h2>
<p>Which Malware was the first of a new generation that included aspects of virus, worm and trojan in one package.</p>
<ul>
<li>a) Morris worm</li>
<li>b) Melissa e-mail worm</li>
<li>c) Cod Red worm</li>
<li>d)WannaCry ransomware</li>
</ul>
<details>
<summary>Answer</summary>  b

global edition pg. 219 chapter 6, Malicious software
</details>

<p>What type of Malware is Easter egg?</p>
<ul>
<li>a) Virus</li>
<li>b)Worm</li>
<li>c)Trojan</li>
<li>d)Trapdoor</li>
</ul>
<details>
<summary>Answer</summary>  d

Malicious Code slides
</details>

<p>What is software the collects information form a computer and transmits it to another system monitoring keystrokes, network traffic and other screen data?</p>
<ul>
<li>A.) Spammer Programs</li>
<li>B.) Keylogger</li>
<li>C.) Spyware</li>
<li>D.) Trojan Horse</li>
</ul>
<details>
<summary>Answer</summary> C.)

Page 185
</details>

<p>Which type of malware is a program installed on an infected machine that is activated to launch attacks on other machines?</p>
<ul>
<li>A) Virus</li>
<li>B) Trojan</li>
<li>C) Worm</li>
<li>D) Bot</li>
<li>E) Root Kit</li>
</ul>
<details>
<summary>Answer</summary>  D

Source: Book Chapter 6.1 Page 207
</details>

<p>Which of the following properties are not commonly found in both Viruses and Worms?</p>
<ul>
<li>A. Dormant, Propagation, Triggering, and Execution phases</li>
<li>B. May attempt to determine if a system has been previously infected</li>
<li>C. Requires a host program to run</li>
<li>D. Can be polymorphic to evade detection</li>
</ul>
<details>
<summary>Answer</summary>  C

Source Page 222 Chapter 6.4
</details>

<h2>Threats, attacks, and assets</h2>
<p>Question:
Communication links, bridges, and routers are considered as assets to protect.</p>
<ul>
<li>a) True</li>
<li>b) False</li>
</ul>
<details>
<summary>Answer</summary>  a) True

Source: book p.7
</details>

<p>Passive network attacks are difficult to detect but can be prevented ; Active network attacks are difficult to prevent altogether but can be detected.</p>
<ul>
<li>a) True</li>
<li>b) False</li>
</ul>
<details>
<summary>Answer</summary>  a) True

Source: book p.15
</details>

<p>According to RFC 4949 there are four kinds of threats which threat consequence is not part of RFC 4949?</p>
<ul>
<li>A.) Unauthorized Disclosure</li>
<li>B.) Deception</li>
<li>C.) Usurpation</li>
<li>D.) Corruption</li>
</ul>
<details>
<summary>Answer</summary> D. corruption is a type of disruption where disruption is a threat consequence and and corruption is the threat attack.

Page 9
</details>

<p>If a hospital worker changes a patient's file without the patient's knowledge. Then they have broken ____</p>
<ul>
<li>A) Confidentiality</li>
<li>B) Integrity</li>
<li>C) Availability</li>
<li>D) Accountability</li>
</ul>
<details>
<summary>Answer</summary>  B, Integrity: Guarding against improper information modification or destruction, including ensuring information nonrepudiation and authenticity.

Source: Book Page 25
</details>

<p><strong><em>_</em></strong>_____, a design principle for secure systems, states that security measures can not be bypassed.</p>
<ul>
<li>A) Least Privilege</li>
<li>B) Fail-Safe Defaults</li>
<li>C) Economy of Mechanism</li>
<li>D) Open Design</li>
<li>E) Complete Mediation</li>
<li>F) Psychological Acceptability</li>
</ul>
<details>
<summary>Answer</summary>  E) Complete Mediation - no one should be able to bypass security measures. "Every access to every object is checked" (Schneider).

Source: Lecture 1 "How Do We Address Cyber Security?"
Schneider, Fred. http://www.cs.cornell.edu/courses/cs513/2005fa/NL02.html
</details>

<h2>Cloud service models</h2>
<p>Question:
____is not part of cloud service model (according to NIST SP 800-145).</p>
<ul>
<li>a) Software-as-a-Service</li>
<li>b) Platform-as-a-Service</li>
<li>c) Code-as-a-Service</li>
<li>d) Infrastructure-as-a-Service</li>
</ul>
<details>
<summary>Answer</summary>  c) Code-as-a-Service

Source: book p.426
</details>

<p>Question:
In which cloud service model cloud service user has control over OS, deployed applications, and possibly limited control of select networking components?</p>
<details>
<summary>Answer</summary>  Infrastructure-as-a-Service

Source: book p.426
</details>

<p>A cloud broker can offer three areas of support. Which of the following is not an area of support?</p>
<ul>
<li>A.) Service Intermediation</li>
<li>B.) Service aggregation</li>
<li>C.) Service arbitrage</li>
<li>D.) Service Auditor</li>
</ul>
<details>
<summary>Answer</summary>D. A service auditor is incorrect you might be thinking of cloud auditor if you picked this (a cloud auditor evaluates the services by the cloud service provider in terms of security controls, privacy impact and such)

Page 431
</details>

<p>The typical cloud deployment models include which of the following?</p>
<ul>
<li>A) Public, Private, Hybrid, Community</li>
<li>B) Public, Private, PaaS, SaaS</li>
<li>C) PaaS, SaaS, Hybrid, Community</li>
<li>D) IaaS, On-prem, Saas, PaaS</li>
</ul>
<details>
<summary>Answer</summary>  A, IaaS, PaaS, SaaS are cloud service models, not deployment models
</details>

<h2>Means of authentication</h2>
<p>Question:
What is the initial requirement for performing user authentication?</p>
<ul>
<li>A.) User must be registered within the system.</li>
<li>B.) A token must be verified</li>
<li>C.) A digital signature needs to e authenticated</li>
<li>D.) A multi factor system has to be in place</li>
</ul>
<details>
<summary>Answer</summary>  A

Page 65
</details>

<p>What are examples of static vs dynamic biometric recognition?</p>
<ul>
<li>A.) Dynamic biometric could be a fingerprint and Static could be a voice pattern</li>
<li>B.) Dynamic can be face recognition and static could be fingerprint</li>
<li>C.) Dyamic is when you have an electronic keycard and static is a fingerprint</li>
<li>D.) Static biometric is a fingerprint and dynamic biometric is a voice pattern</li>
</ul>
<details>
<summary>Answer</summary>  D

Page 66
</details>

<p>The means for authenticating a user can be summarized in general terms by four things. What are the four things?</p>
<ul>
<li>A.) Something the user knows, possesses, is and does.</li>
<li>B.) Something the user knows, possesses, is and wants</li>
<li>C.) Something the user can see, knows, wants and doesn't have</li>
<li>D.) something the user knows, is, wants and does</li>
</ul>
<details>
<summary>Answer</summary>  A

Page 66
</details>

<p>Question:
Bad person Eve walks up to the system and says she is Alice, and successfully logs in as Alice. This authentication outcome is a:</p>
<ul>
<li>A.) False negative</li>
<li>B.) False positive</li>
</ul>
<details>
<summary>Answer</summary>  B

P1:L4 Authentication (Authentication Goals video slide)
</details>

<p>Question: In order to increase the difficulty of an offline dictionary attack, a salt can be combined with a password before hashing. True or false?</p>
<details>
<summary>Answer</summary>  True. For a salt of length b bits, the number of possible passwords is increased by a factor of 2^b

Source: Book pg. 72
</details>

<p>Question: Which of the following is NOT a vulnerability of passwords?</p>
<ul>
<li>A. Offline dictionary attack</li>
<li>B. Specific account attack</li>
<li>C. Workstation hijacking</li>
<li>D. Electronic monitoring</li>
<li>E. None of the above</li>
</ul>
<details>
<summary>Answer</summary>  E. Additionally there is popular password attack, password guessing against single user, exploiting user mistakes, and exploiting multiple password use.

pg 71
</details>

<p>Question: When an applicant applies to a registration authority (RA) to become a subscriber of a credential service provider (CSP), the RA is responsible for issuing an electronic credential. True or false?</p>
<details>
<summary>Answer</summary>  False. The CSP issues the electronic credential to the subscriber.

Source: Book pg. 65
</details>

<p>Question: Which of the following is not a common physical characteristic used for biometric authentication?</p>
<ul>
<li>A. Fingerprints</li>
<li>B. Hair color</li>
<li>C. Voice</li>
<li>D. Signature</li>
<li>E. Iris</li>
<li>F. All of the above</li>
<li>G. None of the above</li>
</ul>
<details>
<summary>Answer</summary>  B. Facial characteristics are used, but that does not include a person's hair color.

Source: Book pg. 88
</details>

<p>Question: What is the purpose of a nonce used in a challenge-response password protocol?</p>
<ul>
<li>A. Prevent the hash of the password from being transmitted directly.</li>
<li>B. Eliminate need for host to store user's password.</li>
<li>C. Defend against a replay attack.</li>
<li>D. All of the above</li>
<li>E. A &amp; B</li>
<li>F. B &amp; C</li>
<li>G. A &amp; C</li>
<li>H. None of the above.</li>
</ul>
<details>
<summary>Answer</summary>  G. The nonce is used in generating a hash which the client sends to the server. The nonce is also randomly generated at the start of the session, so if an attacker tried a replay attack, they have a different nonce and thus would fail.

Source: Book pg. 93-94
</details>

<p>Question: Which of the following statements is false?</p>
<ul>
<li>A. Client attacks are when an adversary attempts to masquerade as a legitimate user.</li>
<li>B. Host attacks are directed at the user file on the host where passwords, tokens, etc are stored.</li>
<li>C. One form of eavesdropping refers to attempting to learn the password by observing the user.</li>
<li>D. Reply attacks are when an attacker repeat a previously captured user response.</li>
<li>E. A trojan horse attack is when an attacker when malicious hardware / software is used to log a user's keystrokes.</li>
<li>F. A denial of service attack is when an attack disables user authentication service by flooding it with numerous authentication attempts.</li>
</ul>
<details>
<summary>Answer</summary>  E. In a trojan horse attack, an app or device masquerades as an authentic application or device for the purpose of capturing a user password, passcode, etc. Example: rogue bank machine used to capture user's card / PIN.

Source: Book pg. 97
</details>

<h2>Assurance levels</h2>
<p>Question:
____ is defined as the degree of confidence in the vetting process used to establish the identity of the individual to whom the credential was issued.</p>
<ul>
<li>a) Authorization</li>
<li>b) Audit</li>
<li>c) Authentication</li>
<li>d) Assurance</li>
</ul>
<details>
<summary>Answer</summary>  d) Assurance

Source: Book p.68
</details>

<p>Question:
In the areas of Risk assurance levels are classified on a system of numbers 1 through 4. Pick the appropriate option which describes these risks accordingly:</p>
<ul>
<li>
<p>A.) Assurance Level of 1 tells us that users level is appropriate to access restricted services of very high value, Level 2 let's users access documents and services which are of a high a value but no the highest, Level 3 is where the secure authentication protocol is needed so we know who is accessing what, Level 4 there is little to no authentication at this level there is o confidence in the asserted identity's validity.</p>
</li>
<li>
<p>B.) Assurance Level 1-4 are all the same they all have some confidence in the asserted identity's validity. The main thing is that each level is based on the user's username for their organization.</p>
</li>
<li>
<p>C.) Level 1 typical authentication is a user supplied ID and there isn't much confidence in the users identity. Level 2 there is some confidence this is typically the level where an authentication protocol is devised for users, Level 3 is a high confidence but not the highest level at this level we have access to some sensitive documents and programs and at Level 4 you have the highest confidence and the highest access.</p>
</li>
<li>
<p>D.) None of the above</p>
</li>
</ul>
<details>
<summary>Answer</summary>  C

Page 68
</details>

<h2>Rootkits</h2>
<p>Question:
A <strong><em>_</em></strong>_ is a set of programs installed on a system to maintain covert access to that system with administrator or root privileges, while hiding evidence of its presence to the greatest extent possible</p>
<details>
<summary>Answer</summary>  Rootkit

Source: Book Page 212
</details>

<p>Question:
A rootkit can be classified into which of the following characteristics:</p>
<ul>
<li>A.) Persistent</li>
<li>B.) Memory Based</li>
<li>C.) User Mode</li>
<li>D.)Kernel Mode</li>
<li>E.) Virtual Machine based</li>
<li>F.) External Mode</li>
<li>G.) All of the above</li>
<li>H.) Detection</li>
</ul>
<details>
<summary>Answer</summary> G (H is not part of the answer)

Source: Book page 312
</details>

<p>Question:
A rootkit can be classified into <strong><em>_</em></strong> this is when the rootkit intercepts calls to APIs and modifies the returned results.</p>
<ul>
<li>A.) Memory based</li>
<li>B.) User Mode</li>
<li>C.) Kernel Mode</li>
<li>D.) External mode</li>
</ul>
<details>
<summary>Answer</summary>  User Mode

Source Book page 212
</details>

<p>Question:
What type of rootkit can not survive a reboot and why not?</p>
<ul>
<li>A.) Kernel Mode and because there is no user intervention</li>
<li>B.)Persistent and because the firewall flushes the rootkit out</li>
<li>C.) Memory based and there is no persistent code</li>
<li>D.) External Mode and because it is located in the BIOS</li>
</ul>
<details>
<summary>Answer</summary> C
Page 212: The book says "Memory based rootkits have no persistent code and therefore can not survive a reboot"
</details>
<hr />
<p>id: information-security-midterm-2-study-guide
title: Midterm 2 Study Guide
course: information-security
lecture: midterm-2-study-guide</p>
<hr />
<h1>Midterm 2 Study Guide</h1>
<h2>Chapter 7: Denial-of-Service Attacks</h2>
<p><strong>Multiple Choice</strong></p>
<p>SYN spoofing attack targets ___.</p>
<ul>
<li>A. Email service</li>
<li>B. TCP connections table</li>
<li>C. DNS service</li>
<li>D. None of the above</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Stallings, 4th Edition, Section 7.1, page 227
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is a <em>poison packet</em>?</p>
<ul>
<li>A. A packet that triggers a bug in the network software and makes it crash.</li>
<li>B. A packet that contains the signature of a virus.</li>
<li>C. A packet that infects other packets in the network buffer.</li>
<li>D. A packet that redirects other packets to a malicious target.</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Text pg 226
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is a <em>cyber slam</em>?</p>
<ul>
<li>A Cyber slam is a made up term.</li>
<li>B. Another name for a DDoS attack.</li>
<li>C. A firewall packet strategy that helps to thwart a DoS or DDoS attack.</li>
<li>D. A large number of queries that severely load a server.</li>
</ul>
<details>
<summary>Answer</summary>

D

**Source**

Text pg 226
</details>

<p><strong>Multiple Choice</strong></p>
<p>If an attacker directs a large number of forged requests to a server, what type of attack is being made?</p>
<ul>
<li>A. Slowloris</li>
<li>B. Source address spoofing</li>
<li>C. SYN spoofing</li>
<li>D Reflector</li>
<li>E Amplifier</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Text pg 230
</details>

<p><strong>True or False?</strong></p>
<p>ICMP flood attacks remain common because some ICMP packets are critical to normal network behavior and cannot be filtered.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 233
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is the difference between a TCP SYN flood attack and a SYN spoofing attack?</p>
<ul>
<li>A. There is no difference, they are synonymous.</li>
<li>B. The difference is in the volume of packets.</li>
<li>C. SYN spoofing works with UDP only.</li>
<li>D. TCP SYN flood attacks don't use spoofed source addresses.</li>
</ul>
<details>
<summary>Answer</summary>

B

TCP SYN flood attacks may or may not use spoofed addresses, but the difference is in the volume of packets sent, meant to overwhelm the server. The SYN spoofing attack is meant to overwhelm the server in sending SYN-ACK messages to spoofed (preferably not invalid) addresses.

**Source**

Text pg 231 and 234
</details>

<p><strong>Multiple Choice</strong></p>
<p>What type of attack is based on sending a large number of INVITE requests with spoofed IP addresses to a server?</p>
<ul>
<li>A. Reflection attack</li>
<li>B. Smurf attack</li>
<li>C. Slashdot attack</li>
<li>D. SIP flood attack</li>
</ul>
<details>
<summary>Answer</summary>

D

**Source**

Text pg 236, pg 241
</details>

<p><strong>True or False?</strong></p>
<p>The best defense against a reflection attack is to not allow directed broadcasts to be routed into a network.</p>
<details>
<summary>Answer</summary>

False

The description is the best defense for an Amplification attack. To defend against a reflection attack, filtering to block spoofed-source packets.

**Source**

Text pg 241, 242
</details>

<p><strong>True or False?</strong></p>
<p>A characteristic of reflection attacks is the lack of backscatter traffic.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 241

</details>

<p><strong>Multiple Choice</strong></p>
<p>What are some ways to prevent SYN spoofing attacks?</p>
<ul>
<li>A. Use SYN cookies</li>
<li>B. Modify the size of the TCP connections table or timeout period</li>
<li>C. Impose rate limits on network links</li>
<li>D. Use selective or random dropping of TCP table entries</li>
<li>E All of the above</li>
<li>F None of the above</li>
</ul>
<details>
<summary>Answer</summary>

E

**Source**

Text pg 246
</details>

<p><strong>True or False?</strong></p>
<p>Slowloris uses a ping flood via ICMP echo request packets.</p>
<details>
<summary>Answer</summary>

False

That is the _smurf_ attack. Slowloris exploits servers that use multiple threads by sending multiple incomplete connections (by not including the terminating newline sequence) to a server.

**Source**

Text pg 238, 242
</details>

<p><strong>True or False?</strong></p>
<p>In a TCP spoofing attack, attacker ideally wishes to use addresses that will not respond to the SYN-ACK with a RST.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 231
</details>

<p><strong>Multiple Choice</strong></p>
<p>A recursive HTTP flood attack is also known as what?</p>
<ul>
<li>A. a Fraggle attack</li>
<li>B. a Delayed Binding attack</li>
<li>C. a Spidering attack</li>
<li>D. a SIP flood</li>
</ul>
<details>
<summary>Answer</summary>

C

bots start from a given HTTP link and then follows all links on the provided website in a recursive way. This is also called spidering.

**Source**

Text pg 237
</details>

<h2>Chapter 9: Firewalls and Intrusion Prevention Systems</h2>
<p><strong>Multiple Choice</strong></p>
<p>When it comes to defense against attacks one of the most important principle is what?</p>
<ul>
<li>A.    Authorization</li>
<li>B.    Authentication</li>
<li>C.    Defense-in-depth</li>
<li>D.    Time</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Defense in Depth in lecture
</details>

<p><strong>Multiple Choice</strong></p>
<p>Firewalls are what type of mechanisms?</p>
<ul>
<li>A.    Prevention</li>
<li>B.    Botnet</li>
<li>C.    Attack</li>
<li>D.    None of the above</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Defense in depth lecture
</details>

<p><strong>True or False?</strong></p>
<p>The firewall will enforce different security restrictions on traffic.</p>
<details>
<summary>Answer</summary>

True

**Source**

What is a Firewall
</details>

<p><strong>Multiple Choice</strong></p>
<p>A _____ is a device that provide secure connectivity between networks</p>
<ul>
<li>A.    Enterprise intranet</li>
<li>B.    Trusted Users</li>
<li>C.    Firewall</li>
<li>D.    DMZ</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

What is a Firewall
</details>

<p><strong>Multiple Choice</strong></p>
<p>Firewalls as a prevention mechanism should be designed to enforce what?</p>
<ul>
<li>A.    User safety</li>
<li>B.    Security Policy</li>
<li>C.    Organizational Policy</li>
<li>D.    Public Key Infrastructure</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Firewall
</details>

<p><strong>True or False?</strong></p>
<p>All traffic from internal network to the internet and vice versa (external and out of the network) must pass through the firewall</p>
<details>
<summary>Answer</summary>

True

**Source**

Firewall
</details>

<p><strong>Multiple Choice</strong></p>
<p>The critical component of planning and implementation of a firewall is specifying a suitable ____ policy?</p>
<ul>
<li>A.    Security</li>
<li>B.    Access</li>
<li>C.    Network</li>
<li>D.    Directory</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Firewall Access Policy
</details>

<p><strong>Multiple Choice</strong></p>
<p>At a high level the types of traffic that are allowed through the access policy is what?</p>
<ul>
<li>A.    Address ranges (Machines, protocols, the applications and the contents)</li>
<li>B.    IPSec &amp; TLS</li>
<li>C.    Intranet</li>
<li>D.    Defense in depth</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Firewall Access Policy
</details>

<p><strong>True or False</strong></p>
<p>A policy should not be developed based on the security and risk assessment/organizations needs but how the CEO thinks it should be.</p>
<details>
<summary>Answer</summary>

False

It should be based on the whole organization

**Source**

Firewall Access Policy
</details>

<p><strong>True or False?</strong></p>
<p>Firewalls always provide protection 100% of the time.</p>
<details>
<summary>Answer</summary>

False

The firewall isn't 100% secure.

**Source**

(Firewall limitations)
</details>

<p><strong>True or False?</strong></p>
<p>Firewalls can log all traffic and can provide Network Address Translation.</p>
<details>
<summary>Answer</summary>

True

**Source**

Additional Convenient Firewall Features
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is firewall filtering?</p>
<ul>
<li>A.    Firewall filtering is when policies are defined for the firewall</li>
<li>B.    Firewalls authenticate users into the system</li>
<li>C.    Firewall filtering means the firewall decides whether to let the traffic through or not</li>
<li>D.    Firewall filtering means whether it will allow for a defense in depth strategy to protect the organizations digital assets.</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Firewalls and Filtering
</details>

<p><strong>True or False?</strong></p>
<p>Packet filtering at a very high level is essentially a policy that has a set of access control lists based on packet types.</p>
<details>
<summary>Answer</summary>

True

**Source**

Filtering types
</details>

<p><strong>Multiple Choice</strong></p>
<p>Session filtering is based on the context within a session. In order to do this a firewall maintains a session or connection and performs a <strong><em>_</em></strong>___.</p>
<ul>
<li>A.    Traffic Block</li>
<li>B.    Stateful inspection</li>
<li>C.    DMZ re route</li>
<li>D.    Virtual Switch</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Filtering types
</details>

<p><strong>True or False?</strong></p>
<p>In a packet filtering firewall decisions are made on a per packet basis and not other packets.</p>
<details>
<summary>Answer</summary>

True

**Source**

Packet filtering
</details>

<p><strong>True or False?</strong></p>
<p>The packet filtering firewall applies a list of rules to match the IP or TCP header of a packet and based on the rules match the firewall and then to decide to forward or discard the packet.</p>
<details>
<summary>Answer</summary>

True

**Source**

Packet Filtering Firewall

IP or TCP header information that a firewall can use to filter a packet:
- Source IP address (where the packets are coming from)
- Destinations IP address (this is the IP for the destination)
- Source and destination transport-level address (This defines the port number and applications such as smtp, http)
- IP Protocol field (this defines TCP , UDP or ICMP)
- Interface (this is with three or more ports with which interface the packet came or where it is going to.)
</details>

<p><strong>Multiple Choice</strong></p>
<p>What policies for packet filtering firewalls are used?</p>
<ul>
<li>A.Default Discard Policy</li>
<li>B. Default forward policy</li>
<li>C. Default Isolation Policy</li>
<li>D. Default write down policy</li>
<li>E. C &amp; B</li>
<li>F. A &amp; B</li>
</ul>
<details>
<summary>Answer</summary>

F

**Source**

Packet Filtering Firewall

When there is no rule that matches the packet it will be discarded this is safe procedure but also a hindrance to users who see that some traffic isn't allowed.

Forward policy is easier to use and manage and use but less secure it just lets all packets in.
</details>

<p><strong>Multiple Choice</strong></p>
<p>What are the weaknesses to packet filtering?</p>
<ul>
<li>A. Limited logging functionality</li>
<li>B. Vulnerable to attacks that take advantage of TCP/IP</li>
<li>C. Can't Prevent attacks that employ application specific vulnerabilities or functions</li>
<li>D.Packet filter firewalls are susceptible to security breaches if improperly configured.</li>
<li>E. All of the above</li>
</ul>
<details>
<summary>Answer</summary>

E

**Source**

Packet Filtering
</details>

<p><strong>Multiple Choice</strong></p>
<p>Packet Filtering Firewall Countermeasures are all of the following <strong>except</strong>?</p>
<ul>
<li>A. IP Address Spoofing</li>
<li>B. Source Routing Attacks</li>
<li>C. Tiny Fragment Attack</li>
<li>D. Stateful inspection Attack</li>
</ul>
<details>
<summary>Answer</summary>

D

**Source**

Packet filtering firewall countermeasures are A,B,C

IP Address Spoofing countermeasures: Discard packets with an inside source address if the packet arrives on an external interface

Source Routing Attacks: Discards all packets in which the source destinations specifies to the route

Tiny Fragment Attack: Enforcing a rule that the first fragment of a packet must contain a predefined minimum amount of the transport header.

In textbook

IP address spoofing: The intruder transmits packets from the outside with a source IP address field containing an address of an internal host. The attacker hopes that the use of a spoofed address will allow penetration of systems that employ simple source address security, in which packets from specific trusted internal hosts are accepted. The countermeasure is to discard packets with an inside source address if the packet arrives on an external interface. In fact, this countermeasure is often implemented at the router external to the firewall.

Source routing attacks: The source station specifies the route that a packet should take as it crosses the Internet, in the hopes that this will bypass security measures that do not analyze the source routing information. A countermeasure is to discard all packets that use this option.

Tiny fragment attacks: The intruder uses the IP fragmentation option to create extremely small fragments and force the TCP header information into a separate packet fragment. This attack is designed to circumvent filtering rules that depend on TCP header information. Typically, a packet filter will make a filtering decision on the first fragment of a packet. All subsequent fragments of that packet are filtered out solely on the basis that they are part of the packet whose first fragment was rejected. The attacker hopes the filtering firewall examines only the first fragment and the remaining fragments are passed through. A tiny fragment attack can be defeated by enforcing a rule that the first fragment of a packet must contain a predefined minimum amount of the transport header. If the first fragment is rejected, the filter can remember the packet and discard all subsequent fragments.
</details>

<p><strong>True or False?</strong></p>
<p>Firewalls can only be one single computer system.</p>
<details>
<summary>Answer</summary>

False

**Source**

Firewalls can be a set of two or more systems (Page 290)
</details>

<p><strong>Multiple Choice</strong></p>
<p>The goals of a firewall are all the following except which?</p>
<ul>
<li>A.    All traffic from inside to outside and vice versa must pass through the firewall. This is achieved by physically blocking all access to the local network except via the firewall.</li>
<li>B.    Only authorized traffic as defined by the local security policy will be allowed to pass.</li>
<li>C.    Only unauthorized users are defined by the local security policy and will be allowed to pass.</li>
<li>D.    The firewall is immune to penetration</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Page 290. It should also be noted that since the firewall itself is immune to penetration this implies the use of a hardened system with a secured operating system.
</details>

<p><strong>True or False?</strong></p>
<p>A major component in the planning and implementation of a firewall is specifying an access policy.</p>
<details>
<summary>Answer</summary>

True

**Source**

(True Page 290 This lists the types of traffic authorized to pass through the firewall, including address ranges, protocols, applications, and content types. This policy should be developed from the organization's information security risk assessment and policy)
</details>

<p><strong>Multiple Choice</strong></p>
<p>A firewall access policy would use which of the following to filter traffic?</p>
<ul>
<li>A.    IP Address and Protocol values</li>
<li>B.    Application Protocol</li>
<li>C.    User Identity</li>
<li>D.    Network Activity</li>
<li>E.    All of the Above</li>
</ul>
<details>
<summary>Answer</summary>

E

**Source**

Page 290-291
IP Address and Protocol Values-This controls access based on the source and destination IP address and port numbers, direction of flow (either inbound or outbound). This type of filtering is used with packet filter and stateful inspection firewall designs. This practice is used to limit access to a specific service.
Application Protocol- This controls access on the basis of authorized application protocol data. This type of filtering is used by application-level-gateway that relays and monitors the exchange of information for specific application protocols (for example SMTP, HTTP (email and web requests) for authorized users)
User Identity- Controls Access based on user identity typically for inside users who identity themselves use secure authentication such as IPSec
Network Activity- Controls the access based on: time or request such as only during businesss hours, rate of request etc.
</details>

<p><strong>Multiple Choice</strong></p>
<p>The following are all in the scope of a firewall except which?</p>
<ul>
<li>A.    Firewalls are a single choke point that attempts to keep unauthorized users out of the network, prohibit potential vulnerable services from entering or leaving the network and provide protection from various kinds of IP spoofing or routing attacks.</li>
<li>B.    Firewalls provide a location for monitoring security-related events</li>
<li>C.    Firewalls fully protect against internal threats which include disgruntled employee.</li>
<li>D.    Firewalls allow for several internet functions that are not security related also to happen such as Network Address Translators and Network management function.</li>
<li>E.    A firewall can serve as a platform for IPSec. Firewalls can be used to implement VPN's as well</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

this is a limitation of the firewall Page 291
A firewall defines a single choke point that attempts to keep unauthorized users out of the protected network, prohibit potentially vulnerable services from entering or leaving the network, and provide protection from various kinds of IP spoofing and routing attacks. The use of a single choke point simplifies security management because security capabilities are consolidated on a single system or set of systems.
A firewall provides a location for monitoring security-related events. Audits and alarms can be implemented on the firewall system.
A firewall is a convenient platform for several Internet functions that are not security related. These include a network address translator, which maps local addresses to Internet addresses, and a network management function that audits or logs Internet usage.
A firewall can serve as the platform for IPSec. Using the tunnel mode capability described in Chapter 22, the firewall can be used to implement virtual private networks.
Firewalls have their limitations, including the following:
The firewall cannot protect against attacks that bypass the firewall. Internal systems may have wired or mobile broadband capability to connect to an ISP. An internal LAN may have direct connections to peer organizations that bypass the firewall.
The firewall may not protect fully against internal threats, such as a disgruntled employee or an employee who unwittingly cooperates with an external attacker.
An improperly secured wireless LAN may be accessed from outside the organization. An internal firewall that separates portions of an enterprise network cannot guard against wireless communications between local systems on different sides of the internal firewall.
A laptop, PDA, or portable storage device may be used and infected outside the corporate network, then attached and used internally.
</details>

<p><strong>True or False?</strong></p>
<p>A web proxy is a form of application-level gateway.</p>
<details>
<summary>Answer</summary>

True

**Source**

Lecture, Application Level Gateway
</details>

<h2>Chapter 8: Intrusion Detection</h2>
<p><strong>Multiple Choice</strong></p>
<p>Intrusion is what?</p>
<ul>
<li>A. Any attack that aims to compromise the security goals of an Organization</li>
<li>B. Any attack that is hidden from a user</li>
<li>C. A form of detection which users are able to see everyone on the network</li>
<li>D. A form of encryption which allows end to end security.</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Intrusion Examples
</details>

<p><strong>True or False?</strong></p>
<p>Intrusion Detection systems are part of the defense in depth strategy</p>
<details>
<summary>Answer</summary>

True

**Source**

Intrusion Detection Systems (IDS)
</details>

<p><strong>Multiple Choice</strong></p>
<p>Defense in depth strategies should include the following <strong>except</strong> what?</p>
<ul>
<li>A. Encrypting sensitive information</li>
<li>B. Intrusion detection systems</li>
<li>C. Detailed audit trails</li>
<li>D. Strong authentication and authorization controls</li>
<li>E.  Zero day exploits</li>
<li>F. Actively management of operating systems</li>
<li>G. Application security</li>
</ul>
<details>
<summary>Answer</summary>

E

**Source**

Intrusion Detection systems
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is the correct order for how an attacker behaves during intrusion:</p>
<ul>
<li>
<p>A. Maintaining Access this is important because an attack may not be a onetime action they may install backdoors or other malicious software on a target system so they can continue to access.</p>
</li>
<li>
<p>B. Information Gathering System Exploit this is when an attacker has already gained sufficient privilege on a system and he or she can find out more about the network and the organization or even move to another target system to further exploit on the network.</p>
</li>
<li>
<p>C. Covering Tracks: This is when the user makes sure there is no evidence of them on the system this can be done by disabling or even editing the system audit logs to remove evidence of attack activities. Alternatively, the user can install a root kit to hide the installed malware.</p>
</li>
<li>
<p>D. Privilege Escalation this is taken after initial access ad the attacker will try to use a local exploit to escalate its privilege form from normal user to root on target system.</p>
</li>
<li>
<p>E. Initial Access this is accomplished by exploiting a remote network vulnerability.</p>
</li>
<li>
<p>F. Target acquisition and information gathering this is when the attacker identifies the target system using publicly available information both technical and non-technical and they also use network tools to analyze target resources.</p>
</li>
</ul>
<details>
<summary>Answer</summary>

The order for these values are:
F, E, D, B, A, C

**Source**

Intruder Behavior
</details>

<p><strong>True or False?</strong></p>
<p>The key design elements for an intrusion detection system is examining network and group activities</p>
<details>
<summary>Answer</summary>

False

The key design elements of an intrusion detection system is examining network and user activities

**Source**

Elements of Intrusion Detection
</details>

<p><strong>True or False?</strong></p>
<p>From an algorithmic perspective models capture intrusion evidence meanwhile features piece evidence together.</p>
<details>
<summary>Answer</summary>

False

From the Point of view of a detection algorithm we need to find out how to represent data from:
Features- capture intrusion evidences
Models  piece evidences together

**Source**

Elements of Intrusion Detection
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which of the components is not part of an Intrusion detection system?</p>
<ul>
<li>A. Data preprocessor</li>
<li>B. Detection Models</li>
<li>C. Detection Engines</li>
<li>D. Decision Table</li>
<li>E. Reporting and Analytics</li>
<li>F. Decision Engine</li>
</ul>
<details>
<summary>Answer</summary>

E

**Source**

Components of an IDS lecture
</details>

<p><strong>True or False?</strong></p>
<p>Anomaly detection tries to detect what is normal and is using machine learning meanwhile Signature detection uses a database to identify virus patterns.</p>
<details>
<summary>Answer</summary>

True

**Source**

Lectures
</details>

<p><strong>True or False?</strong></p>
<p>Another name for an intruder is a hacker or a cracker.</p>
<details>
<summary>Answer</summary>

True

**Source**

Lectures & PG 252
</details>

<p><strong>Multiple Choice</strong></p>
<p>An IDS is comprised of three logical components which of the following is not a component:</p>
<ul>
<li>A. Analyzers</li>
<li>B. User interface</li>
<li>C. Deep Learning</li>
<li>D. Sensors</li>
</ul>
<details>
<summary>Answer</summary>

C

Deep learning is not part of the IDS logical component the IDS is composed of the following
Sensors: Sensors are responsible for collecting data. The input for a sensor may be any part of a system that could contain evidence of an intrusion. Types of input to a sensor includes network packets, log files, and system call traces. Sensors collect and forward this information to the analyzer.

Analyzers: Analyzers receive input from one or more sensors or from other analyzers. The analyzer is responsible for determining if an intrusion has occurred. The output of this component is an indication that an intrusion has occurred. The output may include evidence supporting the conclusion that an intrusion occurred. The analyzer may provide guidance about what actions to take as a result of the intrusion. The sensor inputs may also be stored for future analysis and review in a storage or database component.

User interface: The user interface to an IDS enables a user to view output from the system or control the behavior of the system. In some systems, the user interface may equate to a manager, director, or console component.

**Source**

Page 256
</details>

<p><strong>Multiple Choice</strong></p>
<p>In an IDS system the sensors do what?</p>
<ul>
<li>A. Determine if an intrusion has occurred</li>
<li>B. Allow users to view the output of the system</li>
<li>C. Provide guidance about what actions to take when the intrusion occurs.</li>
<li>D. Collect and forward information to the analyzer</li>
</ul>
<details>
<summary>Answer</summary>

D

**Source**

PG 256
</details>

<p><strong>True or False?</strong></p>
<p>Analyzers are responsible for determining if an intrusion has occurred. The output of this component is an indication that an intrusion has occurred. But the output 100% of the time doesn't include evidence supporting the conclusion that an intrusion has occurred.</p>
<details>
<summary>Answer</summary>

False

The analyzer output may include evidence supporting the conclusion that an intrusion occurred. The analyzer may provide guidance about what actions to take as a result of the intrusion.

**Source**

Page 256
</details>

<p><strong>True or False?</strong></p>
<p>Intrusion Detection Systems are only allowed to use a single sensor.</p>
<details>
<summary>Answer</summary>

False

IDS can use multiple sensors across a range of host and network devices sending information to a centralized analyzer and user interface in a distributed architecture.

**Source**

Page 256
</details>

<p><strong>True or False?</strong></p>
<p>One of many intruder behaviors is Maintaining Access.  This is done by adding a machine code backdoor that is hard to detect.  Detection is difficult because the backdoor modifies machine level code.</p>
<details>
<summary>Answer</summary>

True

**Source**

Lecture notes
Object Code Backdoors- This backdoor is hard to detect because it modifies machine code.
</details>

<p><strong>Multiple Choice</strong></p>
<p>Match the appropriate Intrusion Detection classification to its correct value
- I. Monitors characteristics of a single host and the events occurring within the host
- II.Monitors Network Traffic for particular network segments or devices
- III. Combines information from multiple sensors often both host and network based and dumps the information into a central analyzer</p>
<ul>
<li>A. Distributed or Hybrid IDS is III,  Network-based IDS is I and Host based IDS is II</li>
<li>B. Network-based IDS is II, Host-Based IDS is I and Distributed IDS is III</li>
<li>C. Host-Based IDS is III, Network based IDS is I and Host based IDS is I</li>
<li>D. There are no other IDS architectures just one Host-Based IDS</li>
</ul>
<details>
<summary>Answer</summary>

B

Host-based IDS (HIDS): Monitors the characteristics of a single host and the events occurring within that host, such as process identifiers and the system calls they make, for evidence of suspicious activity.

Network-based IDS (NIDS): Monitors network traffic for particular network segments or devices and analyzes network, transport, and application protocols to identify suspicious activity.

Distributed or hybrid IDS: Combines information from a number of sensors, often both host and network-based, in a central analyzer that is able to better identify and respond to intrusion activity.

**Source**

Page 257
</details>

<p><strong>True or False?</strong></p>
<p>In the context of IDS systems a false negative is when a authorized user is identified as an intruder and a false positive is identified where intruders are not identified as intruders.</p>
<details>
<summary>Answer</summary>

False

**Source**

> Thus, a loose interpretation of intruder behavior, which will catch more intruders, will also lead to a number of false positives, or false alarms, where authorized users are identified as intruders. On the other hand, an attempt to limit false positives by a tight interpretation of intruder behavior will lead to an increase in false negatives, or intruders not identified as intruders. Thus, there is an element of compromise and art in the practice of intrusion detection.

Page 257
</details>

<p><strong>True or False?</strong></p>
<p>The base-rate fallacy of IDS states that if the numbers of intrusions are low compared to the number of legitimate uses of a system then the false alarm rate will be high unless the test is extremely discriminating</p>
<details>
<summary>Answer</summary>

True

**Source**

Page 258
</details>

<p><strong>Multiple Choice</strong></p>
<p>Anomaly detection involves the collection of data relating to a behavior over a period of time. Then once the data is collected the data is analyzed to determine whether or not the behavior is legitimate or not. An issue with Anomaly detection can be what?</p>
<ul>
<li>A. High false positive rate</li>
<li>B. High False negative rate</li>
<li>C. Both High false positive and negative rates</li>
<li>D. Low false positive rate</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Lecture Notes & Pg 259
</details>

<p><strong>True or False?</strong></p>
<p>Signature or Heuristic detection uses a set of pre-defined malicious data patterns or attack rules that are compared with current behavior to decide if it is that of an intruder.</p>
<details>
<summary>Answer</summary>

True

This statement above is correct and this approach can only identify known attacks for which is has patterns or rules

**Source**

Pg 259
</details>

<p><strong>Multiple Choice</strong></p>
<p>The disadvantages of locating a honeypot in an internal network are:</p>
<ul>
<li>a) It has little or no ability to trap internal attackers and it cannot detect a misconfigured firewall.</li>
<li>b) If it is compromised, it can attack other internal systems and its location requires the outer firewall to permit traffic through its filters.</li>
<li>c) It puts more load on the external firewall and on the resources of the internal system.</li>
<li>d) It leads to honey files, which are malicous byproducts of the prolonged use of the honeypot.</li>
<li>e) It leads to a honey do list, which can ruin a Saturday.</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 279
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which of the following is not listed as a desired quality of an IDS?</p>
<ul>
<li>A. Be able to scale to monitor a large number of hosts.</li>
<li>B. Be able to monitor itself and detect if it has been modified by an attacker.</li>
<li>C. Be able to be configured to the policies of the system it is monitoring.</li>
<li>D. Impose a minimal overhead on the system.</li>
<li>E. Be able to recover from crashes and reinitializations.</li>
<li>F. Require static configuration, so changes in configuration require a system restart.</li>
<li>G. Be able to adapt to changes in system and user behavior over time.</li>
<li>H. Provide graceful degradation of service in the event that some components of the IDS stop working.</li>
</ul>
<details>
<summary>Answer</summary>

F

The IDS should allow dynamic reconfiguration -- the ability to reconfigure the IDS without restarting it.

**Source**

Text pg 258
</details>

<p><strong>True or False?</strong></p>
<p>The SNORT system is a signature-based NIDS.</p>
<details>
<summary>Answer</summary>

False

The SNORT system is a rule-based NIDS. A large collection of rules exist for it to detect a wide variety of network attacks.

**Source**

Text pg 261
</details>

<p><strong>True or False?</strong></p>
<p>A key limitation of anomaly detection approaches used by many IDS's is that they are generally only trained with legitimate data.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 261
</details>

<p><strong>Multiple Choice</strong></p>
<p>The advantages of <strong><em>_</em></strong><strong><em>_</em></strong>____ anomaly detection include relative simplicity and low computation cost, and lack of assumptions about behavior expected. Disadvantages include difficulty in selecting suitable metrics, and that all behaviors can't be modeled using this approach.</p>
<ul>
<li>A. Statistical</li>
<li>B. Knowledge based</li>
<li>C. Machine-learning</li>
<li>D. Heuristic</li>
<li>E. Signature</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Text pg 259
</details>

<p><strong>Multiple Choice</strong></p>
<p>A key disadvantage of <strong><em>_</em></strong><strong><em>_</em></strong>_ anomaly detection is the significant time and computational resources needed.</p>
<ul>
<li>A. Statistical</li>
<li>B. Knowledge based</li>
<li>C. Machine-learning</li>
<li>D. Heuristic</li>
<li>E. Signature</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Text pg 259
</details>

<p><strong>Multiple Choice</strong></p>
<p>The advantages of <strong><em>_</em></strong><strong><em>_</em></strong> approaches include their robustness and flexibility. A disadvantage is the difficulty and time required and the need for expert assistance.</p>
<ul>
<li>A. Statistical</li>
<li>B. Knowledge based</li>
<li>C. Machine-learning</li>
<li>D. Heuristic</li>
<li>E. Signature</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

pg 259
</details>

<p><strong>True or False?</strong></p>
<p>Signature detection would be suitable to detect buffer overflows, password guessing, or malware transmission attacks.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 271
</details>

<p><strong>True or False?</strong></p>
<p>Anomaly detection would be suitable to detect policy violation attacks.</p>
<details>
<summary>Answer</summary>

False

Signature detection is better suited.

**Source**

Text pg 271
</details>

<p><strong>True or False?</strong></p>
<p>Signature detection would be suitable to worm attacks.</p>
<details>
<summary>Answer</summary>

False

Anomaly detection is better suited.

**Source**

Text pg 271
</details>

<h2>Chapter 2: Cryptographic Tools</h2>
<p><strong>True or False?</strong></p>
<p>Symmetric Encryption relies on a public and private key meanwhile asymmetric encryption relies on a shared key between two parties</p>
<details>
<summary>Answer</summary>

False

**Source**

Lectures
</details>

<p><strong>Multiple Choice</strong></p>
<p>There are two schemes to attack a symmetric encryption scheme. What are they?</p>
<ul>
<li>A. Cryptanalysis &amp; Brute-Force attacks</li>
<li>B. Cryptanalysis &amp; DDoS</li>
<li>C. Brute-force attack and CipherText</li>
<li>D. Cryptanalysis &amp; Caesar</li>
</ul>
<details>
<summary>Answer</summary>

A

There are two general approaches to attacking a symmetric encryption scheme. The first attack is known as cryptanalysis. Cryptanalytic attacks rely on the nature of the algorithm plus perhaps some knowledge of the general characteristics of the plaintext, or even some sample plaintext-ciphertext pairs. This type of attack exploits the characteristics of the algorithm to attempt to deduce a specific plaintext or to deduce the key being used. If the attack succeeds in deducing the key, the effect is catastrophic: All future and past messages encrypted with that key are compromised.

The second method, known as the brute-force attack, is to try every possible key on a piece of ciphertext until an intelligible translation into plaintext is obtained.

**Source**

Page 32
</details>

<p><strong>True or False?</strong></p>
<p>The most commonly used asymmetric encryption are block ciphers. They are DES, Triple DES and AES.</p>
<details>
<summary>Answer</summary>

False

These are symmetric encryption algorithms.

**Source**

Page 33
</details>

<p><strong>Multiple Choice</strong></p>
<p>The two categories of concern about DES fall into two categories. What are they?</p>
<ul>
<li>A. 128 bit encryption and the algorithm itself (i.e. its cryptanalysis)</li>
<li>B. The Key length of 56 bits and 256 bit encryption</li>
<li>C. The key length of 56 bits and the cryptanalysis of the algorithm</li>
<li>D. All of the above</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Page 33

</details>

<p><strong>True or False?</strong></p>
<p>The main reason most companies go with 3DES is because the algorithm is relatively faster in software compared to normal DES and AES</p>
<details>
<summary>Answer</summary>

False

The principal drawback of 3DES is that the algorithm is relatively sluggish in software.

**Source**

Pg 35

</details>

<p><strong>Multiple Choice</strong></p>
<p>If Alice wants to send verification of her identity, she can send a message encrypted with her <strong><em>_</em></strong><strong><em>_</em></strong>__ and anyone with her <strong><em>_</em></strong><strong><em>_</em></strong> can verify that it was from her.</p>
<ul>
<li>A. secret key, secret key</li>
<li>B. public key, private key</li>
<li>C. hash function, private key</li>
<li>D. private key, public key</li>
</ul>
<details>
<summary>Answer</summary>

D

Alice can send a message using her private key, and anyone knowing her public key can verify that.

**Source**

P2_L5 Notes, page 10
</details>

<p><strong>True or False?</strong></p>
<p>If you want to achieve the highest level of privacy and reliability, it is often best to use a new or unpublished encryption algorithm.</p>
<details>
<summary>Answer</summary>

False

It practice, we should always use the widely known and deployed algorithms and standards.

**Source**

P2_L5 Notes, pg 9
</details>

<p><strong>True or False?</strong></p>
<p>A digital envelope is a technique for attaching a one-time key that encrypts a message to the receiver's public key.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 55
</details>

<p><strong>True or False?</strong></p>
<p>The primary advantage of a block cipher is that block ciphers are almost always faster and use far less code than do stream ciphers.</p>
<details>
<summary>Answer</summary>

False

**Source**

Text pg 35
</details>

<p><strong> Multiple Choice </strong></p>
<p>All but one of the following situations are examples were Message Authentication confidentiality would not be preferable. Select that situation.</p>
<ul>
<li>A. When a message or notification is broadcast to many different users.</li>
<li>B. When the receiver is expecting a message from the sender, or when both the user and sender have the same access privileges.</li>
<li>C. When the system for either the sender or recipient are heavily loaded and cannot afford the time to encrypt.</li>
<li>D. When authenticating a computer program, allowing it to execute without having to perform a decryption each time.</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 37
</details>

<p><strong> Multiple Choice </strong> </p>
<p>Which of the following is not a characteristic that is sought in random (or pseudo random) numbers used in cryptography?</p>
<ul>
<li>A. The overall distribution of numbers is normal or approximately normal.</li>
<li>B. Values are statistically independent of one another.</li>
<li>C. The sequence is unpredictable.</li>
</ul>
<details>
<summary>Answer</summary>

A

The values should be _uniformly distributed_.

**Source**

Text pg 55
</details>

<p><strong>True or False?</strong></p>
<p>It is possible to for a computer chip to use software to generate true random numbers.</p>
<details>
<summary>Answer</summary>

True

The Intel DRNG, offered on multi-core chips since 2012, uses thermal noise within the silicon to output a random stream of bits.

**Source**

Text pg 56 and https://software.intel.com/en-us/articles/intel-digital-random-number-generator-drng-software-implementation-guide

</details>

<p><strong>True or False?</strong></p>
<p>So called <em>data at rest</em> is often not encrypted, but it should be encrypted.</p>
<details>
<summary>Answer</summary>

 True

**Source**

Text pg 57
</details>

<p><strong>Multiple Choice</strong></p>
<p>Under which of the following situations would Message Authentication confidentiality NOT be preferable?</p>
<ul>
<li>A. Encryption software is slow.</li>
<li>B. Hash functions are irreversible</li>
<li>C. Encryption hardware is not inexpensive.</li>
<li>D. Encryption hardware is geared toward larger data sizes.</li>
<li>E. Encryption algorithms may be patent protected.</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 41
</details>

<p><strong>Multiple Choice</strong></p>
<p>What are some uses of hash functions?</p>
<ul>
<li>I. Message encryption</li>
<li>II. Message authentication</li>
<li>III. Creating Digital Signatures</li>
<li>IV. Password encapsulation</li>
<li>
<p>V. Intrusion detection</p>
</li>
<li>
<p>A. I, II, and III</p>
</li>
<li>B. All of the choices</li>
<li>C. I, III, and V</li>
<li>D. II, IV, and V</li>
<li>E. All except I.</li>
<li>F. All except IV.</li>
</ul>
<details>
<summary>Answer</summary>

E

**Source**

Text pg 44
</details>

<h2>Chapter 20: Symmetric Encryption and Message Confidentiality</h2>
<p><strong>True or False?</strong></p>
<p>A symmetric cipher is characterized by ciphertext that is the same size as the original plaintext.</p>
<details>
<summary>Answer</summary>

False

It can be characterized by the use of a shared secret key.

**Source**

Text pg 31 (Chapter 2)
</details>

<p><strong>True or False?</strong></p>
<p>For applications such as file transfer, email, and database, a stream cipher may be more appropriate.</p>
<details>
<summary>Answer</summary>

False

A block cipher may be more appropriate for applications that deal with large blocks of data. Stream ciphers may be more appropriate for data in web browsers or data communications channels.

**Source**

Text pg 620
</details>

<p><strong>True or False?</strong></p>
<p>A number of attacks against RC4 have been published, but if a large enough key is used, none of those attacks are practical.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 622
</details>

<p><strong>True or False?</strong></p>
<p>RC4 is a very fast and simple to explain, and it allows for variable key lengths.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 620
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which of the following is <em>not</em> among the ways two users can arrange to exchange keys?</p>
<ul>
<li>A. If the two parties have recently used a key, they can transmit the old key, using the new key to encrypt.</li>
<li>B. A third party could physically deliver the key to the second party.</li>
<li>C. If the two parties have an encrypted connection to a third party, the third party can deliver the key.</li>
<li>D. None of the above answers are correct.</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Text pg 628
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which of the following defines a <em>Session Key</em>?</p>
<ul>
<li>A. A key used between entities for the purpose of distributing keys.</li>
<li>B. A one-time key used to communicate between two end systems.</li>
<li>C. The authority that determines which systems are allowed to communicate with each other.</li>
<li>D. A shared key that is used in Asymmetric encryption standards such as RSA.</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 628
</details>

<p><strong>Multiple Choice</strong></p>
<p>How can 3DES be used to decrypt DES encrypted ciphertext?</p>
<ul>
<li>A. By setting Key1 = Key2 and Key3 = Key_DES</li>
<li>B. By setting Key1 = Key2 = Key3 = Key_DES</li>
<li>C. By setting Key3 = Key_DES</li>
<li>D. By setting Key1 = Key3 and Key2 = Key_DES.</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 612,  P2_L6 Notes pg 8
</details>

<p><strong>Multiple Choice</strong></p>
<p>In a public-key system using RSA, you intercept the ciphertext C=10 sent to a user whose public key is e=5, n=35. What is the plaintext M (as an integer)?</p>
<ul>
<li>A. 50</li>
<li>B  25</li>
<li>C. 17</li>
<li>D. 30</li>
<li>E. 5</li>
</ul>
<details>
<summary>Answer</summary>

B

n=35, so p = 7 and q = 5, so phi(n) = 6x4 = 24, so d = e^-1 mod phi(n) = 5, since 5x5 = 25 = 1 mod 24, M = C^d (mod N) = 10^5 mod 35 = 5

**Source**

Text pg 658, problem 21.8
</details>

<p><strong>Multiple Choice</strong></p>
<p>Consider a Diffie-Hellman scheme with a common prime q=11 and a primitive root $\alpha$=2. If user A has public key YA=9, what is A's private key XA?</p>
<ul>
<li>A. 6</li>
<li>B. 4</li>
<li>C. 10</li>
<li>D. 5</li>
<li>E. 2</li>
</ul>
<details>
<summary>Answer</summary>

A

YA = 2^x mod 11 = 9, by inspection, 2^6 = 64 mod 11 = 9, so x = 6 = private key

**Source**

Text pg 653 and pg 658 problem 21.12
</details>

<p><strong>True or False?</strong></p>
<p>The structure and functions used in SHA-1 and SHA-2 are substantially different from those used in SHA-3.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 639
</details>

<p><strong>Multiple Choice</strong></p>
<p>The CTR cipher block mode <em>does not</em> have which of the following advantages listed, according to the text?</p>
<ul>
<li>A. Simplicity</li>
<li>B. Preprocessing capability</li>
<li>C. Software efficiency</li>
<li>D. Hardware efficiency</li>
<li>E. Scalability</li>
<li>F. Random Access capability</li>
<li>G. Provable Security</li>
</ul>
<details>
<summary>Answer</summary>

E

**Source**

Text pg 627
</details>

<p><strong>True or False?</strong></p>
<p>It is possible to convert any block cipher into a stream cipher.</p>
<details>
<summary>Answer</summary>

True

Using the Cipher Feedback Mode

**Source**

Text pg 625
</details>

<h2>Chapter 21: Public Key Cryptography and Message Authentication</h2>
<p><strong>True or False?</strong></p>
<p>AES is a Feistel cipher.</p>
<details>
<summary>Answer</summary>

False

**Source**

https://www.tutorialspoint.com/cryptography/advanced_encryption_standard.htm
</details>

<p><strong>True or False?</strong></p>
<p>The primary advantage of a block cipher is that block ciphers are almost always faster than stream ciphers.</p>
<details>
<summary>Answer</summary>

False

**Source**

Text pg 35
</details>

<p><strong> Multiple Choice </strong></p>
<p>What is the main reason 3DES uses an encrypt-decrypt-encrypt sequence?</p>
<ul>
<li>A. It makes it more difficult to crytanalyze by eavesdroppers.</li>
<li>B. It is faster than encrypt-encrypt-encrypt would be.</li>
<li>C. It can decrypt DES encrypted messages.</li>
<li>D It is easier to use with cipher block chaining.</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Text pg 611
</details>

<p><strong> Multiple Choice </strong></p>
<p>Which of the following is not a mode of operation used in Cipher blocks?</p>
<ul>
<li>A. Random Bit Optimization</li>
<li>B. Electronic Code Book</li>
<li>C. Cipher Feedback</li>
<li>D. Output Feedback</li>
<li>E. Counter</li>
</ul>
<details>
<summary>Answer</summary>

A

**source**

Text pg 622
</details>

<p><strong> Multiple Choice </strong></p>
<p>Which of the following is the weakest form of attack?</p>
<ul>
<li>A. Chosen Plaintext</li>
<li>B. Chosen Ciphertext</li>
<li>C  Known Plaintext</li>
<li>D  Ciphertext Only</li>
<li>E. Chosen Text</li>
</ul>
<details>
<summary>Answer</summary>

D

**Source**

https://notes.shichao.io/cnspp/ch2/
</details>

<p><strong> Multiple Choice </strong></p>
<p>What is RC4?</p>
<ul>
<li>A. A stream cipher.</li>
<li>B. A symmetric block cipher</li>
<li>C An asymmetric block cipher.</li>
<li>D. A set of standards used in Internet encryption.</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Text pg 619
</details>

<p><strong>True or False?</strong></p>
<p>CTR mode is used for timing, for example, to ensure that encrypted streams remain in sync with one another.</p>
<details>
<summary>Answer</summary>

False

**Source**

Text pg 627
</details>

<p><strong> Multiple Choice </strong></p>
<p>What operation does the Diffie-Hellman algorithm use as a one way function?</p>
<ul>
<li>A. Discrete exponentiation</li>
<li>B. Elliptical Key Cryptography.</li>
<li>C. Discrete logarithms</li>
<li>D. Hashing functions.</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Text pg 653
</details>

<p><strong>Multiple Choice (True or False?)</strong></p>
<p>OCB offers Authenticated Encryption (T/F?).
It used 3DES to encrypt messages. (T/F?)
Its structure is similar to ECB mode, which makes it vulnerable to repeated messages. (T/F?)
It uses the same key for authentication and encryption. (T/F?)</p>
<ul>
<li>A. True, True, True, True</li>
<li>B. True, False, True, False</li>
<li>C. False, False, False, False</li>
<li>D. True, False, False, True</li>
<li>E. False, False, False, True</li>
<li>F. True, True, False, False</li>
<li>G. None of these are choices are correct.</li>
</ul>
<details>
<summary>Answer</summary>

G

T, F, (it uses AES) F (while it's structure is similar to ECB, it uses an offset xor'ed with PT in each block), T

**Source**

Text pg 646
</details>

<p><strong>True of False?</strong></p>
<p>The MD5 hash function, despite being susceptible to the birthday attack, is suitable for HMAC.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 643
</details>

<p><strong>True of False?</strong></p>
<p>RSA can be used for both encryption and key exchange, but DSS cannot.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 656
</details>

<p><strong>True or False?</strong></p>
<p>If someone finds an efficient way to factor large integers, then AES will be obsolete.</p>
<details>
<summary>Answer</summary>

False

**Source**

P2_L6 Notes, pg 20
</details>

<p><strong>True or False?</strong></p>
<p>The Certification Authority is responsible for generating the public keys.</p>
<details>
<summary>Answer</summary>

False

**Source**

https://www.youtube.com/watch?v=JAgaWJivKwg (about 3:55)
</details>

<p><strong>Multiple Choice</strong></p>
<p>HMAC treats the SHA function as a black box. What benefits does this have?</p>
<ul>
<li>I. The hash algorithm used in HMAC is hidden from hackers.</li>
<li>II. It is easy to replace the given hash function.</li>
<li>
<p>III. HMAC code can be prepackaged and ready to use without modification.</p>
</li>
<li>
<p>A. I and II</p>
</li>
<li>B. I and III</li>
<li>C. II and III</li>
<li>D. I, II, and III</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Text pg 641
</details>

<p><strong>True of False?</strong></p>
<p>Using the Pigeonhole Principle, given that a hash can take an input of any size and output a value of fixed size, then it should have collisions.</p>
<details>
<summary>Answer</summary>

True

**Source**

Notes: P2_L8  - Hashes, pg 5
</details>

<p><strong>True or False?</strong></p>
<p>The Pigeonhole Principle can be used as a counterexample to the Collision Resistance property of hashes.</p>
<details>
<summary>Answer</summary>

False

While the Pigeonhole Principle says there exist collisions, the collision resistance property says that it is computationally infeasible to find them. So even though collisions exist, they are hard to find, thus keeping the collision resistance property of hashes intact.

**Source**

Notes P2_L8 - Hashes pg 5
</details>

<p><strong>Multiple Choice</strong></p>
<p>From the birthday "paradox", if the length of the hash is <em>x</em> bits, then a hacker would have to search 2^(x/2) messages in order to find a collision. In doing so, what is the probability, approximately, that the hacker will find a collision?</p>
<ul>
<li>A. nearly 100%</li>
<li>B. about 75%</li>
<li>C. about 66%</li>
<li>D. about 50%</li>
<li>E.  about 25%</li>
<li>F. less than 25%</li>
</ul>
<details>
<summary>Answer</summary>

D

The approximate 2^(n/2) = sqrt(2^n) gives the probability of about 50% that the hacker will find at least 1 match.

So it's misleading to say that the hacker would have to search 2^(n/2) messages to "find a match". This would only give the hacker better than 50% chance of finding it without some more strategic choices.

**Source**

Notes P2_L8 - Hashes pg 4
</details>

<p><strong>True or False?</strong></p>
<p>SHA-1 allows message sizes as large as 2 terabytes.</p>
<details>
<summary>Answer</summary>

True

That's quite an understatement, though. SHA-1 holds messages up to 2^64 bits, which is a (2^21)*(2^43), , so the answer is more like up to a _2 million terabytes_. And SHA-384 and SHA-512 accept messages of that size _squared!_ (2^128)

**Source**

Notes P2_L8 - Hashes pg 7
</details>

<p><strong>True or False?</strong></p>
<p>A truly ideal hash function should be nondeterministic.</p>
<details>
<summary>Answer</summary>

False

You want to be able to always get the same hash for a given input, hence, it must be deterministic.

**Source**

https://en.wikipedia.org/wiki/Cryptographic_hash_function
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is the main advantage of ECC compared to RSA?</p>
<ul>
<li>A. Its technique is not as difficult to explain.</li>
<li>B. Hackers have not shown interest in it.</li>
<li>C. Its theory has been around for a long time.</li>
<li>D. It offers equal security with smaller key size.</li>
</ul>
<details>
<summary>Answer</summary>

D

(A and B are the _opposite_ of being true, and C is a true statement, but it's not relevant here.

**Source**

Text pg 656
</details>

<p><strong>True or False?</strong></p>
<p>Diffie-Hellman Key Exchange is, on its own, completely vulnerable to a man in the middle attack.</p>
<details>
<summary>Answer</summary>

True

It is vulnerable because it does not _authenticate_ the participants.

**Source**

Text pg 656
</details>

<p><strong>True or False?</strong></p>
<p>In attacks on RSA, it has been demonstrated that if the public key <em>d</em> is less than <em>n</em> and the private key <em>d</em> is less than the fourth root of n, then <em>d</em> can be "easily determined".</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg  650
</details>

<p><strong>True or False?</strong></p>
<p>According to the text, the largest product of primes that has been factored to date was over 200 decimal digits long.</p>
<details>
<summary>Answer</summary>

True

In fact, it was 232 digits long, and that was done in late 2009.

**Source**

Text pg 650
</details>

<p><strong>Multiple Choice</strong></p>
<p>Name all simple countermeasures for a timing attack:</p>
<ul>
<li>I. Ensure all exponentiations take the same amount of time before returning results</li>
<li>II. Ensure true random numbers, and not pseudo random numbers, are used.</li>
<li>III. Add a random delay to the exponentiation algorithm.</li>
<li>IV. Ensure that all operations are optimized.</li>
<li>
<p>V. Multiply the ciphertext by a random number before performing exponentiation.</p>
</li>
<li>
<p>A. All choices: I, II, III, IV, and V.</p>
</li>
<li>B. I, III, and V.</li>
<li>C. II and IV.</li>
<li>D. I, II, III, and IV.</li>
<li>E. II, III, IV, and V.</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 652
</details>

<p><strong>True or False?</strong></p>
<p>Blinding, or multiplying ciphertext by a random number before performing exponentiation during RSA encryption, incurs a 2 to 10% performance penalty.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 652
</details>

<p><strong>Multiple Choice</strong></p>
<p>All hash functions operate using these two principles: (select two)</p>
<ul>
<li>I. The size of the input is greater than the size of the output</li>
<li>II. The input is viewed as a sequence of n-bit blocks.</li>
<li>III. The input value is "randomized" to overcome regularities.</li>
<li>IV. Ciphertext does not change when blocks are permuted.</li>
<li>
<p>V. Input is processed one block at a time in an iterative fashion.</p>
</li>
<li>
<p>A. I and II</p>
</li>
<li>B. I and III</li>
<li>C. II and III</li>
<li>D. II and V</li>
<li>E. III and IV</li>
<li>F. III and V</li>
</ul>
<details>
<summary>Answer</summary>

D

**Source**

Text pg 635
</details>

<p><strong>True or False?</strong></p>
<p>SHA-512 is more efficient than SHA-256 on many 64-bit systems.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 637
</details>

<p><strong>True or False?</strong></p>
<p>SHA-512 makes use of constants derived from the first 64 bits of fractional parts of cube roots of the first 80 (one for each round) prime numbers.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 639
</details>

<p><strong>Multiple Choice</strong></p>
<p>A longitudinal redundancy check is reasonably effective for random data as a data integrity check. It uses which bitwise function?</p>
<ul>
<li>A. XOR</li>
<li>B. MOD</li>
<li>C. NOT</li>
<li>D. LOG</li>
<li>E. EXP</li>
<li>F. OR</li>
<li>G. AND</li>
<li>H. Circular Shift</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Text pg 635

</details>

<h2>Chapter 23: Internet Authentication Applications</h2>
<p><strong>Multiple Choice</strong></p>
<p>What are the principal elements of a Kerberos system?</p>
<ul>
<li>I. AS</li>
<li>II. TGT</li>
<li>
<p>III. TGS</p>
</li>
<li>
<p>A. I, II, and III</p>
</li>
<li>B. I and II only</li>
<li>C. I and III only</li>
<li>D. II and III only</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Text pg 685 (see image)
</details>

<p><strong>Multiple Choice</strong></p>
<p>What of the following are steps Kerberos uses to ensure security and authentication?</p>
<ul>
<li>A. It includes a timestamp to prevent replay attacks.</li>
<li>B. It sets a lifetime on TGTs.</li>
<li>C. It uses short-lived authenticators encrypted with session keys.</li>
<li>D. It encrypts the TGT with the server key to prevent alteration.</li>
<li>E. All of the above</li>
<li>F. Duh</li>
</ul>
<details>
<summary>Answer</summary>

E

**Source**

Text pg 686 and https://www.youtube.com/watch?v=2WqZSZ5t0qk
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is an authenticator, as used by Kerberos?</p>
<ul>
<li>A. A software application that verifies a user's identity.</li>
<li>B. An encrypted message which contains the ID, the address of the user, and a timestamp.</li>
<li>C. An application that creates a one-time password that authenticates a user.</li>
<li>D. A server which contains the IP, user ID, and user password, used for authentication.</li>
<li>E. None of the above.</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 686

</details>

<p><strong>True of False?</strong></p>
<p>The Authentication Server holds a copy of symmetric keys for all clients and servers.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 686
</details>

<p><strong>True of False?</strong></p>
<p>The TGT includes a key ("ticket") that gives the client access to the requested service.</p>
<details>
<summary>Answer</summary>

False

**Source**

Text pg 686
</details>

<p><strong>True or False?</strong></p>
<p>The user cannot read the TGT, she only passes it forward along with other information, to the TGS.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg (you guessed it) 686
</details>

<p><strong>Multiple Choice</strong></p>
<p>The set of keys and and user ID's / passwords in a Kerberos network (i.e., a full-service Kerberos environment consisting of a Kerberos server, a number of clients, and a number of application servers) are known as <strong><em>_</em></strong><strong><em>_</em></strong>.</p>
<ul>
<li>A. a realm.</li>
<li>B. a session.</li>
<li>C. a dictionary.</li>
<li>D. an organization</li>
<li>E. a Kerberos policy.</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Text pg 688
</details>

<p><strong>True or False?</strong></p>
<p>PKI is defined as the set of hardware, software, people, policies, and procedures needed to create, manage, store, distribute, and revoke digital certificates based on symmetric cryptography.</p>
<details>
<summary>Answer</summary>

False

Change _symmetric_ to _asymmetric_, and it's true!

**Source**

Text pg 694
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which of the following is <em>not</em> a long-known problem with the X-509 PKI model?</p>
<ul>
<li>A. There is not a standardized set of trust stores used by all browsers and operating systems.</li>
<li>B. The user is sometimes relied upon to make an informed decision regarding certificate trust.</li>
<li>C. All CA's in the trust store are assumed to be equally trusted, well managed, and applying equal policies.</li>
<li>D. The trust certificates shared in the trust store are not encrypted.</li>
</ul>
<details>
<summary>Answer</summary>

D

**Source**

Text pg 694
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is a trust store?</p>
<ul>
<li>A. A database of IP addresses of known trusted servers.</li>
<li>B. A list of CA's and their public keys.</li>
<li>C. A CA that issues authentication certificates.</li>
<li>D. A single internationally specified hierarchy of government regulated CAs.</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 694
</details>

<p><strong>True or False?</strong></p>
<p>Kerberos provides <em>both</em> authentication <em>and</em> access control.</p>
<details>
<summary>Answer</summary>

True

**Source**

Notes P2_L9 Security Protocols, pg 15
</details>

<p><strong>True or False?</strong></p>
<p>The authenticator is a program that checks the user's TGT versus the value on file.</p>
<details>
<summary>Answer</summary>

False

The authenticator checks the user's identifying information and time stamp using the session key.

**Source**

P2_L9 - Security Protocols, pg 14
</details>

<p><strong>Multiple Choice</strong></p>
<p>How does Trudy, the (wo)man in the middle, initiate a mutual authentication reflection attack between two users, Bob and Alice?</p>
<ul>
<li>A. She tricks Bob into sharing Alice's public key with her.</li>
<li>B. She tricks Bob into solving a challenge response from Alice.</li>
<li>C. She tricks Alice into sending her challenge twice.</li>
<li>D. She simply re-sends the challenge response that she intercepted from Alice, back to her.</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Notes P2_L9 - Security Protocols, pg 7

</details>

<p><strong>Multiple Choice</strong></p>
<p>What is a major shortcoming of using a pairwise key exchange based on a shared secret (key)?</p>
<ul>
<li>A. It does not scale well.</li>
<li>B. It lacks computational security.</li>
<li>C. Session keys expire after a set time.</li>
<li>D. It is vulnerable to the man in the middle attack.</li>
</ul>
<details>
<summary>Answer</summary>

A

As new users are added, each must share a new pair of master keys. The number of keys increases rapidly as users are added.

**Source**

Notes P2_L9 Security Protocols pg 10
</details>

<p><strong>True or False?</strong></p>
<p>In Kerberos, the localhost must store the user's password (or password hash) after retrieving the session key from the key distribution center.</p>
<details>
<summary>Answer</summary>

False

**Source**

P2_L9 Security Protocols, pg 13
</details>

<p><strong>Multiple Choice</strong></p>
<p>What are some reasons a user would revoke a certificate before it expires?</p>
<ul>
<li>I. A key has been compromised.</li>
<li>II. Upgrades require a new key.</li>
<li>
<p>III. The key has been duplicated.</p>
</li>
<li>
<p>A. I, II, and III</p>
</li>
<li>B. I and II only</li>
<li>C. II and III only</li>
<li>D. I and III only</li>
<li>E  I only</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 692
</details>

<p><strong>True or False?</strong></p>
<p>Conventional X.509 certifications have validity periods of months to years.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 692
</details>

<h2>Chapter 22: Internet Security Protocols and Standards</h2>
<p><strong>Multiple Choice</strong></p>
<p>Which of the following features does MIME add to the original RFC 822 Internet Mail Format?</p>
<ul>
<li>I. New header fields to define information about the body of the message.</li>
<li>II. Cryptographic message syntax to sign, authenticate, digest, or encrypt message content.</li>
<li>III. Context formats to standardize representations for support of multimedia email, such as images, audio and video.</li>
<li>
<p>IV. The ability to sign and encrypt email messages.</p>
</li>
<li>
<p>A. I, II, III, and IV.</p>
</li>
<li>B. I, II, and IV.</li>
<li>C. I and III.</li>
<li>D. II and IV</li>
<li>E. None of these</li>
</ul>
<details>
<summary>Answer</summary>

C

II and IV are features added by S/MIME.

**Source**

Text pg 661
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is the main difference between <em>signed data</em> and <em>clear signed data</em>?</p>
<ul>
<li>A. Signed data allows users without S/MIME capability to view message content, but clear signed data does not.</li>
<li>B. Clear signed data uses base 64 encoding, signed data uses does not.</li>
<li>C. Clear signed data is not authenticated, signed data is.</li>
<li>D. Clear signed data allows users to use PKI, signed data requires users to apply a private key.</li>
<li>E. None of the above are correct.</li>
</ul>
<details>
<summary>Answer</summary>

E

If you switch _clear signed data_ and _signed data_ in answer A, it would be correct. ; )

**Source**

Text pg 664
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is <em>radix 64 encoding</em> (aka <em>base 64 encoding</em>)?</p>
<ul>
<li>A. Encryption that is optimized for use with 64 bit computers.</li>
<li>B. Encoding that uses binary logarithmic functions (radix base 2) to map input to output values.</li>
<li>C. Encoding that maps binary data to ASCII characters.</li>
<li>D. Encoding that encrypts a message using the receiver's 64 bit private key.</li>
<li>E. None of the above are correct.</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Text pg 663
</details>

<p><strong>True or False?</strong></p>
<p>The basic tool that permits the wide scale use of S/MIME is a pseudo random key generator.</p>
<details>
<summary>Answer</summary>

False

The tool is a _public key certificate_ that conforms to X509v3 standards.

**Source**

Text pg 664
</details>

<p><strong>Multiple Choice (Matching)</strong></p>
<p>Match the Internet mail acronym to the function. (Put the letters in order that match the acronym):</p>
<p>Acronyms:
- 1. MUA
- 2. MSA
- 3. MTA
- 4. MDA
- 5. MS</p>
<p>Definitions:</p>
<ul>
<li>AA. Transfers the message from the message handling agent to the message store.</li>
<li>BB. Typically referred to as a client email program or a local network email server.</li>
<li>CC. A long term repository, possibly on a remote server that is accessed by POP or IMAP.</li>
<li>DD. Relays mail between others of its kind, adding trace information to the message header, until the message reaches the next step.</li>
<li>EE. Accepts the message and enforces policies of the hosting domain and Internet standards.</li>
</ul>
<p>Choices:</p>
<ul>
<li>A. AA, BB, CC, DD, EE</li>
<li>B. BB, EE, DD, AA, CC</li>
<li>C. AA, EE, CC, DD, BB</li>
<li>D. CC, EE, BB, AA, DD</li>
<li>E. DD, BB, CC, EE, AA</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 665
</details>

<p><strong>True or False?</strong></p>
<p>A primary difference between DKIM and S/MIME is that in the former, the message is signed transparently using the private key of the admin domain from the originator, whereas the latter requires the originator's private key.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 665
</details>

<p><strong>True or False?</strong></p>
<p>For most modern users of email, most incoming and outgoing mail is encoded using S/MIME.</p>
<details>
<summary>Answer</summary>

False

**Source**

Text pg 665
</details>

<p><strong>True or False?</strong></p>
<p>TLS sessions avoid the need for updating security parameters for each connection.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 668
</details>

<p><strong>Multiple Choice</strong></p>
<p>Why is a random parameter sent along with client_hello message during phase 1 of a TLS handshake?</p>
<ul>
<li>A. It is used as a nonce which is combined with a security key.</li>
<li>B. It prevents an eavesdropper from replaying the message.</li>
<li>C. It is used to to exchange a key using the Diffie-Hellman protocol.</li>
<li>D. It is sent to confuse bots to prevent a DDoS attack.</li>
<li>E. It is part of legacy code, sent to allow back compatibility.</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 670
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is the basic tool that permits the widespread use of S/MIME?</p>
<ul>
<li>A. Public-key certificates</li>
<li>B. HMAC</li>
<li>C. MIME</li>
<li>D. DKIM</li>
<li>E. SMTP</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Text pg 664
</details>

<p><strong>True or False?</strong></p>
<p>The SSL Record protocol provides both confidentiality and message integrity.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 669
</details>

<p><strong>True or False?</strong></p>
<p>The Heartbleed vulnerability was due to a design flaw that was discovered in the TLS specification.</p>
<details>
<summary>Answer</summary>

False

It was due to a programming mistake in the commonly-used OpenSSL library.

**Source**

Text pg 673
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which of the following statements concerning benefits of IPSec is false?</p>
<ul>
<li>A. IPSec is transparent to applications.</li>
<li>B. No need to train users.</li>
<li>C. IPSec can ensure that a routing update is forged.</li>
<li>D. IPSec can ensure that a routing advertisement comes from an authorized router.</li>
</ul>
<details>
<summary>Answer</summary>

C

It can ensure the update is _not_ forged, i.e., that it is authentic.

**Source**

Text pg 677
</details>

<p><strong>Multiple Choice</strong></p>
<p>Who signs the message to authenticate when DKIM is used?</p>
<ul>
<li>A. MUA</li>
<li>B. MSA</li>
<li>C. MTA</li>
<li>D. MS</li>
<li>E. MDA</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 667
</details>

<p><strong>True or False?</strong></p>
<p>When ESP is used in IPSec transport mode, the packet payload and ESP trailer are encrypted, but the ESP header is not encrypted.</p>
<details>
<summary>Answer</summary>

True

The header gives security information such as which algorithm or secret key was used.

**Source**

P2_L10+IPSEC+and+TLS notes, pg 5
</details>

<p><strong>True or False?</strong></p>
<p>The Security Policy Database and the Security Association Database are maintained in separate tables.</p>
<details>
<summary>Answer</summary>

True

**Source**

P2_L10+IPSec+and+TLS.pptx, slide 20 reviewer notes
</details>

<p><strong>True or False?</strong></p>
<p>The SA is a two-way relationship between a sender and receiver, defined by IPSec parameters.</p>
<details>
<summary>Answer</summary>

False

It is a one-way relationship -- one SA for inbound traffic, and another for outbound traffic.

**Source**

P2_L10+IPSec+and+TLS notes, pg 8
</details>

<p><strong>True or False?</strong></p>
<p>In default mode, if a pre-shared key is compromised during phase 2 of Internet Key Exchange, then all IPSec keys previously computed are compromised.</p>
<details>
<summary>Answer</summary>

True

If perfect forward security is required, then for each IPSec SA, the shared key along with new public components from Diffie-Hellman and new nonce values are used, protecting previously generated keys.

**Source**

P2_L10+IPSec+and+TLS notes pg 14
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which IPSec mode offers end-to-end security protection?</p>
<ul>
<li>A. ESP Mode</li>
<li>B. IKE Mode</li>
<li>C. Tunnel Mode</li>
<li>D. TLS Mode</li>
<li>E. Transport Mode</li>
</ul>
<details>
<summary>Answer</summary>

E

**Source**

Lesson 19 lecture video: Concept 7
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is done if the sequence number in the IPSec header of a packet is less than the the maximum sequence number minus the sliding window value?</p>
<ul>
<li>A. The packet is rejected.</li>
<li>B. The packet is replayed.</li>
<li>C. The packet is returned.</li>
<li>D. The packet is accepted.</li>
<li>E. The packet is forwarded.</li>
</ul>
<details>
<summary>Answer</summary>

A

The packet is rejected to prevent replay attacks.

**Source**

Lesson 19 Lecture video: Concept 23
</details>

<p><strong>True or False?</strong></p>
<p>Multiple IPSec SAs can be established with one IKE SA.</p>
<details>
<summary>Answer</summary>

True

**Source**

Lesson 19 Lecture Video: Concept 25
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which is the main reason a cookie is sent during Phase 1 of IKE?</p>
<ul>
<li>A. To authenticate the users</li>
<li>B. To store log in credentials for the session.</li>
<li>C. To help prevent DoS attacks.</li>
<li>D. To store header information, such as time stamp, a nonce, and the user's public key.</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Lesson 19 Lecture Video: Concept 27
</details>

<h2>Chapter 24: Wireless Network Security</h2>
<p><strong>Multiple Choice</strong></p>
<p>Adding firewall policies to limit the scope of data and application access for all mobile devices, as well as setting up IDS and IPS configured to have tighter rules for mobile device traffic is:</p>
<ul>
<li>A. Device security</li>
<li>B. Traffic security</li>
<li>C. Barrier security</li>
<li>D None of the above</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Text pg 707-708
</details>

<p><strong>Multiple Choice</strong></p>
<p>Using Virtual Private Network(VPN) configured so that all traffic between mobile devices and the organization's network is an example of:</p>
<ul>
<li>A. Device security</li>
<li>B. Traffic security</li>
<li>C. Barrier security</li>
<li>D None of the above</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 708
</details>

<p><strong>Multiple Choice</strong></p>
<p>What are the main threats to wireless transmission?</p>
<ul>
<li>I. Eavesdropping</li>
<li>II. Disrupted transmissions</li>
<li>III. Message integrity attacks</li>
<li>IV. Signal attenuation attacks</li>
<li>
<p>V. Masquerade channel attacks</p>
</li>
<li>
<p>A. I and II</p>
</li>
<li>B. I, III, and V</li>
<li>C. II, III, and IV</li>
<li>D. I, II, III, IV, and V</li>
<li>E. none of the above</li>
</ul>
<details>
<summary>Answer</summary>

E

The correct pairing should be I, II, and III (altering or inserting messages = message integrity attack)

**Source**

Text pg 703
</details>

<p><strong>True or False?</strong></p>
<p>The main threat to wireless access points is disruption.</p>
<details>
<summary>Answer</summary>

False

The main threat is unauthorized access to the network.

**Source**

Text pg 703
</details>

<p><strong>True or False?</strong></p>
<p>Configuring routers to use MAC authentication will block unauthorized access to the network.</p>
<details>
<summary>Answer</summary>

False

MAC addresses can be spoofed, so this is just one element of a defense in depth strategy.

**Source**

Text pg  703
</details>

<p><strong>Multiple Choice</strong></p>
<p>What does the concept of <em>de-perimeterization</em> mean, regarding mobile device security?</p>
<ul>
<li>A. Guests, their-party contractors, and business partners should have limited access from non-centralized locations.</li>
<li>B. Threats to the network mainly exist at the perimeter, where intruders gain unauthorized access.</li>
<li>C. The network perimeter is no longer static, but must include a variety of devices, locations, roles, virtualizations, and access times.</li>
<li>D. Administrators must put short time constraints on wireless access credentials so long-time users don't create a virtual perimeter wall and block other users from access.</li>
<li>E. None of the above.</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Text pg 704
</details>

<p><strong>True or False?</strong></p>
<p>IDS and IPS should be configured to have tighter rules for mobile device traffic.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 707
</details>

<p><strong>True or False?</strong></p>
<p>WPA security mechanisms eliminates most of the weaknesses of the WEP algorithm.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 714
</details>

<p><strong>Multiple Choice</strong></p>
<p>What services does the 802.11i security specification define?</p>
<ul>
<li>I. End to end encryption</li>
<li>II. Authentication</li>
<li>III. Key exchange facilitation</li>
<li>IV. Message integrity</li>
<li>
<p>V. VPN</p>
</li>
<li>
<p>A. All of the services listed</p>
</li>
<li>B. I, II, III, and IV</li>
<li>C. II, III, and IV</li>
<li>D. None of these choices</li>
</ul>
<details>
<summary>Answer</summary>

C

802.11i only ensures security from the station to the access point. A VPN is a different service that may be run individually.

**Source**

Text pg 715
</details>

<p><strong>Multiple Choice</strong></p>
<p>What does <em>association</em> mean, with respect to the 802.11i phase?</p>
<ul>
<li>A. The station and access point agree on a set of security capabilities to be used in future hook ups.</li>
<li>B. The MAC address of the station and the access point.</li>
<li>C. The key that is used for communication from a station to an access point or another station.</li>
<li>D. The four step handshaking procedure that is completed when signing in to a wireless network.</li>
</ul>
<details>
<summary>Answer</summary>

A

Before the distribution service can deliver data to or accept data from a station, that station must be associated.

**Source**

Text pg 717
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which key is used for user traffic on a wireless connection?</p>
<ul>
<li>A. EAPOL - KCK</li>
<li>B. TK</li>
<li>C. EAPOL - KEK</li>
<li>D. GTK</li>
<li>E. PSK</li>
</ul>
<details>
<summary>Answer</summary>

B

The _temporal key (TK)_ is used for protecting user traffic. The EAPOL-KCK (used for origin authenticity and access control) and EAPOL-KEK (used for confidentiality of other keys and data) along with the TK are parts of the PTK (Pairwise Transient Key)

**Source**

Text pg 722
</details>

<p><strong>True or False?</strong></p>
<p>The MAC layer is responsible for authorization and validation.</p>
<details>
<summary>Answer</summary>

False

It is responsible for detecting errors and discarding frames that contain errors.

**Source**

Text pg 710
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which term corresponds to what is referred to in literature as a <em>cell</em>?</p>
<ul>
<li>A. the Logical Link Layer</li>
<li>B. the Distribution System</li>
<li>C. the Access Point</li>
<li>D. the Mac Service Data Unit</li>
<li>E. the Basic Service Set</li>
</ul>
<details>
<summary>Answer</summary>

E

**Source**

 Text pg 710
</details>

<p><strong>True or False?</strong></p>
<p>The principal elements of a mobile device security strategy are <em>device security</em>, <em>client/server traffic security</em>, and <em>barrier security</em>.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 706
</details>

<p><strong>True or False?</strong></p>
<p>Disassociation is a policy under the 802.11 standard which protects a channel from interference from eavesdroppers and third parties.</p>
<details>
<summary>Answer</summary>

False

Disassociation: A notification from either a station or an AP that an existing association is terminated.

**Source**

Text pg 713
</details>

<p><strong>True or False?</strong></p>
<p>All Android apps must be signed and reviewed by Google / Android.</p>
<details>
<summary>Answer</summary>

False

All apps are self-signed by developers. Third-party apps are not signed by a CA. There is no vetting process.

**Source**

Notes: Project2_L12 Wireless and Mobile Security notes, page 15
</details>

<h2>Chapter 14: IT Security Management and Risk Assessment</h2>
<p><strong>True or False?</strong></p>
<p>Security standards recommend that the overall responsibility for an organization's IT security be assigned to a single person.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 464
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which of the following is the definition of <em>risk index</em>?</p>
<ul>
<li>A. Max Threat - Min Defence</li>
<li>B. Max Likelihood of Events / Max Likelihood of Occurrence</li>
<li>C. Max Impact + Max Likelihood of Occurrence + Magnitude of Impact</li>
<li>D. Max Info Sensitivity - Min User Clearance</li>
<li>E. Number of Threats / Likelihood of Occurrence</li>
</ul>
<details>
<summary>Answer</summary>

D

**Source**

Text pg 469
</details>

<p><strong>True or False?</strong></p>
<p>An organization's <em>risk appetite</em> is the net value that it invests in risk management.</p>
<details>
<summary>Answer</summary>

False

It is the level of risk the organization views as acceptable

**Source**

Text pg 470
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is a threat agent?</p>
<ul>
<li>A. An IT specialist who performs risk analysis for an organization.</li>
<li>B. The perpetrator of a threat, be it a person or act of God.</li>
<li>C. A manager or CEO of a company, who makes decisions based on risk analyses.</li>
<li>D. A person who makes a threat, via ransomware, toward an organization.</li>
</ul>
<details>
<summary>Answer</summary>

B

**Source**

Text pg 472
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is the definition of risk, in terms of organizational security?</p>
<ul>
<li>A. (Probability that a threat occurs) x (Cost to the organization)</li>
<li>B. (Sum of costs of all threats) - (Sum of benefits of preventative measures)</li>
<li>C. (Net loss due to threats) / (Net worth of the organization)</li>
<li>D. (Estimated cost of repairs to threats) + (Estimated costs to prevent threats)</li>
</ul>
<details>
<summary>Answer</summary>

A

Cost can also be defined as _impact_ to the organization

**Source**

Text pg 474
</details>

<p><strong>True or False?</strong></p>
<p>A rating of <em>Likely</em> or higher, in a risk analysis, suggests that the threat has occurred previously.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 475
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is a <em>risk register</em>?</p>
<ul>
<li>A. A table describing risks and their associated levels.</li>
<li>B. A ledger of estimated costs due to threats, weighting costs by the likelihood of each threat.</li>
<li>C. A table risks on assets, detailing threats, controls, likelihood, consequences, and level of risk.</li>
<li>D. A summary of losses incurred, along with the corresponding costs involved, people, and resources affected.</li>
</ul>
<details>
<summary>Answer</summary>

C

**Source**

Text pg 477
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is the definition of <em>risk exposure</em>?</p>
<ul>
<li>A. (Size of an Organization) x (Risk Index)</li>
<li>B. Sum of the values in the organization's Risk Register.</li>
<li>C. (Total value of resources) x (Probability of Risks)</li>
<li>D. (Probability of adverse event) x (Impact of adverse event)</li>
<li>E. (Risk exposure w/o control - risk exposure after control) / (cost of control)</li>
</ul>
<details>
<summary>Answer</summary>

D

**Source**

Notes P3_L1_Cybersecurity, pg 12
</details>

<p><strong>Multiple Choice</strong></p>
<p>What is the definition of <em>Risk Leverage</em>?</p>
<ul>
<li>A. The amount of risk an organization can tolerate as a fraction of total perceived risk.</li>
<li>B. The reduction in risk from imposing controls as a fraction of the cost of the controls.</li>
<li>C. The expected gain from imposing controls less the expected loss from not imposing them.</li>
<li>D. The resources available for controls as a fraction of the revenue stream of the organization.</li>
</ul>
<details>
<summary>Answer</summary>

B

Risk leverage = (Risk exp before (w/o) control - Risk exp. after control) / (cost of control)

**Source**

Notes P3_L1_Cybersecurity pg 12
</details>

<p><strong>Multiple Choice</strong></p>
<p>What values of risk leverage imply that the controls are effective?</p>
<ul>
<li>A. negative</li>
<li>B. 0 (or close to 0)</li>
<li>C. 1 (or close to 1)</li>
<li>D. greater than 1</li>
</ul>
<details>
<summary>Answer</summary>

D

Values greater than 1 imply that the reduced risk is greater than the cost of controls

**Source**

P3_L1_Cybersecurity pg 13
</details>

<h2>Chapter 15: IT Security Controls, Plans, and Procedures</h2>
<p><strong>True or False?</strong></p>
<p>Contingency planning, incident response, maintenance, media protection, personnel security, physical and environmental protection, and system and information integrity are all <em>Operational</em> security controls.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 492, Table 15.1
</details>

<p><strong>True or False?</strong></p>
<p>An IT Security plan includes details of risks, controls, priorities, resources, personnel, dates, and maintenance requirements needed to mitigate risks.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 498
</details>

<p><strong>True or False?</strong></p>
<p>Security and Awareness training often receives the least attention and in many cases is an afterthought, if at all.</p>
<details>
<summary>Answer</summary>

False

Replace Security and Awareness training with _monitoring affected systems and checking for security implications_

**Source**

Text pg 500
</details>

<p><strong>True or False?</strong></p>
<p>The decision as to whether to install the latest patches immediately, or to test to ensure that they don't adversely affect other applications is a part of the <em>Change Management</em> process of monitoring risks.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 500
</details>

<p><strong>True or False?</strong></p>
<p>As the number of reported incidents have increased, the budgets invested in cyber security have drastically increased.</p>
<details>
<summary>Answer</summary>

False

In fact, the budges dipped (as of 2014).

**Source**

Notes P3_L1_Cybersecurity pg 21
</details>

<h2>Chapter 19: Legal and Ethical Aspects</h2>
<p><strong>Multiple Choice</strong></p>
<p>Which of the following is <em>not</em> cited in the Articles on the Convention on Cybercrime?</p>
<ul>
<li>A. Illegal access</li>
<li>B.  Fake news</li>
<li>C. Illegal interception</li>
<li>D. Data interference</li>
<li>E. System interference</li>
<li>F. Pass interference</li>
<li>G. Misuse of devices</li>
<li>H. Computer-related forgery</li>
<li>I. Computer-related fraud</li>
<li>J. Offenses related to child pornography</li>
<li>K. Infringements of copyright</li>
<li>L. Attempt and aiding or abetting</li>
</ul>
<details>
<summary>Answer</summary>

B and F

**Source**

Text pg 580
</details>

<p><strong>Multiple Choice</strong></p>
<p>Which of the following are copyright owner rights against infringement?</p>
<ul>
<li>I. Reproduction right</li>
<li>II. Fair Use right</li>
<li>III. Distribution right</li>
<li>IV. Fair compensation right</li>
<li>V. Public-performance right</li>
<li>VI. Public-display right</li>
</ul>
<details>
<summary>Answer</summary>

All except for II and IV.  (Also add Modification right)

**Source**

Text pg 584
</details>

<p><strong>True or False?</strong></p>
<p>Both criminal and civil penalties apply to individuals who attempt to circumvent technological measures used to thwart access to or copying of copyrighted material.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 586
</details>

<p><strong>True or False?</strong></p>
<p>Algorithms can be patented.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 585
</details>

<p><strong>Multiple Choice</strong></p>
<p>Under the Digital Millennium Copyright ACT, individuals may be allowed to do which of the following?</p>
<ul>
<li>I. Distribute portions of the work for review.</li>
<li>II. Reverse engineer in order to achieve interoperability</li>
<li>III. Attempt to decrypt technology in order to advance the development of the technology.</li>
<li>IV. Testing a vulnerability in a computer or network.</li>
<li>
<p>V. Bypassing technological measures to protect PII.</p>
</li>
<li>
<p>A. I, II, III, IV, V</p>
</li>
<li>B. I, IV, V</li>
<li>C. I, II, IV, V</li>
<li>D. III, IV, V</li>
</ul>
<details>
<summary>Answer</summary>

A

**Source**

Text pg 586
</details>

<p><strong>True or False?</strong></p>
<p>Anonymity directly conflicts with authorization and access control functions.</p>
<details>
<summary>Answer</summary>

False

It need not conflict, because these are bound to computer-based user IDs, not to personal user information.

**Source**

Text pg 592
</details>

<p><strong>True or False?</strong></p>
<p>PII in anonymized data can sometimes be re-identified.</p>
<details>
<summary>Answer</summary>

True

**Source**

Text pg 594

</details>

<p><strong>True or False?</strong></p>
<p>Privacy is the principle that only authorized persons should have access to information. Confidentiality is the control that individuals have over who can access their personal information.</p>
<details>
<summary>Answer</summary>

False

Switch _privacy_ and _confidentiality_, and it's true

**Source**

Text pg 594
</details>

<p><strong>True or False?</strong></p>
<p>Software applications embedded in toys may be classified as a computing artifact.</p>
<details>
<summary>Answer</summary>

True

computing artifact refers to any artifact that includes an executing computer program. This includes software applications running on a general purpose computer, programs burned into hardware and embedded in mechanical devices, robots, phones, Web bots, toys, programs distributed across more than one machine, and many other configurations.

**Source**

Text pg 599
</details>
<hr />
<p>id: information-security-modern-malware
title: Modern Malware
course: information-security
lecture: modern-malware</p>
<hr />
<h1>Modern Malware</h1>
<h2>Past Malware</h2>
<p>Before 2005, most malware was used for "fun" and/or "fame".</p>
<p>During this era, malware was often designed for the sake of experimentation, and was used to demonstrate some capability - for example, how fast a piece of malware could spread.</p>
<p>Only a few instances of malware in this time period were actually used for denial-of-service attacks and website defacements.</p>
<h2>Modern Malware</h2>
<p>Since 2005, malware has been used to make compromised computers and networks perform malicious activities in order to elicit financial and even geopolitical gain.</p>
<p>Whereas computers of the past were targets of malware, they are now weapons that malware can control and deploy for profit and gain.</p>
<p>Since modern malware are now used to do real work, they tend to be technically sophisticated and use the latest technologies.</p>
<p>For example, they may utilize popular peer-to-peer protocols and applications to set up communications. They might use cloud computer servers to support their activities. Some malware might use the latest cryptography algorithms to perform authentication and encryption to protect their communications from subversion and analysis.</p>
<h2>Botnet</h2>
<p>A <strong>bot</strong>, also called a zombie, is a compromised computer under the control of an attacker.</p>
<p>The bot code present on the compromised system is responsible for communicating with the attacker's server and carrying out malicious activities per the instructions it receives from this server.</p>
<p>Therefore, a <strong>botnet</strong> is a network of bots controlled by an attacker that is used to perform coordinated malicious activities.</p>
<p>With a network of bots, the aggregated computational power can be very large. An attacker can launch a variety of attacks using such a powerful platform.</p>
<p>Indeed, most Internet-based cyber attacks today are carried out by botnets.</p>
<h2>Bot Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/133D2EE2-25A2-4657-A7B4-78A70EDC2E60.png" /></p>
<h2>Bot Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FF650996-73FA-4E4C-B893-FA0A8F302E79.png" /></p>
<h2>Attacks and Frauds by Botnets</h2>
<p>Regardless of the method used, modern botnets usually have one or two goals in mind: illegal profits or political activism. Here are some examples of attacks and frauds by botnets.</p>
<p><img alt="" src="https://assets.omscs.io/notes/3C467463-D497-4DCB-B97C-24A7ED2A74F6.png" /></p>
<h2>DDoS Using Botnets</h2>
<p>Let's look at a typical DDoS scenario using botnets.</p>
<p>First, the attacker selects a victim and decides when to attack.
Next, the attacker sends a command to all of the bots in the botnet. This command might tell the bots to all send connection requests to the victim at once.</p>
<p>The result is that the victim receives connection requests from many bots at the same time. As a result, the victim is overloaded, and the denial of service is complete.</p>
<h2>Amplification Distributed Reflective Attacks</h2>
<p>A typical defense against DDoS is to buy more servers or bandwidth. However, DDoS attacks can be amplified to make this type of defense very expensive.</p>
<p>The following is an example of such an <strong>amplification attack</strong>.</p>
<p>On the Internet, there are many <em>open recursive DNS servers</em> that any Internet-connected machine can query. A typical DNS query asks for the IP address associated with a particular domain name.</p>
<p>Users can also query these servers for the TXT record for a domain. This record often contains a lot of information, and the size of the query response can be more than 1500 bytes.</p>
<p>Attackers will instruct their bots to query these servers for this TXT record. They will <strong>spoof</strong> (forge) the query such that the source IP address will point to the victim's IP address. As a result, the response will be sent to the victim, not the bot.</p>
<p>The attacker thus amplifies their query traffic - at around 60 bytes per query - into a much larger amount of attack traffic - at 1500+ bytes per response - directed at the victim.</p>
<p>With just a few thousand bots, querying multiple DNS servers, the attacker can send several gigabytes of traffic to the victim.</p>
<h2>DDoS Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B4B116A3-24D3-40AB-86DE-DF49D439D91E.png" /></p>
<h2>DDoS Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3F23779C-7FEB-4551-A120-ED3B7046EFF2.png" /></p>
<p>Remember, the characteristics of DNS servers can be used to amplify the effects of DDoS attacks, not mitigate them.</p>
<h2>Botnet Command and Control</h2>
<p>In order for a botmaster to make use of a botnet, he needs to communicate with the bots. In particular, there needs to be <strong>command &amp; control</strong> (C&amp;C) from the botmaster to the bots.</p>
<p>For example, a bot should be able to report its current status to the botmaster. A botmaster should be able to direct a bot to download the latest version of the bot code as well as instruct the bot to perform an attack.</p>
<p>Without C&amp;C, a botnet is just a collection of isolated infected machines which the botmaster will not be able to aggregate into a single computational workhorse.</p>
<h2>Botnet C&amp;C Problem</h2>
<p>Suppose we have downloaded some malware source code from the web, and we've configured it to our liking. We've used some social engineering to start spreading out our compiled malware via email.</p>
<p>As our code spreads, we as botmasters are faced with an important question: How can we identify and contact the infected machines so we can start to use them?</p>
<p>The simplest solution is to have the infected victims contact us.</p>
<h2>Botnet C&amp;C: Naive Approach</h2>
<p>We may hardcode our email address or our IP address in the malware to give the compromised computers a point of contact upon infection.</p>
<p>This approach is not stealthy. It is a safe bet that security admins will eventually find out that they have bots on their network. When they do, they may be able to obtain your bot code and recover the hardcoded address through malware analysis. With this address, they will be able to identify us.</p>
<p>This approach is also not robust. The single rallying point hardcoded in the malware also represents a single point of failure. For example, if we have hardcoded an email address and the email account has been banned, our command and control center becomes completely unreachable.</p>
<h2>Botnet C&amp;C Design</h2>
<p>Since having the compromised computers contact the botmaster is neither stealthy nor robust, this strategy is only used by <a href="https://en.wikipedia.org/wiki/Script_kiddie">script-kiddies</a> and first time malware authors.</p>
<p>A botmaster will focus on efficiency and reliability when designing bot code. They must be able to coordinate enough bots to perform a specific task, which requires efficient, reliable communication.</p>
<p>In addition, the botmaster will design for stealth and robustness. Stealth makes it hard to detect C&amp;C traffic, while robustness makes it hard to disable or block this traffic.</p>
<h2>C&amp;C Design Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/185071EA-CDCF-47EC-8D44-9F63D543C5DD.png" /></p>
<h2>C&amp;C Design Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FE123C3D-C49F-4AA5-80F0-0DF1EF468A48.png" /></p>
<p>The second answer is false. Bot code can have logic bombs or other triggers that enable bots to attack without contacting a C&amp;C server.</p>
<p>The third answer is also false. A botnet is more likely to be found using custom communication protocols, as admins observing the network are more likely to detect strange types of traffic flowing from their system.</p>
<h2>DNS Based Botnet C&amp;C</h2>
<p>Many botnets use DNS for C&amp;C.</p>
<p>A key advantage is that DNS is used whenever a machine on the Internet needs to talk to another machine because DNS stores the mapping between domain names and IP addresses. DNS is always allowed in a network, so DNS traffic will not stand out.</p>
<p>The botmaster will distribute the malware code, inside of which the domain name of the C&amp;C server is hardcoded. Let's assume that this domain name is hackers.com.</p>
<p>To perform C&amp;C, the bot will ask the DNS server for the IP address for hackers.com. The DNS server will tell the bots what the IP address is, and the bots will use that address for communication.</p>
<p>Botmasters prefer <em>dynamic</em> DNS providers because they allow for frequent changes between domain names and IP addresses. This means that the botmaster can rapidly switch where they host their server, and can quickly change the mapping so that hackers.com points to the new address.</p>
<p>If we can detect that hackers.com is used for botnet C&amp;C, then we can identify any computer that connects to it as a bot.</p>
<p>How can we determine that a domain name is used for C&amp;C?</p>
<p>The way that bots look up a domain will be different from a machine that looks up a web server because of legitimate user activities.</p>
<p>For example, if a domain is being looked up by hundreds of thousands of machines all over the Internet, and yet this domain is unknown to Google search, this is an anomaly.</p>
<p>We can use anomaly detection at the dynamic DNS provider level to examine domain queries in order to identify potential botnet C&amp;C servers.</p>
<p>Once we identify that hackers.com is used for botnet C&amp;C, there are a number of responses available.</p>
<p>The DNS provider can point the entry for hackers.com to the IP address of a sinkhole. The result of this change is that bot traffic will be routed to the sinkhole instead of the C&amp;C server, effectively severing the communication link between the botmaster and the bots.</p>
<p>In addition, security researchers can monitor the sinkhole and,  by looking at the IP address of each incoming connection, can determine the distribution of the bots throughout the Internet.</p>
<h2>Botnet C&amp;C Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B94A4FF5-8F9D-4252-9849-4DFAFCAA5640.png" /></p>
<h2>Botnet C&amp;C Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F388379F-0461-46F3-9211-1ADA9775FEE1.png" /></p>
<p>A single gmail account, hardcoded in bot code, is both easy to detect and easy to disrupt.</p>
<p>P2P traffic will easily stand out in an enterprise network where peer-to-peer communications are not typically allowed.</p>
<p>A news site can be hard to detect, because traffic to news websites is common. However, if the site is identified as being malicious, it can easily be blocked.</p>
<h2>Advanced Persistent Threat</h2>
<p>The latest type of modern malware is the <strong>advanced persistent threat</strong> (APT). Whereas botnets often have bots all over the Internet, APTs tend to be localized to specific target organizations.</p>
<h3>Advanced</h3>
<p>APTs can use advanced malware that is specifically crafted for a targeted organization.</p>
<p>Often, the malware used is just a customized version of a common malware. Starting from a common malware provides APT designers with both convenience and deniability; that is, security admins in the target organization will not suspect that a common-looking malware is actually an APT.</p>
<p>The operations carried out by APTs are also advanced.</p>
<p>APTs are not used for common attacks/frauds like spamming, click fraud, phishing. An APT is much more likely to be used for a high value operation, such as stealing the design of a new airplane.</p>
<h3>Persistent</h3>
<p>Once the malware gets into an organization, it will stay there for a long time, carrying out its attack in a "low and slow" fashion.</p>
<p>For example, rather than sending out the design of the airplane - a large amount of data - onto the Internet at once, the APT can break the data into multiple chunks and then transmit each chunk whenever a user connects to the Internet.</p>
<p>Of course, this approach exfiltrates the designs much more slowly, but can do so without raising any suspicion.</p>
<h3>Threat</h3>
<p>APTs are a very dangerous threat because they tend to target high value organizations and information.</p>
<h2>APT Lifecycle</h2>
<p>The attacker starts by identifying the attack target, such as an automobile or aerospace company.</p>
<p>Next, the attacker will research the target, looking for information that can help in the attack.</p>
<p>For example, the attacker can learn about the target organization's network and therefore the vulnerabilities of the organization's network services through network scanning and analysis.</p>
<p>Many companies list their C-level executives on their webpages, and attackers can research these individuals to find their company email addresses, which they can use as a contact point.</p>
<p>Once they have completed their research, the attacker can develop a method to penetrate the organization's network.</p>
<p>For example, the attacker may exploit a <a href="https://en.wikipedia.org/wiki/Zero-day_(computing)">zero-day</a> vulnerability in the company's web server.</p>
<p>Alternatively, they may choose to engage in a so-called <strong>spear phishing</strong> attack. This type of phishing attack is usually directed to a C-level executive within the organization, and is called spear phishing because it is aimed at a single individual that the attacker has spent a lot of time researching.</p>
<p>The exploit succeeds once the APT has gained a foothold within the organization and establishes communication back to the attacker.</p>
<p>Once the communication link has been created, the attacker can push software updates and commands to the APT, such as requesting that it exfiltrate confidential data back to the attacker.</p>
<p>Finally, the APT will try not to raise any suspicion so that it can remain undetected.</p>
<p>For example, it will only exfiltrate data to the attacker when there are other legitimate network connections. In addition, it will keep its footprint as small as possible, only infecting the machines that it needs for its tasks.</p>
<h2>APT Characteristics</h2>
<p>The most dangerous and advanced  APTs are those that use a <strong>zero-day exploit</strong> or specially crafted malware.</p>
<p>A zero-day attack exploits a previously unknown vulnerability.
Since the vulnerability is unknown at the time of the attack, intrusion detection systems will likely not have a signature for the exploit and, even if they did, there is no patch available.</p>
<p>Zero-day exploits can be very successful and very stealthy.</p>
<p>Similarly, a specially crafted malware is usually designed to defeat the signature and behavior monitors in a particular detection system. Like zero-day exploits, this class of malware has a very high chance of succeeding and proceeding undetected.</p>
<p>APTs are characterized not only by their ability to thwart anti-malware software, but also by their ability to employ social engineering strategies to fool even the most sophisticated users.</p>
<p>For example, an APT might start out by passively monitoring email traffic in order to understand who speaks to whom, what certain people talk about, and what type of attachments are sent. With this knowledge, the APT can then successfully forge email from one person to another.</p>
<p>In addition, the APT can conduct <strong>man-in-the-middle</strong> attacks to make such social engineering strategies very successful.</p>
<p>For example, if an email recipient is uncertain about an email attachment, they may send an email out to the sender asking for clarification. The APT can intercept this message and respond as the "sender", confirming the message and the (malicious) attachment.</p>
<p>APTs are also designed to blend in with normal activities to avoid detection, achieving their goals in a "low and slow" fashion.</p>
<p>For example, if the APT is designed to change the setting of a controller in a nuclear plant, it will not make the changes all at once. Instead, it will make small incremental changes over time to accomplish the eventual attack goal. This was the strategy of the famous <a href="https://en.wikipedia.org/wiki/Stuxnet">Stuxnet</a> malware.</p>
<p>Because APTs are designed to blend in with normal system activities, it can be very hard for anomaly detection systems to catch them.</p>
<p>APTs are often designed to stay in the compromised organization for a long time, always looking for more valuable data to steal.</p>
<p>An APT can carry out many different attacks, on different users, in different parts of the system. At each step, the APT may use different malware code, and it may clean up after itself as it travels throughout its host.</p>
<p>In other words, the footprint of an APT often remains very small and ever-changing.</p>
<h2>APT Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/31C8957F-328A-463B-98E6-8D5FA5481366.png" /></p>
<h2>APT Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/012DC084-0287-4D85-9D3B-0C2003FB716A.png" /></p>
<h2>APT Example</h2>
<p>A CEO gets an email with a PDF attachment containing pie charts of sales activities. When the CEO opens the PDF using the adobe acrobat browser plugin, the crafted attack data embedded in the PDF document causes a zero-day exploit that breaks out of the plugin sandbox and compromises the browser.</p>
<p>The attack code downloads a malicious browser extension - a malware embedded within the browser. From this point on, the extension will infect every attachment the CEO sends via email.</p>
<p>Eventually, the malware gets on the computer of a user who has admin access to the company's server. The malware can now steal the server credentials from the user and thus, the valuable data residing on the server.</p>
<p>This example captures several key characteristics of APTs. First, the users do not realize that their computers and network have been compromised. Second, the APT activity blends in with normal user activity. For example, the APT doesn't send its own emails; instead, it only modifies emails sent by the CEO. Third, the APT takes its time to get to the key individual and steal the server credentials.</p>
<h2>Malware Analysis</h2>
<p>Malware analysis produces information about malware that can be used for detection and response. There are two typical approaches to malware analysis.</p>
<p>In <strong>static analysis</strong>, we look at the program or the instruction set of the malware to understand what the malware would do if it was executed. We want to understand the malware's behavior without actually executing it.</p>
<p>There are limitations to static analysis. Some program behaviors that depend on runtime conditions or user input data can not be precisely identified by looking at the source code. Additionally, binary code can be obfuscated.</p>
<p>Another approach is <strong>dynamic analysis</strong>. Here, we run the malware program and try to analyze its runtime behavior to try to understand what the malware is doing when it is executed.</p>
<p>We can perform dynamic analysis in different levels of granularity. A fine-grained analysis might look at the malware execution on an instruction by instruction basis. For a more coarse-grained approach, we might only look at the system calls that the malware invokes.</p>
<p>Dynamic analysis is not without its limitations. Any particular run of the malware only reveals behaviors of that run. Malware can actively try to resist analysis by delaying execution until a certain command is given or a trigger is tripped. For any run, the conditions may not be right for the malware to exhibit certain behaviors, and so those behaviors are not revealed.</p>
<p>Because of the limitations of each type of analysis, a typical malware analysis system will employ both static and dynamic analysis.</p>
<h2>Malware Obfuscation</h2>
<p><strong>Packing</strong> refers to the process of compressing and encrypting part of an executable program. The result of packing is that part of the executable becomes data instead of instructions. To execute the packed instructions, the packing tool must include code in the packed executable that <strong>unpacks</strong> these instructions.</p>
<p><img alt="" src="https://assets.omscs.io/notes/8AD71C83-9B36-47AE-ABB1-91F60D6084A6.png" /></p>
<p>The packing program will encrypt the malware using a randomly generated key, which means that each subsequent packed malware will look completely different from the last. Consequently, a signature-based approach is not effective in detecting packed malware.</p>
<p>Can we use the unpacking instructions as a signature to detect malware? Unfortunately not. Malware is not the only application that performs packing/unpacking. Legitimate programs may use packing to hide certain logic and/or data, often for intellectual property reasons such as copyright protection.</p>
<h2>Unpacking</h2>
<p>Most modern malware uses packing, and there are many <strong>packers</strong> available. Furthermore, there are hundreds of thousands of packed malware samples released to the Internet every day by attackers.</p>
<p>We cannot manually analyze all of the malware samples. Instead, we need an automatic approach to unpack and analyze malware. Such an approach has to be universally applicable to all of the malware samples.</p>
<p>We can run static analysis over the packed malware to get a set of instructions in the packed program. We can then run the malware and use dynamic analysis to identify instructions that are not present in the statically identified set of instructions. These instructions must have been unpacked just before execution.</p>
<p>Once we identify the unpacked code, we can then apply other anti-malware techniques such as signature scanning to identify the malware logic. Since the unpacked malware code looks the same across malware instances, we can still use a signature-based approach to identify these infections.</p>
<h2>Malware Analysis Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A14989C9-C5D0-4F0D-B937-F9F9E8B01079.png" /></p>
<h2>Malware Analysis Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/C371FC26-E6A5-42D1-870F-5C4914E47789.png" /></h2>
<p>id: information-security-operating-system-security
title: Operating System Security
course: information-security
lecture: operating-system-security</p>
<hr />
<h1>Operating System Security</h1>
<h2>Operating Systems Defined</h2>
<p>Operating systems play a really important role in computer systems. When we talk about computers, we often refer to the operating system when naming a device; for example, a Windows machine or an iOS device.</p>
<p>Operating systems play a critical role when it comes to protecting and securing resources present in our computer systems.</p>
<p>When we are looking at the arrangement of a computer system, we first start at the level of hardware. At this layer, we have the CPU, physical memory, and other I/O devices.</p>
<p>Direct use of hardware is really difficult. Instead of managing the hardware explicitly, we run a "program" called an <strong>operating system</strong> - such as Linux, Windows, or macOS - that handles the access and management of the low-level hardware resources.</p>
<p>The applications that we as users directly deal with - browsers, word processors and the like - sit on top of the operating system and interact with the physical resources through this intermediary.</p>
<p><img alt="" src="https://assets.omscs.io/notes/EC421F6A-25C4-4DDC-B5FE-F0654D08DDAB.png" /></p>
<p>As a mediator between applications and the real, hardware resources, the operating system unsurprisingly plays an important role in the security of computer systems.</p>
<h2>Operating Systems</h2>
<p>Operating systems provides key functionality to the applications which rely on them.</p>
<h3>Abstraction of hardware</h3>
<p>The hardware is not easy to use directly. If you want to program your applications to work with hardware directly, development becomes infinitely more complex.</p>
<p>Thankfully, the operating system abstracts the low-level hardware APIs into simpler higher-level entities.</p>
<p>For example, persistent data in a computer system is stored on the disk in disk blocks. Instead of having to worry about disk management and the location/traversal of blocks, the operating system provides us with the convenient <em>file</em> abstraction.</p>
<p>These high-level abstractions allow us to interact with the underlying resources in ways that are simpler to understand and reason about, which in turn makes it easier to build applications on top of the operating system.</p>
<h3>Controlled hardware access</h3>
<p>The abstractions that the operating system provides to the higher applications are implemented using the real physical resources provided by the hardware.</p>
<p>The physical resources are shared across the application and, as a result, must be accessed in a controlled fashion.</p>
<p>Without controlled access, it would be all too easy for one application to overwrite data currently in use by another application. Alternatively, one application could hog the CPU and starve the other applications of execution.</p>
<p>Controlled access ensures that the applications across the system run cohesively.</p>
<h3>Process Isolation</h3>
<p>All of the different applications are running on the same system and sharing the same physical resources.</p>
<p>Yet, from the perspective of an individual application or process, it seems as though the process has complete and exclusive access to the entire hardware underneath.</p>
<p>The operating system isolates processes from one another, so each application has the feeling that it is the only one running.  </p>
<p>Processes need not necessarily be aware of other processes.</p>
<p>This is important because processes may not trust each other. The operating systems isolates processes from one another while providing a trusted interface (itself) with which a process can interact with the underlying physical system.</p>
<h2>Need for Trusting an Operating System</h2>
<p>The operating system has direct control over basically everything in the system. It can manipulate processes running on top of it, and access hardware beneath it.</p>
<p>The operating system has the "keys to the kingdom", so to speak, so it is important that the operating system function as a <strong>trusted computing base</strong> (TCB) for our computer systems.</p>
<p>The following requirements should be met by a trusted computing base.</p>
<h3>Complete mediation</h3>
<p>A TCB must mediate all access to the underlying protected resources. All requests for access to hardware must pass through the operating system. Hardware use cannot circumvent the OS.</p>
<h3>Tamper-proof</h3>
<p>A TCB must also be tamper-proof. If untrusted code executing on top of the OS can tamper with the OS then we can no longer trust the OS.</p>
<h3>Correctness</h3>
<p>Finally, a trusted system is a correct system. If you are going to rely on the OS to ensure that your protected resources get used in a proper way, it is imperative that this access control is implemented correctly.</p>
<h2>OS and Resource Protection</h2>
<p>How does the operating system mediate requests for protected resources?</p>
<p>A request always has two main components:</p>
<ul>
<li>the entity making the request</li>
<li>the target resource being requested</li>
</ul>
<p>Identifying the entity making the request is known as <strong>authentication</strong>. Authentication establishes on whose behalf a current application or process is running.</p>
<p>Once we authenticate the requesting entity, we employ <strong>authorization</strong> to grant or deny access to the requested resource.</p>
<p>Note that the operating system doesn't autonomously decide who accesses a given resource or not. System administrators must define <strong>policies</strong> that describe who can access what, and under which circumstances.</p>
<p>The operating system implements a policy by performing access checks and either granting or denying access in accordance with the policy.</p>
<h2>Secure OS Quiz 1</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3E4E1A33-04F6-49C8-A8BE-5C9B97CD9F46.png" /></p>
<p><a href="https://usa.kaspersky.com/resource-center/threats/mac-vs-pc#.VRLACxDF-Hw">Mac vs PC Security</a></p>
<h2>Secure OS Quiz 1 Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A47F089A-E76B-45FB-8EAB-67A1410CD42A.png" /></p>
<h2>Secure OS Quiz 2</h2>
<p><img alt="" src="https://assets.omscs.io/notes/8FB30729-124D-4073-9C7B-E9B8BE6B98AE.png" /></p>
<h2>Secure OS Quiz 2 Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/14FB0734-2CED-4A50-97FE-789C608E61C3.png" /></p>
<p>A system call requires control transfer from the calling process into the OS, which then must perform authentication/authorization checks before granting access and transferring control back.</p>
<p>This is more costly than a regular call, which incurs none of this overhead.</p>
<h2>Secure OS Quiz 3</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B1E759C2-2BDC-4F1D-87CC-D0FF65033E40.png" /></p>
<h2>Secure OS Quiz 3 Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9F2E641A-BA27-4DEB-8754-E4C12B164432.png" /></p>
<p>Processes run on behalf of users. Users must login to the system to run applications/processes.</p>
<h2>How Can We Trust an OS?</h2>
<p>How is an operating system tamper-proof? In other words, how does an operating system maintain its isolation and integrity despite untrustworthy  applications and users executing on top of it?</p>
<p>The operating system needs help from the hardware. Particularly, the hardware needs to protect the memory where the operating system resides, and block unprivileged attempts from interacting with memory at those locations.</p>
<p>The CPU executes in different <strong>execution modes</strong> (also known as <strong>execution rings</strong>), which serve as execution environments with varying privileges. The most privileged ring is ring 0, and privileges are revoked as you move up to higher rings.</p>
<p>Many architectures support more than two (user and system) execution rings.</p>
<p>Thanks to these rings, the processor is aware of which kind of code it is executing - be it untrusted user code or trusted system code -  and knows that it shouldn't access code or data belonging to a higher privilege level.</p>
<p>Certain privileged hardware instructions can only be executed when the processor is executing in ring 0. These instructions are usually ones that provide direct access to the hardware: manipulating memory, interacting with devices, and so forth.</p>
<h2>System Calls From User to OS Code</h2>
<p>System calls are used to transfer control between user and system code.</p>
<p>These calls cannot be arbitrary. The operating system exposes an API which enumerates the specific ways in which applications can interact with it. For example, here are the <a href="http://man7.org/linux/man-pages/man2/syscalls.2.html">system calls</a> for Linux.</p>
<p>These calls must enter the operating system in a controlled fashion. They come through <strong>call gates</strong>, which are accompanied by a processor privilege ring change on system entry and exit.</p>
<p>Crossing this boundary means that the operating system will have to change some data structures that keep track of memory mappings, because we will be able to access memory now that we couldn't access before. In addition, certain registers will have to be saved, while others have to be loaded.</p>
<p>This used to happen via a hardware interrupt/<a href="https://en.wikipedia.org/wiki/Trap_(computing)">trap</a> into the system from user mode, but in <a href="https://www.computerhope.com/jargon/x/x86.htm">x86 architectures</a>, we have explicit instructions to cross the system boundary: <code>sysenter</code> to enter the operating system during the system call and <code>sysexit</code> to return from the system call.</p>
<p>The extra work of adjusting privilege rings, changing memory mappings, and loading/saving additional registers makes these calls more costly.</p>
<h2>Untrusted User Code Isolation</h2>
<p>Untrusted user code has to be isolated from the system code. How can we achieve this isolation?</p>
<p>All the processor does is fetch the next instruction and execute it. Some of these instructions may be read/write or load/store requests. If the processor receives one of these requests supplied with a memory address belonging to the operating system, what stops it from executing that instruction?</p>
<p>We can rely on the hardware to protect memory. If you are running in user mode, the hardware will block an attempt to generate an address and complete a read or write in a memory location that belongs to the operating system.</p>
<p>This hardware protection also applies to processes trying to access memory belonging to other processes. The hardware enforces that processes only access memory that has been made available to it, blocking access to any other memory locations.</p>
<h2>User Isolation Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/65EE949F-30AB-462D-ABAF-766E03061E1B.png" /></p>
<h2>User Isolation Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2CF867D1-BB5E-4D7F-A303-4A6F0A5CC1AD.png" /></p>
<h2>Address Space</h2>
<p>From a process's point of view, it has the entire computer to itself. It isn't aware that it shares physical memory with other processes.</p>
<p>This is made possible by the <strong>address space</strong> abstraction that the operating system creates for a process upon creating the process itself.</p>
<p>An address space contains a sequence of contiguous memory locations (from zero to some max) that a process can address and utilize for its own data and instructions.</p>
<p><em>The address space serves as the unit of isolation between processes sharing the same physical hardware resources.</em></p>
<p>The memory that a process views may be larger than the actual physical memory present on the system, a feat made possible by <a href="https://en.wikipedia.org/wiki/Virtual_memory">virtual memory</a>.</p>
<p>The address space usually contains <code>2^32</code>  addresses (for a 32-bit architecture) or <code>2^64</code> addresses (for a 64-bit architecture).</p>
<h2>Unit of Isolation</h2>
<p>Physical addresses point to locations in physical memory, but addresses in an address space don't directly reference physical locations. Instead, these <strong>logical addresses</strong> must be translated into physical addresses by the operating system.</p>
<p>For example, the operating system might maintain a map that connects logical address 2000 in process A's address space to to physical address 5000.</p>
<p>When process A is running, its address space maps to certain physical addresses in memory. When process B is running, its address space maps to different physical address in memory.</p>
<p>Even though the physical addresses corresponding to the address spaces of two processes are often interspersed, each process views its address space as contiguous and exclusive.</p>
<h2>Address Translation</h2>
<p>The reason that translation has to happen is that the address space that the process is provided is just an abstraction of the physical memory layout underneath.</p>
<p>For example, the process thinks it has access to a chunk of contiguous memory - which it doesn't - and in some cases the process may think that it has access to more memory than is currently physically available.</p>
<p>Naturally, the operating system needs to maintain a system to map between the abstraction and the reality.</p>
<p><img alt="" src="https://assets.omscs.io/notes/E66B6D85-F314-4E7E-9A19-21F1F82D17C1.png" /></p>
<p>This mapping process does not occur byte for byte. The number of mappings we would have to maintain if this were the case would not be scalable.</p>
<p>Instead, we divide the address space into larger chunks, called <strong>pages</strong>. A common page size is 4kb.</p>
<p>Thus, we can think about the representing any address within the address space as a page number and an offset within that page.</p>
<p>A <strong>page table</strong> maintains the mapping between logical pages and physical pages. The operating system is responsible for building, maintaining, and protecting these tables.</p>
<p>When a process needs to retrieve data from an address in its address space, the operating system must first map that logical page to the correct physical page and carry the offset.</p>
<p>For example, the page table might have an entry that maps logical page 3 to physical page 8. This means that if a process is requesting some byte at offset <code>d</code> from the start of page 3, the operating system will fetch the byte at offset <code>d</code> from the start of physical page 8.</p>
<p>By using pages, we can reduce the number of entries in our lookup table from the number of addresses in the address space to that number divided by the page size.</p>
<p>For example, with 4kb pages and 32-bit addresses, we can reduce the number of entries in the page table from <code>2^32</code> to <code>2^20</code> (<code>2^32</code> / <code>2^12</code>)</p>
<p>Virtual address translation - as maintained by page tables - ensures that a process can only access physical memory for which a corresponding logical address mapping exists in its page table.</p>
<h2>Code Protection</h2>
<p>The operating system will not map a virtual page of process A to a physical page that has been given to process B, unless the two processes wish to share memory.</p>
<p>Put another way: two page tables, each for a different process, will not contain a mapping to the same physical page at the same time.</p>
<p>What this means is that it is impossible for process A to access physical memory belonging process B, because process A has no way to address that memory.</p>
<h2>Process Protection through Memory Management</h2>
<p>Protecting processes from each other and protecting the operating system from untrusted process code follow the same mechanism.</p>
<p>Page table lookups prevent a process from accessing any physical pages that belong to the operating system, since the operating system has not explicitly mapped those locations into the process's address space.</p>
<p>This translation process is so important that we typically have a piece of hardware called a <strong>memory management unit</strong> (MMU), that helps the OS perform this translation efficiently, using memory caches such as <a href="https://en.wikipedia.org/wiki/Translation_lookaside_buffer">translation look-aside buffers</a>.</p>
<p>In addition to resolving a physical address from a virtual address, a page table entry can provide information about different types of memory access available for that page.</p>
<p>For example, an entry may store some information as to whether a given page is available for reading, writing, execution, or some combination of the three. These <strong>RWX bits</strong> can limit the type of access that a process can perform on addressable memory.</p>
<p>As a result, interacting with memory really has two components: first, understanding which memory locations are even available to a process, and; second, understanding which types of accesses are permitted on those locations.</p>
<h2>Revisiting Stack Overflow Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/5D690072-1177-4D13-9415-4E98EDD4BC2A.png" /></p>
<h2>Revisiting Stack Overflow Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/D1ECF899-825E-4B79-89D3-4B6B2A5A64FC.png" /></p>
<h2>Preventing Malicious Code Execution</h2>
<p>One of the strategies that we have talked about for protecting against a stack buffer overflow attack is to use a non-executable stack.</p>
<p>While a malicious user might still be able to inject malicious instructions onto the stack, those instructions will not actually be executed.</p>
<p>The operating system can achieve this by not writing an executable bit for any page table entry associated with the virtual addresses within the process's stack.</p>
<p>Windows, OS X and Linux all make the stack non-executable.</p>
<h2>OS Isolation from Application Code Part 1</h2>
<p>Protecting processes from each other and protecting the operating system from untrusted process code follow the same mechanism.</p>
<p>The operating system (kernel) resides in a portion of each process's address space.</p>
<p>The address space in which a process executes now has two sections: the user code/data and the kernel code/data. This partitioning exists for every process that we have in the system.</p>
<p>Whenever a process wants to access a portion of the address space that contains kernel data or code, the process must make a system call to traverse that boundary.</p>
<p>Page tables, protection bits, and execution rings all play a role in establishing and enforcing this segregation within the address space.</p>
<h2>OS Isolation from Application Code Part 2</h2>
<p>For 32-bit Linux systems, the address space is 4GB. Of that 4GB, the lower 3GB is used for user code/data, and the top 1GB is used for the kernel.</p>
<p>Access to different portions of address space (user vs kernel) are governed the current privilege ring in which a process is currently executing.</p>
<p>In x86 systems, a process must be in ring 0 to access kernel code. If it is operating in user mode (ring 3), it can't access the kernel portion of the address space.</p>
<p>The 1GB points to the same kernel code in each process (i.e. we aren't copying code for each process that is created), but the 3GB section is unique for each process.</p>
<p>While modern operating systems create this fence between untrusted code and trusted code, older operating systems didn't do this.</p>
<p>For example, MS-DOS does not have this separation. This means that any process could alter operating system code. Clearly, this is a vulnerability of this early OS.</p>
<h2>Kernel Memory Split</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9551B5CF-1C3D-4761-8997-E558DC22A4E8.png" /></p>
<h2>Execution Privilege Level Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/71D72E8A-2857-48A2-8D0C-0B88F2A66C77.png" /></p>
<h2>Execution Privilege Level Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3716BF8E-4D50-43B3-936E-318EABBFDDB4.png" /></p>
<h2>Complete Mediation: The TCB</h2>
<p>The second requirement of the a TCB is <strong>complete mediation</strong>.</p>
<p>Complete mediation means that the TCB must be aware of any and all accesses to resources it protects.</p>
<p>How do we implement complete mediation in operating systems?</p>
<p>We have to make sure that no protected resource - for example, a memory page or a file - can be accessed without going through the kernel.</p>
<p>We can achieve this by making the kernel act as a <em>reference monitor</em> that cannot be bypassed. This means that all references to underlying resources must be resolved by the operating systems in order to be valid.</p>
<p>We just saw an example of this with address spaces. A process can only access memory once the operating system translates its virtual reference into a real, physical memory location.</p>
<h2>Complete Mediation: The User Code</h2>
<p>Protected resources are implemented by the operating system, and the data structures that are utilized to access those resources - page tables, for example - live in the kernel portion of the address space.</p>
<p>While a process is executing user code, it can't access that portion of your address space. The process will need to switch to the system mode through a system call, and this transfer of control will be mediated by the operating system itself.</p>
<p>In addition, user code cannot access physical resources directly because interacting with those resources often requires access to privileged instructions that can only be executed in system mode.</p>
<h2>Complete Mediation: OS</h2>
<p>At user level, a process has access to virtual resources and the operating system exposes APIs for how those virtualized resources can be used.</p>
<p>For example, a process doesn't access a disk block directly. Instead, the operating system performs the disk I/O, and abstracts the disk controller operations into the <em>file</em> interface, which a process can use to read from and write to files.</p>
<p>Since virtual resources are just abstractions of physical resources, there must be a translation process whereby the virtual reference resolves into a physical reference.</p>
<p>If you want to access a disk block or a page of memory for example, you have to start with a file descriptor or a virtual address, and let the OS map these references into the appropriate physical resources.</p>
<p>This level of indirection added by the operating system makes it impossible for a process to directly reference physical resources and allows the OS achieve complete mediation.</p>
<h2>Virtualization</h2>
<p>We don't have to stop at virtualizing individual physical resources. The concept of translating virtual resources into physical resources can apply to the computer system as a whole, giving rise to <a href="https://en.wikipedia.org/wiki/Virtual_machine">virtual machines</a>.</p>
<p>Virtual machines provide functionality needed to execute entire operating systems, and an intermediary known as a hypervisor manages the hardware on behalf of one (or more!) operating systems running on top of it.</p>
<p>The main motivation for virtualization comes from the fact that operating systems are large and complex, and different applications may require different underlying operating systems.</p>
<p>One use of virtualization commercially is to free users from being limited to using one operating system and be able to use multiple operating systems on the same physical system.</p>
<h2>Limiting the Damage of a Hacked OS</h2>
<p>Remember that if an operating system is compromised, all applications running on that system will be compromised because they all share and trust the OS.</p>
<p>Virtualization can help limit the damage caused by a compromised/hacked operating system.</p>
<p>In virtualized systems, we introduce a <strong>hypervisor</strong> between the hardware and the operating systems. On top of the hypervisor, we support virtual machines, which have their own operating system - called the guest operating system - which itself can support a number of applications.</p>
<p>Compromise of an OS within one virtual machine only impacts the applications running inside of that virtual machine. The applications that are running in an adjacent virtual machine atop the same hypervisor are unaffected.</p>
<p>With virtualization we can achieve isolation between virtual machines - each with their operating system - where earlier we only had isolation between processes.</p>
<p>In this case, the TCB is now the hypervisor, which manages the hardware resources on behalf of the virtual machines.</p>
<h2>Virtualization Security Layers</h2>
<p><img alt="" src="https://assets.omscs.io/notes/069815F0-839D-4E4F-AE4A-ABBF554C550C.png" /></p>
<h2>Correctness: The Final TCB Requirement</h2>
<p>Correctness is important because compromise of the OS means that an attacker has access to all the physical resources: every memory page, every block on disc, etc.</p>
<p>Meeting the correctness requirement for operating systems is really hard. Operating systems are very complex, and we've already discussed how added complexity can make security much more difficult.</p>
<p>Virtualization can help with correctness by reducing complexity. The hypervisor can be much smaller and simpler than the operating system since all it has to do is partition physical resources among virtual machines.</p>
<h2>TCB Requirements Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B91C6769-2EB6-41EC-884C-9BECF16EAA16.png" /></p>
<h2>TCB Requirements Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/449C3685-5396-4F92-A070-F09425449193.png" /></p>
<p>In this case, we have tampered with the TCB by turning off the check. The access still proceeds through the operating system, and is still technically correct (i.e. the access wasn't permitted because of a bug).</p>
<h2>Size of Security Code</h2>
<p><img alt="" src="https://assets.omscs.io/notes/D40FCB93-786B-464E-B73E-ED5EAE001FE2.png" /></p>
<h2>Size of Security Code Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A944CF7D-097D-4359-B600-BAB6F6E3BB8F.png" /></p>
<p>I think the point being made here is that the increase in complexity may be accompanied by an increase in vulnerability.</p>
<h2>Hypervisor Code Size Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/8AE1A120-4AD3-44D6-9A06-C19DB78BC670.png" /></p>
<h2>Hypervisor Code Size Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/32D8E299-1B81-442E-8468-5834F515C381.png" /></p>
<h2>Again, the argument being made here is that using a hypervisor as a TCB, with fewer lines of code than a full-fledged operating system, might be a more secure choice.</h2>
<p>id: information-security-public-key-cryptography
title: Public-Key Cryptography
course: information-security
lecture: public-key-cryptography</p>
<hr />
<h1>Public-Key Cryptography</h1>
<h2>Modular Arithmetic</h2>
<p>Both RSA and Diffie-Hellman - the most widely-used public-key algorithms - are based on number theory and use modular arithmetic - modular addition, multiplication, and exponentiation. Before we dive into the details of the algorithms themselves, let's review the basics of modular arithmetic.</p>
<p>Given a modulus $M$, $x + y \pmod M$ is equal to the remainder of $(x + y) \div M$. For example, $2 + 8 \pmod{10} = 0$, because $10 \div 10$ divides evenly whereas $3 + 8 \pmod {10} = 1$ because $11 \div 10$ yields a remainder of $1$.</p>
<p>In modular addition, a number $k$  has an inverse $k'$ such that $k + k' \pmod M = 0$. For example, for $M = 10$ and $k = 2$, $k' = 8$ because $2 + 8 \pmod{10} = 0$. Every number has an inverse under modular addition.</p>
<p>The presence of an additive inverse means that modular addition is reversible. That is, given $c = a + b \pmod M$, $a = c + b' \pmod M$ and $b = c + a' \pmod M$ . This reversibility is very convenient for encryption because we want the decryption process ideally to be the reverse of the encryption process.</p>
<p>Suppose we have plaintext $p = 3$, key $k = 2$ and encryption algorithm $p + k \pmod{10}$. Thus, ciphertext $c = 3 + 2 \pmod{10} = 5 \pmod{10} = 5$. We can decrypt $c$ using the inverse of $k$: $k'$. Since $k' = 8$,  $c + k' \pmod{10} = 5 + 8 \pmod{10} = 13 \pmod{10} = 3 = p$.</p>
<h2>Additive Inverse Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/90F567FE-9F15-4966-A205-678D05E4DF66.png" /></p>
<h2>Additive Inverse Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/E00E3BB9-A148-4AFA-8A9E-DAFA95C4DC80.png" /></p>
<p>In modular addition, a number $k$  has an inverse $k'$ such that $k + k' \pmod M = 0$. In this case, $M = 20$ and $k = 8$. Therefore, $k' = 12$ because $8 + 12 \pmod{20} = 0$.</p>
<h2>Modular Multiplication</h2>
<p>Given a modulus $M$, $x * y \pmod M$ is equal to the remainder of $(x * y) \div M$. For example, $5 * 8 \pmod{10} = 0$, because $40 \div 10$ divides evenly whereas $4 * 8 \pmod{10} = 2$ because $32 \div 10$ yields a remainder of 2.</p>
<p>In modular multiplication, a number $k$ , has an inverse $k'$ such that $k * k' \pmod M = 1$. For example, for $M = 10$ and $k = 3$, $k' = 7$ because $3 * 7 \pmod{10} = 21 \pmod{10} = 1$.</p>
<p>Not all numbers have multiplicative inverses for a given $M$. For $M = 10$, for example, 2, 5, 6, and 8 do not have multiplicative inverses.</p>
<h2>Modular Multiplication Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/89D8C09E-CF46-4E8F-8F14-B9F075C0302C.png" /></p>
<h2>Modular Multiplication Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/252A1D26-CED8-446B-B012-40592D172D03.png" /></p>
<p>In modular multiplication, a number $k$  has an inverse $k'$ such that $k * k' \pmod M = 1$. In this case, $M = 17$ and $k = 3$. Therefore, $k' = 6$ because $3 * 6 \pmod{17} =  18 \pmod{17} = 1$.</p>
<h2>Totient Function</h2>
<p>Given a modulus $M$, only the numbers that are relatively prime to $M$ have multiplicative inverses in $\pmod M$.</p>
<blockquote>
<p>Two numbers $x$ and $y$ are <em>relatively prime</em> to one another if they share no common factor other than 1. For example, 3 and 10 are relatively prime, whereas 2 and 10 - which share 2 as a common factor - are not.  </p>
</blockquote>
<p>Given $n$, we can calculate how many integers are relatively prime to $n$ using the <strong>totient function</strong>  $\phi(n)$. If $n$ is prime, $\phi(n) = n - 1$, because every number smaller than $n$ is relatively prime to $n$ because $n$ itself is prime. If $n = p * q$ and $p$ and $q$ are prime, then $\phi(n) = (p - 1) * (q - 1)$. If $n = p * q$ and $p$ and $q$ are relatively prime, $\phi(n) = \phi(p) * \phi(q)$.</p>
<h2>Totient Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/E9CACF9B-A69C-4D35-8FF1-1B8D1AC252ED.png" /></p>
<h2>Totient Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/4A80521F-0882-4BAC-A178-7A72A29A1531.png" /></p>
<p>If $n = p * q$ and $p$ and $q$ are prime, then $\phi(n) = (p - 1) * (q - 1)$. For $n = 21$, $p = 3$ and $q = 7$, $\phi(n) = (3 - 1) * (7 - 1) = 2 * 6 = 12$.</p>
<h2>Modular Exponentiation</h2>
<p>In modular exponentiation, $x^y \pmod n = x^{y \pmod{\phi(n)}} \pmod n$. If $y = 1 \pmod{\phi(n)}$, then $x^y \pmod n = x \pmod n$.</p>
<h2>Modular Exponentiation Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/DBABA778-3D5F-46BA-BF46-4AA6CBF87024.png" /></p>
<h2>Modular Exponentiation Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/7396A649-2E25-4636-9B04-532FA86DC8C6.png" /></p>
<p>We know that $x^y \pmod n = x^{y \pmod{\phi(n)}} \pmod n$. For $x = 7$, $y = 27$ and $n = 30$, $7^{27} \pmod{30} = 7^{27 \pmod{\phi(30)}} \pmod{30}$. We can calculate $\phi(30)$ as follows:  $\phi(30) = \phi(3) * \phi(10) = \phi(3) * \phi(2) * \phi(5) = 2 * 1 * 4 = 8$. Thus, $7^{27} \pmod{30} = 7^{27 \pmod 8} \pmod{30}$. If we divide 27 by 8, we are left with a remainder of 3, so $7^{27} \pmod{30} = 7^3 \pmod{30}$. $7^3 = 343$, which yields a remainder of 13 when divided by 30.</p>
<h2>RSA (Rivest, Shamir, Adleman)</h2>
<p>RSA - named after its three creators - is the most widely used public-key algorithm. RSA supports both public-key encryption and digital signature.</p>
<p>RSA bases the strength of its security on the hypothesis that <a href="https://en.wikipedia.org/wiki/Integer_factorization#Difficulty_and_complexity">factoring</a> a massive number into two primes is computationally infeasible problem to solve on a reasonable timescale using modern computers.</p>
<p>RSA supports variable key lengths, and in practice, most people use a 1024-, 2048-, or 4096-bit key. The plaintext block size can also be variable, but the value of the block - represented as a binary integer - must be smaller than the value of the key. The length of the ciphertext block is the same is the key length.</p>
<p>Here is a summary of RSA, including the key generation, encryption, and decryption steps.</p>
<p><img alt="" src="https://assets.omscs.io/notes/AEEEC797-A47E-4BB1-BFB9-6FCB86EF7F9B.png" /></p>
<p>The first step is key generation. First, we select two primes $p$ and $q$ that are at least 512 bits in size. Next, we compute $n = p * q$, and $\phi(n) = (p - 1) * (q - 1)$. Then, we select an integer $e$ that is smaller than $\phi(n)$ and relatively prime to $\phi(n)$. Finally, we calculate $d$: the multiplicative inverse of $e$, $\pmod{\phi(n)}$.</p>
<p>The public key is ${e, n}$. The private key is ${d, n}$.</p>
<p>Suppose Bob wishes to send a message $m$ to Alice that only she can read. Bob can encrypt $m$ using Alice's public key, ${e, n}$  by computing  $m^e \pmod n$. On receipt of ciphertext $C$, Alice can use her private key, ${d, n}$, and compute $C^d \pmod n$ to recover $m$.</p>
<p>RSA guarantees that only Alice can decrypt $m$ because only she has the private key that pairs with the public key used to encrypt the message.</p>
<p>Digital signature creation and verification work in a similar fashion as encryption and decryption.</p>
<p><img alt="" src="https://assets.omscs.io/notes/EAB550A1-2FF6-4308-9D09-D1DA6D461BBB.png" /></p>
<p>To create a signature $s$ for a message $m$, Alice uses her private key, ${d, n}$ to compute $m^d \pmod n$. Bob can verify Alice's signature by using her public key, ${e, n}$ to compute $s^e \pmod n$, which is equivalent to the original message  $m$.</p>
<h2>Why Does RSA Work</h2>
<p>Remember from the rules of modular exponentiation that, for a base $x$, a power $y$, a modulus $n$, $x^y \pmod n = x^{y \pmod{\phi(n)}} \pmod n$. If $y = 1 \pmod{\phi(n)}$, then $x^y \pmod n = x \pmod n$.</p>
<p>Also recall that, for a given public key, ${e, n}$ and its private key ${d, n}$, $d * e = 1 \pmod{\phi(n)}$. Thus, $x^{e * d} \pmod n = x \pmod n$.</p>
<p>To encrypt a message $m$, we compute $c = m^e \pmod n$.  To decrypt $c$, we compute $m = c^d \pmod n$. We can substitute the first expression in for $c$ in the second to get $m = (m^e \pmod n)^d \pmod n$. The right-hand side of the equation simplifies to $m^(ed) \pmod n$, which is equivalent to $m \pmod n$, which equals $m$ since $m &lt; n$.</p>
<p>Here is an example of RSA in action.</p>
<p><img alt="" src="https://assets.omscs.io/notes/0538F94D-26D1-41D3-BC5E-5D4915D0F4FB.png" /></p>
<p>The key generation step proceeds as follows. First, we select two prime numbers, $p = 17$ and $q = 11$. From these values, we can compute $n$ and $\phi(n)$, as $p * q = 187$ and $(p - 1) * (q - 1) = 160$, respectively. We select 7 as our public key $e$, as 7 and 160 are relatively prime. The private key is the multiplicative inverse of $e$, $\pmod{\phi(n)}$. The multiplicative inverse of $7 \pmod{160}$ is 23, which is our private key $d$.</p>
<p>To encrypt a plaintext $m = 88$, we compute ciphertext $C = m^e \pmod n = 88^7 \pmod{187} = 11$. To decrypt $C$, we perform $C^d \pmod n = 11^{23} \pmod{187} = 88$, which returns $m$.</p>
<h2>RSA Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0BDF0664-4A30-41C8-9EFC-CA0FEC5B9BAF.png" /></p>
<h2>RSA Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9B9F10D9-B82B-4F16-8A44-B25CCADF7491.png" /></p>
<p>$n = p * q = 11 * 3 = 33$ and $\phi(n) = (p - 1) * (q - 1) = 2 * 10 = 20$. $e$ and $d$ must be multiplicative inverses $\pmod{\phi(n)}$, so for $e = 7$, $d = 3$, since $21 \pmod{20} = 1$. Finally, public key ${e, n}$ is equal to ${7, 33}$, and private key, ${d, n}$ is equal to ${3, 33}$.</p>
<h2>RSA Encryption Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FC5100D0-A94A-46DB-8DAB-F12DF35B30E1.png" /></p>
<h2>RSA Encryption Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A38846E8-2C2B-4683-B7FF-6D847E9F23CE.png" /></p>
<p>Encrypting message $m$ involves computing  $m^e \pmod n$, which is equivalent to $2^7 \pmod{33} = 128 \pmod{33} = 29$.  Decrypting ciphertext $C$ involves computing $C^d \pmod n$, which is equivalent to $29^3 \pmod{33} = 24389 \pmod{33} = 3$.</p>
<h2>Why is RSA Secure?</h2>
<p>RSA bases its security on the hypothesis that factoring a very large number - at least 512 bits, but often in the range of 1024-4096 bits - takes an inordinately long amount of time using modern computers.</p>
<p>If someone finds an efficient way to factor a large number into primes, then the security of RSA is effectively broken. Given public key, ${e, n}$, an efficient factorization of $n$ into $p$ and $q$ allows an attacker to compute  $\phi(n)$ and the multiplicative inverse of $e$, $\pmod{\phi(n)}$. This inverse is $d$, the private key.</p>
<p>An attacker can read confidential messages and forge digital signatures against any public key if they can compute a private key in a reasonable amount of time.</p>
<h2>Issues with Schoolbook RSA</h2>
<p>One issue with RSA is that the algorithm is deterministic. For a given key, the same plaintext message always encrypts to the same ciphertext. Additionally, for specific plaintext values such as 0, 1, or -1, the ciphertext is always equivalent to the plaintext, regardless of the key used.</p>
<p>Another issue is that RSA is malleable. An attacker can induce predictable transformations in plaintext by modifying ciphertext in specific ways.</p>
<p>For example, suppose Bob sends Alice an encrypted message $c = m^e \pmod n$ using Alice's public key, ${e, n}$. The attacker intercepts $c$ and performs the transformation $c' = s^e * c$. When Alice receives this ciphertext, the decrypted result is $m' = s * m$.</p>
<p>In practice, the standard is to prepend $m$ with <a href="https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding">padding</a>, a step which addresses the issues described above.</p>
<h2>RSA in Practice Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/63B9D9AB-3440-4F75-8417-FAF749B460D8.png" /></p>
<h2>RSA in Practice Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3D62323C-0309-4B49-BEBB-E17D8C79A0BD.png" /></p>
<p>Always use standard libraries, as they have been reviewed and tested by experts in the field.</p>
<h2>Diffie and Hellman Key Exchange</h2>
<p>In the Diffie-Hellman key exchange algorithm, there are two publicly known numbers $q$ and $\alpha$. $q$ is a large prime number - at least 300 digits long - and $\alpha$ is a small <a href="https://en.wikipedia.org/wiki/Primitive_root_modulo_n">primitive root</a> of $q$.</p>
<p>Suppose two users $A$ and $B$ wish to exchange a key using Diffie-Hellman. $A$ selects a random integer $X_A &lt; q$ and computes $Y_A = \alpha^{X_A} \pmod q$. Likewise, $B$ selects a random integer $X_B &lt; q$ and then computes $Y_B = \alpha^{X_B} \pmod q$. Each side keeps its $X_<em>$ value private and sends their $Y_</em>$ value to the other side.</p>
<p>Upon receiving $Y_B$ from $B$, $A$ computes the key $k = {Y_B}^{X_A} \pmod q$. Similarly, $B$ computes the key  $k = {Y_A}^{X_B} \pmod q$ upon receiving $Y_A$ from $A$. The expressions used to compute $k$ by each party are equivalent; that is,  ${Y_B}^{X_A} \pmod q = {Y_A}^{X_B} \pmod q$. As a result of this exchange, both sides now share a secret encryption key.</p>
<p><img alt="" src="https://assets.omscs.io/notes/BFCFD977-B752-4F35-825F-8A004DDCB16C.png" /></p>
<p>The values of $X_A$ and $X_B$ are private while $\alpha$, $q$, $Y_A$, and $Y_B$ are public. If an attacker $C$ wants to compute the shared key, they must first compute either $X_B$ or $X_A$. The attacker can compute $X_B$, for example, by computing $dlog(\alpha,q)(Y_B)$, where $dlog$ is the <a href="https://en.wikipedia.org/wiki/Discrete_logarithm">discrete logarithm</a>. If $C$ can retrieve $X_B$, they can compute the shared key using $Y_A$ and $q$.</p>
<p>The security of Diffie-Hellman lies in the fact that it is infeasible to compute discrete logarithms for large primes such as $q$ using modern computers.</p>
<h2>Diffie-Hellman Example</h2>
<p>Let's walk through the Diffie-Hellman key exchange using $q = 353$ and $\alpha = 3$.</p>
<p>First, user $A$ selects a random number, $X_A &lt; q = 97$, which they keep secret, and they compute $Y_A = 3^{97} \pmod{353} = 40$. Similarly, user $B$ selects a random number $X_B &lt; q = 233$, which they also keep secret, and they compute $Y_B = 3^{233} \pmod{353} = 248$. Next, $A$ sends 40 to $B$ and $B$ sends 248 to $A$.</p>
<p>Upon receiving $Y_A$, $B$ computes $k = {Y_A}^{X_B} \pmod{353} = 40^{233} \pmod{353} = 160$. Similarly, $A$ computes $k = {Y_B}^{X_A} \pmod{353} = 248^{97} \pmod{353} = 160$. Through this exchange, both $A$ and $B$ have computed the same secret value, which they can now use to encrypt their communications.</p>
<p><img alt="" src="https://assets.omscs.io/notes/CFB8B2A7-6EAB-4774-9ED1-F7A0DE0F91D3.png" /></p>
<p>We assume that an attacker can access $Y_A$, $Y_B$, $q$, and $\alpha$. Because the numbers in this example are quite small, an attacker can feasibly compute the discrete log to retrieve either $X_B$ or $X_A$. However, as we said before, this computation becomes infeasible for the large values of $q$ used in practice.</p>
<h2>Diffie-Hellman Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0ADA9333-D62C-4A27-8DA7-799BDBAF6512.png" /></p>
<h2>Diffie-Hellman Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/AA61E589-45F8-4F17-87B5-0FCE0DD5A99D.png" /></p>
<p>Alice sends $\alpha^a \pmod q$ to Bob, which is equivalent to $5^6 \pmod{23} = 8$. Bob sends $\alpha^b \pmod q$ to Alice, which is equivalent to $5^{15} \pmod{23} = 19$.</p>
<h2>Diffie-Hellman Security</h2>
<p>In Diffie-Hellman, neither party ever transmits the shared secret encryption key $S$, nor the locally generated secrets $X_A$  and $X_B$. Since we assume that attackers can intercept any transmitted value, the lack of transmission of secret values adds to the security of the scheme.</p>
<p>We assume that an attacker can access $Y_A$, $Y_B$, $q$, and $\alpha$, since these values are transmitted. The value of local secret $X_A$ is equal to the discrete logarithm $dlog(\alpha,q)(Y_A)$. The security assumption in Diffie-Hellman is that finding the discrete logarithm is infeasible given a very large, prime $q$.</p>
<p>Of course, if this conjecture is not valid, then an adversary knowing $Y_A$, $q$, and $\alpha$ can easily compute $X_A$. With $X_A$ in hand, they can compute $S$ and effectively eavesdrop on communication between $A$ and $B$.</p>
<h2>Diffie-Hellman Limitations</h2>
<p>Suppose that Alice tells Bob to use Diffie-Hellman. The first thing that Bob has to do is compute  $Y_B$ from his local secret $X_B$, and this computation involves a very CPU-intensive exponentiation calculation.</p>
<p>If Alice is a malicious attacker, and Bob is a server, then Alice can request multiple simultaneous Diffie-Hellman sessions with Bob. These requests would cause Bob to waste many CPU cycles on exponentiation, which can result in denial of service.</p>
<p>Additionally, the sole purpose of Diffie-Hellman is key exchange. Unlike RSA, it does not offer encryption and cannot produce digital signatures.</p>
<h2>Bucket Brigade Attack, Man in the Middle (MIM)</h2>
<p>The biggest threat to the Diffie-Hellman key exchange is the <strong>bucket brigade attack</strong>, which is a type of <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">man-in-the-middle attack</a>.</p>
<p><img alt="" src="https://assets.omscs.io/notes/A89FA88C-38A3-4EFA-99C0-A48BB3DA6440.png" /></p>
<p>In this attack, Trudy intercepts the message $Y_A$ that Alice sends to Bob, and instead sends her own $Y_X$ to Bob, fooling Bob to accept this as $Y_A$. Likewise, Trudy intercepts $Y_B$ that Bob sends to Alice and instead sends her own $Y_X$ to Alice, fooling Alice to believe that $Y_X$ is actually $Y_B$.</p>
<p>The result is that the shared key that Alice computes is the shared key between Alice and Trudy. Similarly, the shared key that Bob computes is the shared key between him and Trudy. In other words, Trudy plays Bob to Alice and Alice to Bob.</p>
<p>This man-in-the-middle attack is possible because the Diffie-Hellman key exchange protocol does not authenticate Alice or Bob. There is no way for Alice to know that the message that she has received is from Bob, and vice versa.</p>
<p>There are several ways to fix this problem. For example, everyone can publish their public key to a trusted, public repository instead of sending it and risking interception and forgery.</p>
<p>Alternatively, if Alice has already published her RSA public key, she can sign $Y_A$ when she sends it to Bob. Bob can verify that $Y_A$ is really from Alice using her RSA public key.</p>
<h2>Other Public Key Algorithms</h2>
<p>The <strong>Digital Signature Standard</strong> (DSS) is based on the secure hash function <a href="https://en.wikipedia.org/wiki/SHA-1">SHA-1</a>. This algorithm is only used for digital signature, not encryption or key exchange.</p>
<p><img alt="" src="https://assets.omscs.io/notes/35F39075-CA83-4B2C-B99F-F1DAED269C35.png" /></p>
<p>While RSA is the most widely used public-key algorithm for encryption and digital signature, a competing system known as <strong>Elliptic-Curve Cryptography</strong> (ECC), has recently begun to challenge RSA. The main advantage of ECC over RSA is that it offers the same security with a far smaller bit size.</p>
<p>On the other hand, RSA has been subject to a lot of cryptanalysis work over the years. For ECC, the cryptanalysis work is still just beginning; therefore, we are not as confident in ECC as we are in RSA.</p>
<p><img alt="" src="https://assets.omscs.io/notes/20773C37-4CD4-49C2-A4A6-EC7CB7318187.png" /></p>
<h2>RSA, Diffie-Hellman Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0DE9D182-0375-4A0C-BE6C-B6ECF5D66E4A.png" /></p>
<h2>RSA, Diffie-Hellman Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/BCAE9911-0D01-456E-837C-B92CB34B8BE0.png" /></h2>
<p>id: information-security-security-protocols
title: Security Protocols
course: information-security
lecture: security-protocols</p>
<hr />
<h1>Security Protocols</h1>
<h2>Why Security Protocols</h2>
<p>A network protocol defines the rules and conventions for communications between two parties. A security protocol defines the rules and conventions for secure communications between two parties.</p>
<p>Suppose Alice and Bob want to communicate securely over the Internet. They first need to authenticate each other, so that Alice knows she is communicating with Bob and Bob knows that he is communicating with Alice.</p>
<p>Further, if they want to communicate securely, they likely want to encrypt their messages. Therefore, they need to establish and exchange keys and agree on what cryptographic operations and algorithms to use.</p>
<p>The building blocks of these security protocols are the public-key and secret-key algorithms, as well as hash functions, all of which we have previously discussed.</p>
<h2>Mutual Authentication: Shared Secret</h2>
<p>In mutual authentication, Alice needs to prove to Bob that she is Alice, and Bob needs to prove to Alice that he is Bob.</p>
<p>Suppose that Alice and Bob share a secret key <code>K_AB</code>, which only they know. Using this secret key, we can envision the following authentication protocol.</p>
<p><img alt="" src="https://assets.omscs.io/notes/6B53C586-BE9C-4F21-B901-48EB7D94938E.png" /></p>
<p>First, Alice sends a message to Bob, claiming that she is Alice. Bob response with a random value <code>r1</code>, referred to as a <strong>challenge</strong>. Alice encrypts <code>r1</code> with <code>K_AB</code> and sends the ciphertext back to Bob as a <strong>response</strong> to the challenge. When Bob receives the response, he decrypts it with <code>K_AB</code> and sees if it matches the plaintext <code>r1</code>.</p>
<p>If there is a match, Bob knows that he must be communicating with Alice, since she is the only other person with knowledge of <code>K_AB</code>. Without <code>K_AB</code>, <code>r1</code> cannot be encrypted in such a way that Bob can recover it with decryption using <code>K_AB</code>.</p>
<p>Next, Alice must authenticate Bob, and she starts by sending him a random value <code>r2</code>. Bob encrypts <code>r2</code> with <code>K_AB</code> and sends the ciphertext to Alice. Upon receiving the response from Bob, Alice decrypts the ciphertext and checks if the plaintext matches <code>r2</code>. If so, she can be confident that she is communicating with Bob.</p>
<p>Note that there are cases where only one-way authentication is required. For example, if Alice is a client and Bob is a server, Alice may need to authenticate with Bob, but Bob might not authenticate with Alice. In this case, the authentication process ends after the response to <code>r1</code> is received.</p>
<p>If Alice is a human user, then typically <code>K_AB</code> can be derived from a password hash that is known to Bob.</p>
<p>The challenge values <code>r1</code> and <code>r2</code> should not be easily repeatable or predictable; otherwise, an intruder Trudy can record the challenge and response between Alice and Bob and replay them to impersonate Alice or Bob.</p>
<p>Suppose Trudy has spent time recording the authentication messages between Alice and Bob across multiple sessions, and one of the challenge-response pairs that she recorded is  <code>{a, b}</code>. If Bob sends <code>a</code> again, Trudy can impersonate Alice by responding with <code>b</code>.</p>
<p>As another example, suppose that the challenge value always increases. Trudy can first impersonate Bob and send a large challenge value, say <code>r1 = 1000</code>, and record the response from Alice. Meanwhile, the real Bob is using a smaller value, such as <code>r1 = 950</code>. When the real Bob finally sends <code>r1 = 1000</code> sometime in the future, Trudy can replay the response she received earlier from Alice.</p>
<p>We assume that Trudy can intercept any messages delivered over the Internet, and our goal is to prevent Trudy from replaying these messages and impersonating Alice or Bob. We can achieve this goal by avoiding repeatable or predictable values for <code>r1</code> and <code>r2</code>. Typically, we use large random values.</p>
<p>Additionally, we need to protect the shared secret key <code>K_AB</code>. If Trudy can steal a copy of <code>K_AB</code> from either Alice's or Bob's machine, then she can impersonate both Alice and Bob. The security of the endpoints is as important as the security of the communication between the two endpoints.</p>
<h2>Mutual Authentication Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/80FD51E1-A56A-41ED-A67C-73513A08A815.png" /></p>
<h2>Mutual Authentication Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/6F5B4FC5-A864-4ABF-A723-74B86A03E032.png" /></p>
<h2>Mutual Authentication: Simplified</h2>
<p>The mutual authentication protocol described above takes five steps. Can we shorten it to require only the following three steps?</p>
<p><img alt="" src="https://assets.omscs.io/notes/BEFD76D4-457E-489F-ADDF-4BCBC2972D60.png" /></p>
<p>First, Alice presents her identity to Bob and sends a challenge <code>r2</code>. Bob responds with both the ciphertext of <code>r2</code> generated from <code>K_AB</code> as well as his challenge <code>r1</code>. Upon receiving the response, Alice decrypts the ciphertext using <code>K_AB</code> and validates that the plaintext matches <code>r2</code> . Third, Alice sends Bob the ciphertext of <code>r1</code>, which Bob decrypts and compares with plaintext <code>r1</code> to authenticate Alice.</p>
<p>This protocol is susceptible to a <strong>reflection attack</strong> - a kind of <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">man in the middle attack</a> - that works as follows.</p>
<p>First, Trudy impersonates Alice and sends challenge <code>r2</code> to Bob. According to the protocol, Trudy will be stuck at the final step of the exchange because she cannot encrypt the challenge <code>r1</code> sent from Bob without <code>K_AB</code>.</p>
<p>Next, Trudy opens another connection to Bob, again impersonating Alice. Trudy sends Bob the challenge <code>r1</code> that he just sent her in the first connection. Bob responds with the ciphertext for <code>r1</code> and a new challenge <code>r3</code>.</p>
<p>Remember, Trudy needed the ciphertext for <code>r1</code> to complete the authentication exchange in the first connection. She tricked Bob into responding to his own challenge in the second connection. Thus, Trudy can take the ciphertext from the second connection and send it back to Bob in the first connection.</p>
<p>This type of attack is referred to as a reflection attack because Trudy reflects Bob's challenge from the first connection back to him in the second connection.</p>
<h3>Preventing Reflection Attacks</h3>
<p>One strategy to defend against reflection attacks is to use two different shared keys: one for the initiator of the connection and one for the responder.</p>
<p><img alt="" src="https://assets.omscs.io/notes/73C4601B-1984-4FDA-839A-09802C1A3D09.png" /></p>
<p>Suppose Alice uses <code>K_AB1</code>, and Bob uses <code>K_AB2</code>. In this setup, Bob sends ciphertext encrypted using <code>K_AB2</code> and expects to receive ciphertext encrypted with <code>K_AB1</code>. Even though Trudy can intercept the challenge sent from Bob, she cannot obtain the correct ciphertext through reflection.</p>
<p>For example, if she sends him his own challenge, he will encrypt it with <code>K_AB2</code>. Unfortunately for Trudy, she needs the challenge encrypted with <code>K_AB1</code>, as this is the key used by Alice in responding to challenges from Bob. Since the challenge is encrypted with the wrong key, Trudy can't use it to impersonate Alice.</p>
<p>Another way to prevent reflection attacks is to use different challenges for the initiator and responder. For example, we can use even-numbered challenges for Alice and odd-numbered challenges from Bob.</p>
<p>Therefore, when Trudy receives a challenge <code>r1</code> from Bob, the challenge is an odd number, and she cannot reflect this challenge back to Bob since he is expecting an even number.</p>
<h2>Mutual Authentication Public Keys</h2>
<p>If Bob and Alice have each other's public key, they can use public-key cryptography for mutual authentication.</p>
<p><img alt="" src="https://assets.omscs.io/notes/77941BB4-9E0E-49F8-940F-FCC1DB862272.png" /></p>
<p>First, Alice sends Bob a challenge <code>r2</code> encrypted with Bob's public key. Upon receiving the challenge, Bob decrypts the ciphertext using his private key, and sends back the plaintext challenge <code>r2</code> along with his own challenge <code>r1</code>. <code>r1</code> is encrypted using Alice's public key.</p>
<p>When Alice receives the response from Bob, the plaintext <code>r2</code>  lets Alice know that she is communicating with Bob because only he has the private key that pairs with the public key that encrypted <code>r2</code>.</p>
<p>Alice also decrypts the ciphertext for <code>r1</code> using her private key and sends the plaintext <code>r1</code> to Bob. Bob knows that he is communicating with Alice because only Alice has the private key that pairs with the public key used to encrypt <code>r1</code>.</p>
<p>This protocol can be modified to use signing with private keys instead of encrypting with public keys.</p>
<h2>Security Protocols Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/55902D91-0F5A-4553-829E-34C88755CFFD.png" /></p>
<h2>Security Protocols Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/183F382E-5822-4207-AAB9-BA9CEC7B898B.png" /></p>
<h2>Session Keys</h2>
<p>After authentication, Alice and Bob need to establish a shared secret key for their communication session so they can securely send messages to one another.</p>
<p>Typically, Alice and Bob share a long term secret key - called a <em>master key</em> - often derived from a password. Alice can use this master key <code>K_AB</code> to encrypt a new key <code>K_S</code>, which she and Bob can use for message encryption during their current communication session.</p>
<p>Alice and Bob should establish a new shared key for each session, even though they already share a master key. If the session key is leaked or broken, the impact is limited to the current session.</p>
<p>Intuitively, the more a secret is used, the higher the chance of a leak. Therefore, we should limit the use of the long-term master secret key, and only use it at the beginning of a session for authentication and establishing the session key.</p>
<p>Suppose Alice and Bob share a master key, <code>K_AB</code>. They can establish a session key as follows. Note that the first three steps are the same as before and serve for Bob to authenticate Alice.</p>
<p><img alt="" src="https://assets.omscs.io/notes/AA0CDBE6-C036-40D1-9997-30298091B776.png" /></p>
<p>After authentication, Bob and Alice compute the same session key based on both <code>K_AB</code> and something about the current session. Incorporating information about the current session into the generation of the session key helps to ensure that the key is unique to the session.</p>
<p>Bob then encrypts the challenge <code>r</code> using this new key <code>K_S</code> and sends it to Alice. If Alice can decrypt <code>r</code> using the version of <code>K_S</code> that she generated, then she knows that she and Bob have generated the same session key, and communication can proceed.</p>
<p>Alice and Bob can also use public-key cryptography to exchange a shared session key. For example, Alice can generate a key and encrypt it with Bob's public key so that only he can decrypt it. Alice then signs the encrypted key with her private key so that Bob can verify that she genuinely sent the key.</p>
<p>As a third alternative, Alice and Bob can use the Diffie-Hellman key exchange protocol to generate and exchange their session key.</p>
<h2>Key Distribution Center (KDC)</h2>
<p>A major shortcoming of using pairwise key exchange based on a shared secret is that it doesn't scale well. For example, Alice needs to share a master key with Bob, Carol, and every other user with whom she wants to communicate.</p>
<p>A <strong>key distribution center</strong> (KDC) solves this scalability problem. In this setup, each party holds only one master key, which they share with the KDC, and the KDC holds master keys for each enrolled party. For example, Alice may share <code>K_A</code> with the KDC, and Bob might share <code>K_B</code> with the KDC. Alice and Bob individually hold only one key, while the KDC holds both <code>K_A</code> and <code>K_B</code>.</p>
<p>If Alice and Bob want to have a secure session, they must first establish a session key <code>K_S</code>. The following diagram illustrates the steps involved in this operation.</p>
<p><img alt="" src="https://assets.omscs.io/notes/BD7F7DE0-75D6-4BA0-9746-88EEDB48C28D.png" /></p>
<p>First, Alice sends a message to the KDC containing both a request for a shared session key between her and Bob as well as a random <a href="https://en.wikipedia.org/wiki/Cryptographic_nonce">nonce</a> value <code>n1</code>. The KDC sends a response encrypted using the master key <code>K_A</code> that it shares with Alice.</p>
<p>This response contains the session key <code>K_S</code> that the KDC just created for Alice and Bob to share. The response also contains the original request that Alice sent to KDC along with the nonce, <code>n1</code>. Finally, the response contains a <strong>ticket</strong>: a message containing <code>K_S</code> and Alice's ID that is encrypted using the secret key <code>K_B</code> that Bob shares with the KDC.</p>
<p>When Alice receives this response, she can decrypt it because she holds <code>K_A</code>. She can verify that the message is not a replay by comparing the received request/nonce combination with the one she generated.</p>
<p>Alice then sends the ticket to Bob, which he can decrypt because he holds <code>K_B</code>. Bob can tell that the KDC generated the ticket because only the KDC can encrypt Alice's ID using <code>K_B</code> since it is the only other party in possession of that key.</p>
<p>Next, Bob creates a message containing a nonce <code>n2</code> and his ID, encrypts it using <code>K_S</code>, and sends it to Alice. When Alice receives this message and decrypts it successfully, she knows that she is communicating with Bob because only he can decrypt the ticket and retrieve <code>K_S</code>.</p>
<p>Finally, Alice performs an agreed-upon transformation of <code>n2</code>, encrypts the result using <code>K_S</code>, and sends it back to Bob. This message proves to Bob that he is communicating with Alice because she is the only party that possesses <code>K_S</code> beside him.</p>
<h2>Exchanging Public Key Certificates</h2>
<p>A <strong>certificate authority</strong> (CA) often manages the secure distribution of public keys.</p>
<p>First, Alice sends her public key to the CA, which verifies her identification and then sends her a certificate of her public key. The certificate is signed using the CA's private key and contains the certificate creation time and period of validity, as well as Alice's ID and public key.</p>
<p>Alice can then send this certificate to a user, such as Bob, or she can publish it so that any user can retrieve it. We assume that all users have the CA's public key, and therefore that Bob can use this public key to verify the certificate and obtain Alice's public key.</p>
<p>Likewise, Bob can obtain his certificate from the CA and send it to Alice so that Alice has Bob's public key as well.</p>
<p><img alt="" src="https://assets.omscs.io/notes/B2C43DA5-BABC-4E55-B80D-0B71617D4929.png" /></p>
<h2>Session Key Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0A70D994-363F-4512-8333-3D30F130D0C3.png" /></p>
<h2>Session Key Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F44F5C79-3691-440B-B5E9-72181E40A834.png" /></p>
<h2>Kerberos</h2>
<p><strong>Kerberos</strong> is a standard protocol used to provide authentication and access control in a networked environment, such as an enterprise network.</p>
<p>Every entity in the network - every user and network resource - has a master key that it shares with the Kerberos servers, which perform both authentication and key distribution. That is, a Kerberos server functions as a KDC.</p>
<p>For human users, the master key is derived from his or her password, while for network devices, the key must be configured in. All the keys are stored securely in the KDC.</p>
<p>The following diagram summarizes the interactions that take place when Bob logs into a workstation backed by Kerberos.</p>
<p><img alt="" src="https://assets.omscs.io/notes/F30C76D4-1654-4AC1-9CD9-A709BA129ACF.png" /></p>
<p>When Bob logs in, his workstation first contacts the KDC with an authentication service request. The KDC generates a per-day session key, <code>S_B</code>, and a so-called <strong>ticket-granting ticket</strong> (TGT) that contains <code>S_B</code> and Bob's ID. This ticket is encrypted using the KDC's key.</p>
<p>The KDC then sends the authentication service response containing <code>S_B</code> and the TGT back to Bob's workstation. This message is encrypted using the master key <code>K_B</code> shared between Bob and the KDC.</p>
<p>Because <code>K_B</code> is shared only between Bob and the KDC, only Bob's local workstation can decrypt the authentication service response. After decryption, Bob's workstation stores <code>S_B</code> and the TGT.</p>
<p>Bob's local workstation uses <code>S_B</code> for subsequent messages with the KDC and includes the TGT to convince the KDC to use <code>S_B</code>. Any new tickets from the KDC are encrypted using <code>S_B</code>.</p>
<p>There are several benefits to this setup. First, Bob's localhost does not need to store his password or password hash once Bob has logged in and obtained <code>S_B</code> from the KDC.</p>
<p>Second, the master key <code>K_B</code> that Bob shares with the KDC is only used once every day when Bob initially logs in. As a result, the exposure of <code>K_B</code>, which is derived from Bob's password and is subject to password-guessing attacks, is very limited.</p>
<h2>Accessing the Printer</h2>
<p>Suppose Bob wants to send a print job to a printer <code>hp1</code>.</p>
<p><img alt="" src="https://assets.omscs.io/notes/F3B41699-2CF7-42C2-AF9C-8C47EF41D42E.png" /></p>
<p>His localhost sends a ticket-granting service request to the KDC. The request contains the TGT and an authenticator: the current timestamp encrypted using Bob's per-day session key <code>S_B</code>.</p>
<p>When the KDC receives the request, it decrypts the TGT using its private key <code>K_KDC</code>. The correct decryption of Bob's ID in the TGT verifies the validity of the TGT since only <code>K_KDC</code> could have encrypted it in the first place.</p>
<p>The KDC then uses <code>S_B</code> contained in the TGT to verify the authenticator by decrypting it and checking that the timestamp is current. This decryption verifies that Bob is the sender because only Bob has the key <code>S_B</code> that can encrypt the current timestamp properly.</p>
<p>The KDC then generates a ticket for Bob to communicate with the printer. This ticket contains a session key <code>K_BP</code> and Bob's ID, and is encrypted using the printer's master key <code>K_P</code>.</p>
<p>Note that a network device such as a printer has a long, random master key that is configured in, and is typically hard to guess or crack. Therefore, the tickets for these devices can be securely encrypted using their master keys.</p>
<p>The KDC sends a ticket-granting service response to Bob's localhost, which contains the session key <code>K_BP</code>, Bob's ID, and the ticket to the printer. The entire response is encrypted using <code>S_B</code>; therefore, only Bob's local workstation can decrypt it.</p>
<p>Now Bob's localhost can authenticate itself to the printer.</p>
<p><img alt="" src="https://assets.omscs.io/notes/C7E0F5CB-2337-437F-A99B-C91EBF3434EE.png" /></p>
<p>First, it sends an authentication request to the printer containing the ticket and a new authenticator encrypted with <code>K_BP</code>.</p>
<p>The printer decrypts the received ticket using the master key <code>K_P</code> it shares with the KDC because the KDC encrypted the ticket with that key.</p>
<p>Since the printer can verify that the KDC created the ticket - only the KDC and the printer share <code>K_P</code> - the printer can verify that the KDC created the shared key <code>K_BP</code> contained in the ticket.</p>
<p>The print server uses <code>K_BP</code> to verify the authenticator by decrypting the ciphertext and verifying that the result matches the current timestamp.</p>
<p>The printer then sends a response to authenticate itself to Bob by, say, adding 1 to the current timestamp, and encrypting it with the shared key <code>K_BP</code>.</p>
<p>After these authentication steps, Bob's localhost can send the print job to the printer.</p>
<h2>Kerberos Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0327A697-D433-41EE-B0E4-54A3F830AFC7.png" /></p>
<h2>Kerberos Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/358A47CC-D72F-4BAB-BCCD-590496B92FBF.png" /></h2>
<p>id: information-security-software-security
title: Software Security
course: information-security
lecture: software-security</p>
<hr />
<h1>Software Security</h1>
<h2>Software Vulnerabilities</h2>
<p>A common vulnerability that we are going to discuss is a <strong>buffer overflow</strong>.</p>
<p>A buffer overflow occurs when the amount of memory allocated for a piece of expected data is insufficient (too small) to hold the actual received data. As a result, the received data "runs over" into adjacent memory, often corrupting the values present there.</p>
<p>Specifically, <strong>stack buffer overflows</strong> are buffer overflows that exploit data in the <strong>call stack</strong>.</p>
<p>During program execution, a <a href="https://en.wikipedia.org/wiki/Stack_(abstract_data_type)">stack</a> data structure, known as the call stack, is maintained. The call stack is made up of <strong>stack frames</strong>.</p>
<p>When a function is called, a stack frame is pushed onto the stack. When the function returns, the stack frame is popped off of the stack.</p>
<p>The stack frame contains the allocation of memory for the local variables defined by the function and the parameters passed into the function.</p>
<p>A function call involves a transfer of control from the calling function to the called function. Once the called function has completed its work, it needs to pass control back to the calling function. It does this by holding a reference to the <strong>return address</strong>, also present in the stack frame.</p>
<p>Stack buffer overflows can be exploited through normal system entry points that are called legitimately by non-malicious users of the system. By passing in carefully crafted data, however, an attacker can trigger a stack buffer overflow, and potentially gain control over the system's execution.</p>
<h2>Vulnerable Program</h2>
<p>The following program - which roughly resembles a standard password checking program - is vulnerable.</p>
<p>```c</p>
<h1>include <stdio.h></h1>
<h1>include <strings.h></h1>
<p>int main(int argc, char *argv[]) {
    int allow_login = 0;
    char pwdstr[12];
    char targetpwd[12] = "MyPwd123";</p>
<pre><code>gets(pwdstr);
if(strncmp(pwdstr, targtpwd, 12) == 0)
    allow_login = 1;

if(allow_login == 0)
    printf("Login request rejected");
else
    printf("Login request allowed");
</code></pre>
<p>}
```</p>
<p>We have allocated space for <code>int</code> named <code>allow_login</code> that is initially set to <code>0</code>.</p>
<p>In addition, we have allocated space for a user-submitted password (<code>pwdstr</code>) and a target password (<code>targetpwd</code>).</p>
<p>We then ask the user for their password (<code>gets</code>). Their response gets read into <code>pwdstr</code> and if <code>pwdstr</code> matches <code>targetpwd</code> (via <code>strncmp</code>), we set <code>allow_login</code> to <code>1</code>.</p>
<p>Finally, if <code>allow_login</code> is <code>0</code>, we print "Login request rejected". Otherwise, we print "Login request allowed".</p>
<h2>Stack Access Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/429E7357-0C4A-4E2E-B10B-474694620410.png" /></p>
<h2>Stack Access Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1094841F-A963-4260-BA08-4E5F4BB130B5.png" /></p>
<p>Since <code>allow_login</code>, <code>pwdstr</code> and <code>targetpwd</code> are all local variables to <code>main</code>, any access of them will access memory locations inside the stack frame for <code>main</code>.</p>
<p>The only lines of code that don't access the stack frame for <code>main</code> are the calls to <code>printf</code>, (which create a new stack frame), and <code>else</code>.</p>
<h2>Understanding the Stack</h2>
<p>There are two things you can do with a stack: push and pop.</p>
<p>The stack grows when something is pushed onto it, and shrinks when something is popped off of it.</p>
<p>The current "top" of the stack is maintained by a stack pointer, which points to different memory locations as the stack grows and shrinks.</p>
<p>We can assume that the stack grows from high (numerically larger) addresses to low (numerically smaller) addresses.</p>
<p>This means that the stack pointer points to the highest memory address at the beginning of program execution, and decreases as frames are pushed onto the stack.</p>
<h2>Attacker Code Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/4E905E4F-F658-4D3E-8A95-BC7BD589593A.png" /></p>
<h2>Attacker Code Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/82AEC50D-14C8-41D9-98DB-930CF11CA87E.png" /></p>
<p>Remember that the stack pointer moves down in memory as space is allocated. This means that <code>allow_login</code> will receive memory starting at the highest feasible address, and <code>pwdstr</code> will receive memory starting at the next highest feasible address.</p>
<p>Suppose both <code>int</code> and <code>char</code> occupy 1 byte. <code>allow_login</code> may be allocated 1 byte of space starting at memory address <code>1000</code>. <code>pwdstr</code> may be allocated 12 bytes of space starting at memory address <code>988</code>.</p>
<p>If the user enters a password longer than 12 bytes, the remaining bytes will overflow into the memory allocated to <code>allow_login</code>, effectively overwriting its value.</p>
<p>Since login will succeed if <code>allow_login</code> is anything but 0 (i.e. not a fail-safe default), this overflow will almost certainly lead to access being granted.</p>
<h2>Attacker Code Execution Part 1</h2>
<p>If the attacker guesses the correct password and types that as input to the program, login will be allowed.</p>
<p>If the attacker guesses the wrong password - which fits into the allocated buffer - there will be no overflow and login will be rejected.</p>
<p>These are the two basic outcomes for a naive attack: either the attacker guesses correctly and access is granted or the attacker guesses incorrectly and access is denied.</p>
<h2>Attacker Code Execution Part 2</h2>
<p>In order to understand how an attacker can use buffer overflow to gain control of this program, we first need to look at how the data associated with this program is laid out on the stack.</p>
<p><img alt="" src="https://assets.omscs.io/notes/5B523282-ED4E-4694-9701-C7552C481019.png" /></p>
<p>We know that the stack grows from higher memory addresses to lower memory address.</p>
<p>When we make the function call to <code>main</code>, we push the arguments <code>argc</code>  (4 bytes) and <code>argv</code> (4 bytes) onto the stack.</p>
<p>Assuming the top of the stack is located at memory address <code>addr</code>, the stack pointer points to <code>addr - 8</code> after pushing these argument onto the stack.</p>
<p>Next, we have to push the return address (4 bytes) onto the stack. Every time we make a function call, we have to push the return address onto the stack so the program knows where to continue execution within the calling function once the called function completes.</p>
<p>After pushing the return address, the stack pointer points to <code>addr - 12</code>.</p>
<p>Finally, we allocate space for <code>allowLogin</code> (4 bytes), <code>pwdstr</code> (12 bytes) and <code>targetpwd</code> (12 bytes).</p>
<p>If <code>pwdstr</code> is within 12 bytes, it will occupy only the memory allocated to it. If <code>pwdstr</code> is longer than 12 bytes, it will exhaust the 12 bytes allocated to it, and will overflow into the space allocated for <code>allowLogin</code>.</p>
<p>The reason <code>pwdstr</code> overflows into <code>allowLogin</code> and not <code>targetPwd</code> is because occupation of memory occurs sequentially, from lower memory addresses to higher memory address. <em>Note: this is the opposite of the direction in which the stack grows.</em></p>
<p>If the supplied value for <code>pwdstr</code> is greater than 16 bytes, <code>pwdstr</code> will also overwrite the return address.</p>
<h2>Attacker Code Execution Part 3</h2>
<p>As an attacker, we want to direct program control to some location where the attacker can craft some code.</p>
<p>If the attacker writes more than 16 bytes to <code>pwdstr</code>, the buffer allocated to <code>pwdstr</code> will overflow and will overwrite the return address.</p>
<p>If we know the address of the code that we want to execute, we can craft our input carefully, such that the existing return address gets overwritten with the address we want.</p>
<p>If we do this, what will happen?</p>
<p>Remember, the point of the return address is to give the function a location to transfer control to when it is done executing. If we overwrite that address, the function will "return" to the address we supply and begin executing instructions from that address.</p>
<h2>Buffer Overflow Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/AF1E8B07-5821-4767-976D-54A9EE56319C.png" /></p>
<h2>Buffer Overflow Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/07B11C34-5DB8-4233-BC74-E2075631A2E1.png" /></p>
<p>The first answer is wrong. The target password can be as long as you'd like, but if the attacker submits a longer password, the overflow will still happen.</p>
<p>The third answer is also wrong. Besides the fact that you shouldn't ever really add useless variables, these variables will only provide a finite amount of distance between the user-filled buffer and the return address. With a long enough password, the attacker can still overwrite the return address.</p>
<p>Only the second answer is correct. The overflow happens precisely because input larger than the space allocated for that input is not rejected by the program.</p>
<h2>Shellcode</h2>
<p>The code that the attacker typically wants to craft is code that is going to launch a <a href="https://en.wikipedia.org/wiki/Shell_(computing)">command shell</a>. This type of code is called <strong>shellcode</strong>.</p>
<p>The execution of the shellcode creates a shell which allows the attacker to execute arbitrary commands.</p>
<p>You can write the shellcode in C, like this:
```c
int main (int argc, char <em>argv[]) {
    char </em>sh;   char *args[2];</p>
<pre><code>sh = "/bin/sh"; args[0] = sh;   args[1] = NULL;
execve(sh, args, NULL);
</code></pre>
<p>}
```</p>
<p>The "magic" here is <a href="http://man7.org/linux/man-pages/man2/execve.2.html">execve</a>, which replaces the currently running program with the invoked program - in this case, the shell at <code>/bin/sh</code>.</p>
<p>While the code can be written in C, it must be supplied to the vulnerable program as compiled machine code, because it is going to be stored in memory as actual machine instructions that will be executed once control is transferred.</p>
<h2>Shellcode Privileges</h2>
<p>The vulnerable program is running with some set of privileges before transfer is controlled to the shellcode.</p>
<p>When control is transferred, what privileges will be used?</p>
<p>The shellcode will have the same privileges as the host program.</p>
<p>This can be a set of privileges associated with a certain user and/or group. Alternatively, if the host program is a system service, the shellcode may end up with root privileges, essentially being handed the "keys to the the kingdom".</p>
<p>This is the best case scenario for the attacker, and the worst case scenario for the host.</p>
<h2>NVD Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/61204FE2-AD15-4170-BCB4-48EC8A23F6C1.png" /></p>
<h2>NVD Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FFB98B29-CFB5-4F45-8359-BC6804E3D04D.png" /></p>
<h2>Return to libc</h2>
<p>So far we have talked about stack buffer overflows. There are other variations of buffer overflows.</p>
<p>The first variation is called <strong>return-to-libc</strong>.</p>
<p>When we talked about shellcode, the goal was to overflow the return address to point to the location of our shellcode, but we don't need to return to code that we have explicitly written.</p>
<p>In <a href="https://en.wikipedia.org/wiki/Return-to-libc_attack">return-to-libc</a>,  the return address will be modified to point to a standard library function. Of course, this assumes that you will be able to figure out the address of the library function.</p>
<p>If you return to the right kind of library function  and you are able to set up the arguments for it on the stack, then you can execute any library function any parameters.</p>
<p>For example, if you point to the address of the <code>system</code> library function, and pass something like <code>/bin/sh</code>, you should be able to open a command shell.</p>
<p>The main idea with return-to-libc is that we have driven our exploit through instructions already present on the system, as opposed to supplying our own.</p>
<h2>Heap Overflows</h2>
<p>An overflow doesn't have to occur to memory associated with the stack. A <strong>heap overflow</strong> describes buffer overflows that occur in the heap.</p>
<p>One crucial difference between the heap and the stack is that the heap does not have a return address, so the traditional stack overflow / return-to-libc mechanism won't work.</p>
<p>What we have in the heap are function pointers, which can be overwritten to point to functions that we want to execute.</p>
<p>Heap overflows require more sophistication and more work than stack overflows.</p>
<h2>OpenSSL Heartbleed</h2>
<p>So far, when we have talked about buffer overflow, we have talked about writing data; specially, inputing data into some part of memory and overflowing the memory that was allocated to us.</p>
<p>Overflows don't just have to be associated with writing data. For example, if a variable has 12 bytes, but we ask to read 100 bytes, the read will continue past the original 12 bytes and return data in subsequent memory locations.</p>
<p>The <a href="https://en.wikipedia.org/wiki/Heartbleed">OpenSSL Heartbleed vulernability</a> did just this. It read past an assumed boundary (due to insufficient bounds checking) and was exploited to steal some important information - like encryption keys - that resided in adjacent memory.</p>
<h2>Defense Against Buffer Overflows</h2>
<p>Naturally, we shouldn't write code with buffer overflow vulnerabilities, but if such code is out there deployed on systems, we need to find ways to defend against attacks that exploit these vulnerabilities.</p>
<p>For instance, choice of programming language is crucial. There are languages where buffer overflows are not possible.</p>
<p>These languages:</p>
<ul>
<li>are strongly typed</li>
<li>perform automatic bounds checking</li>
<li>perform automatic memory management</li>
</ul>
<p>Languages that have these features are referred to as "safe" languages and include languages like Java and C++.</p>
<h2>Safe Languages</h2>
<p>If we choose a "safe" language, buffer overflows become impossible due to the checks the language performs at runtime.</p>
<p>For example, instead of having to perform bounds checking explicitly, programmers can rest assured knowing that the language runtime will perform the check for them.</p>
<p>So, why don't we use these languages for everything?</p>
<p>One drawback for these languages is performance degradation. The extra runtime checks slow down the execution of your program.</p>
<h2>Unsafe Languages</h2>
<p>When using "unsafe" languages, the programmer takes on the responsibility of preventing potential buffer overflow scenarios.</p>
<p>One way to do that is by checking all input to ensure that it conforms to expectations. Assume that all input is evil.</p>
<p>Another strategy to reduce the possibility of exploitation is to use safer functions that perform bounds checking for you. One such list of safe replacements for common library functions in C can be found <a href="https://github.com/intel/safestringlib/wiki/SDL-List-of-Banned-Functions">here</a>.</p>
<p>A third strategy is to use automated tools that analyze a program and flag any code that looks vulnerable.</p>
<p>These tools look for code patterns or unsafe functions and warn you which code fragments may be vulnerable for exploitation.</p>
<p>One issue with automated analysis tools is that they may have many false positives (flagging something that is not an issue), and may even have false negatives (not flagging something that is an issue). No tool should replace thoughtful programming.</p>
<p>There is no excuse for writing code that is insecure!</p>
<h2>Strongly Vs Weakly Typed Language Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/041BD85C-82D0-4D30-AABA-C35771B37CB3.png" /></p>
<h2>Strongly Vs Weakly Typed Language Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/BB9848DB-A87B-4B54-B4FE-4CDB1A596F7A.png" /></p>
<h2>Analysis Tools</h2>
<p>A number of <a href="https://www.owasp.org/index.php/Source_Code_Analysis_Tools">source code analysis</a> tools are available. These tools analyze the source code of your application, and can flag potentially unsafe constructs and/or function usage.</p>
<p>Companies will often incorporate the use of these tools into their software development lifecycle to ensure that all code headed for production is audited before being released.</p>
<p>If you are attempting to analyze code that you didn't write, you may not have the source code available, at which point source code analysis tools obviously won't be helpful.</p>
<h2>Stack Canary</h2>
<p>One of the tricks that hackers use is to override the return address on the stack to point to some other code they want to execute.</p>
<p>During the execution of a function, however, there is no reason for the return address to be modified; that is, there is no reason a function should change where it returns during the middle of its execution.</p>
<p>As a result, if we can detect that the return address has been modified, we can show that a buffer overflow is being exploited and handle execution appropriately, likely with process termination.</p>
<p>How can we detect if the return address has been modified? We can use a <strong>stack canary</strong>, or a value that we write to an address just before the return address in a stack frame. If an overflow is exploited to overwrite the return address, the canary value will be overwritten with it.</p>
<p>All the runtime has to do, then, is to check if the canary value has changed when a function completes execution. If so, it can be sure that there is a problem.</p>
<p>What is nice about this approach is that the programmer doesn't have to do anything: the compiler inserts these checks. Of course, this means that the code may have to be recompiled with a compiler that has these features, a step which may come with its own issues.</p>
<h2>ASLR</h2>
<p>There are also OS-/hardware-based solutions which can help to thwart the exploitation of buffer overflow vulnerabilities.</p>
<p>The first technique that many operating systems use is <strong>address space layout randomization</strong> (ASLR).</p>
<p>Remember that one key job of the attacker is to be able to understand/approximate how memory is laid out within the stack or, in the case of return-to-libc, within a process's address space.  </p>
<p>ASLR randomizes how memory is laid out within a process to make it very hard for an attacker to predict, even roughly, where certain key data structures and/or libraries reside.</p>
<p>Many modern operating systems provide <a href="https://en.wikipedia.org/wiki/Address_space_layout_randomization">ASLR</a> support.</p>
<h3>Non-executable stack</h3>
<p>In the classic stack buffer overflow attack, the attacker writes shellcode to the stack and then overwrites the return address to point to that shellcode, which is then executed.</p>
<p>There is no legitimate reason for programs to execute instructions that are stored on the stack. One way to block executing shellcode off the stack is to make the stack non-executable.</p>
<p>Many modern operating systems implement such <a href="https://en.wikipedia.org/wiki/Executable_space_protection">executable-space protection</a>.</p>
<h2>Buffer Overflow Attacks Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0AF6ADAD-2A2D-435A-BE02-786B77295BA2.png" /></p>
<h2>Buffer Overflow Attacks Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/618CEAB7-54EA-4819-9CE8-12CA704FC5C1.png" /></p>
<p>Stack canaries do prevent return-to-libc buffer overflow attacks, because stack canaries prevent return address overwriting. Without overwriting the return address, a function can only return to the function that called it.</p>
<p>ASLR does not protect against read-only buffer overflow exploits. ASLR only makes it harder to supply key addresses in write-based buffer overflow exploits.</p>
<h2>Heartbleed cannot be avoided by using a non-executable stack. Heartbleed is a read-based buffer overflow exploit, and the attack did not involve injecting any machine instructions onto the stack.</h2>
<p>id: information-security-symmetric-encryption
title: Symmetric Encryption
course: information-security
lecture: symmetric-encryption</p>
<hr />
<h1>Symmetric Encryption</h1>
<h2>Block Cipher Scheme</h2>
<p>Most symmetric encryption schemes are block ciphers. A <strong>block cipher</strong> encrypts a plaintext block of length <code>n</code> into a ciphertext block of length <code>n</code> using a secret key  <code>k</code> and decrypts the ciphertext using the same <code>k</code>.</p>
<p><img alt="" src="https://assets.omscs.io/notes/47BCD6ED-91B1-47D2-BF37-313E1F60D22B.png" /></p>
<h2>Block Cipher Primitives</h2>
<p>The goal of encryption is to transform plaintext into an unintelligible form. Since we assume that an attacker can obtain the ciphertext, we don't want the ciphertext to convey any information about the key or the plaintext.</p>
<p><strong>Confusion</strong> obscures the relationship between the key and the ciphertext and is typically achieved with <em>substitution</em>. Through confusion, the attacker cannot determine the key, even if they obtain the ciphertext.</p>
<p>Confusion alone is not sufficient. Even when a letter can be mapped to any other letter, an attacker can perform a statistical analysis of letter frequencies to break the scheme. For example, the most common letter in English is 'E'. If the most common letter in the ciphertext is 'Q', we can be confident that 'E' maps to 'Q'.</p>
<p>The second principle that we need is diffusion. <strong>Diffusion</strong> spreads the influence of one plaintext bit over many ciphertext bits to hide the statistical properties of the plaintext. We can achieve diffusion with <em>permutation</em>.</p>
<p>For example, instead of mapping an English letter to another English letter, we can map a letter to parts of many 8-bit letters. This approach renders the frequency distribution of English letters less useless.</p>
<p>We need this combination - confusion and diffusion - to affect every bit in the ciphertext, so a block cipher typically runs for multiple rounds. The initial round affects some parts of the ciphertext, and subsequent rounds further propagate these effects into other parts of the ciphertext. Eventually, all bits of ciphertext are affected.</p>
<h2>Block Cipher Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F77DC130-7DC8-46BD-A0EF-6A05F934BF23.png" /></p>
<h2>Block Cipher Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/5A22576A-05B2-48C1-AE69-874601220654.png" /></p>
<h2>Data Encryption Standard</h2>
<p>A widely used symmetric encryption scheme is based on the <strong>Data Encryption Standard</strong> (DES), which was established in 1977 and standardized in 1979.</p>
<p><img alt="" src="https://assets.omscs.io/notes/5CC2B27E-728F-44B1-871D-3CBDC4BAE48F.png" /></p>
<p>In DES, the key is 64 bits (8 bytes) long. For each byte, there is one parity bit, so the actual value of the key is only 56 bits. DES receives a 64-bit plaintext block as input and produces a 64-bit ciphertext block.</p>
<p>DES contains an initial and final permutation step that remaps the positions of the bits to achieve diffusion.</p>
<p><img alt="" src="https://assets.omscs.io/notes/3FB71F34-AB14-415C-8AE1-31FF22CDD047.png" /></p>
<p>In between the permutation steps, DES performs 16 rounds of operations using 16 48-bit subkeys generated from the original 56-bit key. Each round receives as input the ciphertext produced by the previous round and outputs the ciphertext used as input by the next round.</p>
<p>A round proceeds as follows. First, the 64-bit input is divided into two 32-bit halves. The output left half is simply the input right half. The output right half is the XOR of the input left half, and the output of a mangler function applied to the input right half.</p>
<p>The mangler function receives a 32-bit input, expands it to 48 bits, XORs it with the 48-bit per-round key, and then passes it to an S-box to substitute the 48-bit value back into a 32-bit value.</p>
<p><img alt="" src="https://assets.omscs.io/notes/34020DAC-7E9B-4405-8526-DE29767A7FA9.png" /></p>
<p>The decryption process performs the same operations as the encryption process but uses the keys in reverse order. That is, the first decryption step uses the sixteenth key, and the final step uses the first key.</p>
<h2>Decryption</h2>
<p>DES is a <a href="https://en.wikipedia.org/wiki/Feistel_cipher">Fiestel cipher</a>, which means that encryption and decryption differ only in key schedule. In decryption, we apply the same operations as we do in encryption, but with a reverse key sequence. Formally, round <code>l</code> of decryption uses subkey <code>16 - l + 1</code>.</p>
<p>Since each encryption round swaps the right and left halves of the input, the input to each decryption round is the swap of the input. However, since each decryption round performs the same operations as encryption, the decryption input is swapped to recover the original encryption input.</p>
<p>After 16 rounds of decryption, the algorithm has recovered the right and left halves of the original plaintext, and the final swap arranges the halves in the correct order.</p>
<h2>XOR Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/E6D8649E-9459-4BE3-8091-6B4FB8C456FF.png" /></p>
<h2>XOR Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9E317675-DB11-4A1E-AAC8-D59F6667ABB9.png" /></p>
<p>"H" has an ASCII code of 72, which maps to <code>0b01001000</code>, and "i" has an ASCII code of 105, which maps to <code>0b01101001</code>. "F" maps to 15 (<code>0b1111</code>) and "A" maps to 11 (<code>0b1001</code>), so "FA" maps to <code>0b11111001</code> and "F2" maps to <code>0b11111001</code>.</p>
<p>We XOR two numbers bit-by-bit, and we return 0 when the bits match and 1 otherwise. Therefore <code>0b0100100001101001</code> XOR <code>0b1111100111110010</code> is <code>0b1011000110011011</code>.</p>
<h2>Mangler Function</h2>
<p>The <strong>mangler function</strong> performs the bulk of the processing in a DES round. It expands the right half of the input from 32 bits to 48 bits and XORs it with the per-round key. The result is substituted back into a 32-bit value, which the function then permutates.</p>
<p><img alt="" src="https://assets.omscs.io/notes/5DC76BA7-E969-4935-8B3D-2F4400C34696.png" /></p>
<h2>S Box</h2>
<p>An <strong>S-box</strong> substitutes a 6-bit value with a 4-bit value using a predefined lookup table. DES uses 8 such S-boxes to substitute a 48-bit (6<em>8) value with a 32-bit (4</em>8) value. We can perform the substitution of a 6-bit value by using the outer two bits to look up the row of the S-box and the inner four bits to look up the column.</p>
<p><img alt="" src="https://assets.omscs.io/notes/39565F8B-7E22-4EFA-8636-5F496968C397.png" /></p>
<h2>S Box Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/47A34B5B-85A1-45EE-BB2F-07EC4B1A59AB.png" /></p>
<h2>S Box Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0C60D9C2-1E8B-45D3-8410-8C63C9F1FDE8.png" /></p>
<h2>Security of DES</h2>
<p>The key size in DES is 56 bits, so there are only <code>2^56</code> possible keys. This keyspace is too small, and an attacker can use brute-force to find the correct key relatively easily using today's computers.</p>
<p>Another issue with DES is that the design criteria for the S-boxes have been kept secret. On the one hand, the S-boxes are resistant to attacks that were published years after DES was published, which indicates the security of the design. On the other hand, because the design criteria have been kept secret, one might wonder if the designer of DES knew about these attacks years before they were published.</p>
<p>One could argue that the designer should have published the design criteria so that researchers could review them and improve upon them.</p>
<h2>Triple DES</h2>
<p>To overcome the small keyspace that renders DES insecure, we can run DES multiple times, using a different key each time. The standard is to run it three times, and the resulting scheme is called <strong>triple DES</strong>.</p>
<p>To encrypt plaintext using triple DES, we first run the encryption process with key <code>k1</code>, followed by the decryption process with a second key <code>k2</code>, followed by the encryption process with a third key <code>k3</code>. To decrypt a ciphertext, we run the process in reverse, decrypting with <code>k3</code>, encrypting with <code>k2</code>, and decrypting again with <code>k1</code>.</p>
<p><img alt="" src="https://assets.omscs.io/notes/94B5C99F-3DE9-4735-B910-C7F33289CCF0.png" /></p>
<p>This order of operations is advantageous because it supports multiple key lengths. For example, if <code>k1</code> and <code>k3</code> are equal, the result is 112-bit DES. If all three keys are different, the effective key length is 168 bits.</p>
<p>Additionally, if we set <code>k2</code> equal to <code>k1</code>, then triple DES has essentially become single DES using <code>k3</code>. Using this configuration, we can allow DES and triple DES to communicate with one another.</p>
<h2>DES Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FCF98268-BDC4-48AA-8E11-39B427244D6B.png" /></p>
<h2>DES Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3233B23D-A5CA-4E0E-9818-C9FC4773221C.png" /></p>
<h2>Advanced Encryption Standard</h2>
<p>Key length is a significant shortcoming of DES. At 56 bits long, the keyspace for DES is too small, and an attacker can use brute force to find a key with the power of modern computers. While we can use triple DES to increase the key length, running DES three times is not an efficient approach.</p>
<p>The replacement for DES is the <strong>Advanced Encryption Standard</strong> (AES). Like DES, AES is a block cipher. Whereas in DES, the input plaintext block is 64-bit, it is 128-bit in AES. In DES, the key length is only 56-bit, but in AES, the key can be 128, 192, or 256 bits long. Researches consider these key lengths long enough to defeat brute force attempts.</p>
<p>The following diagram presents a high-level overview of AES.</p>
<p><img alt="" src="https://assets.omscs.io/notes/6D5708D5-B97E-47AD-A97A-9A92F52ECAAB.png" /></p>
<p>Each block of plaintext that AES operates on is represented as a square matrix called the <em>state array</em>. This array is first XORed with a per-round key before going through multiple rounds of encryption.</p>
<p>In each round, the state array passes through several operations - <code>SubBytes</code>, <code>ShiftRows</code>, and <code>MixColumns</code> - which represent substitution and permutation. The transformed value of the state array is XORed with the per-round key and then passed as input to the next round. The final round, which excludes the <code>MixColumns</code> step, produces the ciphertext.</p>
<p>In AES, the decryption process runs the encryption process in the reverse direction, which means that each of the applied operations must be reversible.</p>
<p>Adding the per-round key involves the XOR operation, which by itself is reversible. The decryption process uses an inverse function to reverse the other operations: <code>SubBytes</code>, <code>ShiftRows</code>, and <code>MixColumns</code>. Since each operation is reversible, the entire process is reversible, and we can recover the plaintext from the ciphertext.</p>
<h2>AES Round</h2>
<p>Let's take a closer look at each round of AES and the transformations the algorithm performs on the state matrix <code>S</code>. Each operation updates the value of <code>S</code> directly.</p>
<p><img alt="" src="https://assets.omscs.io/notes/97074222-8C31-4E0D-A0CF-52ED8BB349B2.png" /></p>
<p>First,  <code>SubBytes</code> uses S-boxes to perform a byte-by-byte substitution. Next,  <code>ShiftRows</code> permutates <code>S</code> by shifting the bytes in each row of  <code>S</code>  a specified amount. Then, <code>MixColumns</code> substitutes each byte in a column as a function of all the bytes in the column. Finally, <code>AddRoundKey</code> XORs <code>S</code> with the per-round key, passing the final value of <code>S</code>  to the next encryption round.</p>
<h2>AES Encryption Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/194759AE-0DA0-4C26-87D6-66A9E764598A.png" /></p>
<h2>AES Encryption Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A427A006-090C-4F5B-AA31-32FBA20D10C3.png" /></p>
<h2>Encrypting a Large Message</h2>
<p>A block cipher takes in a fixed-length data block as input: 64 bits in DES and 128 bits in AES. If we want to encrypt a much bigger message, the solution seems obvious: break the message into fixed-size blocks, apply the cipher to each block, and combine the resulting ciphertexts.</p>
<p>The simplest method for encrypting large messages is to use an <strong>electronic codebook</strong> (ECB).</p>
<p><img alt="" src="https://assets.omscs.io/notes/86F29C4B-6856-4A55-96D4-DDCA012A21F8.png" /></p>
<p>First, the original large message is broken down into fixed-size blocks. The final block is potentially padded if it is smaller than the block size. Each plaintext block is then encrypted using the same key, and the collection of ciphertext blocks is the ciphertext of the original message.</p>
<p>For a given key, there is a unique ciphertext block for every plaintext block. We can construct a large codebook - hence the name - in which there is an entry mapping every possible plaintext block to its ciphertext. In practice, the codebook only contains entries for the plaintext blocks used by the application.</p>
<h2>ECB Problem #1</h2>
<p>There are significant shortcomings with the ECB approach, which make it a weak candidate for ensuring confidentiality.</p>
<p>For a given key, two identical plaintext blocks produce identical ciphertext blocks. As long as the same key is in use, this parity exists within a message and across distinct messages.</p>
<p>Cryptanalysts can exploit this consistency. For example, if an analyst knows that a message always starts with specific predefined fields, then they might immediately have several known plaintext/ciphertext pairs to aid their analysis.</p>
<p>Cryptanalysts can also leverage repetitive elements in a message. Whenever they see two identical ciphertext blocks, they know that the corresponding plaintext blocks are the same.</p>
<p>If they obtain a plaintext block for a ciphertext block, they can be sure that if they see the same ciphertext block again - assuming the key hasn't changed - that it decrypts to the plaintext block in their possession.</p>
<h2>ECB Problem #2</h2>
<p>Another problem with ECB is that the plaintext blocks are independently encrypted. An attacker can potentially rearrange inflight ciphertext blocks or substitute in a previously captured block for one currently being transmitted. Either way, an attacker can compromise message integrity as a result of the independent encryption scheme used by ECB.</p>
<h2>Cipher Block Chaining</h2>
<p>The most widely-used approach for encrypting a large message is <strong>cipher block chaining</strong> (CBC).</p>
<p><img alt="" src="https://assets.omscs.io/notes/61A73F61-DD7D-4826-B20A-DCA38D7FFD90.png" /></p>
<p>In CBC, the input to the encryption algorithm is the result of XORing the previous ciphertext block with the current plaintext block. To encrypt the first plaintext block, we XOR the block with an <strong>initialization vector</strong> (IV), which we then encrypt to produce the first ciphertext block.</p>
<p>This process is structured such that each ciphertext block incorporates information from all the previous ciphertext blocks. As a result, determining the plaintext block just by looking at the corresponding ciphertext block becomes very difficult.</p>
<p>More importantly, if two plaintext blocks are the same, the ciphertext blocks are not likely to be the same. Additionally, if an attacker tries to rearrange the ciphertext blocks or substitute one block for another, the ciphertext will not decrypt correctly into the plaintext.</p>
<p>Decryption works similarly. CBC decrypts a ciphertext block and then XORs the result with the previous ciphertext block to produce the current plaintext block.</p>
<p><img alt="" src="https://assets.omscs.io/notes/AB210D64-377D-423A-9950-C76B58C70784.png" /></p>
<p>The first decrypted ciphertext block must be XORed with the IV to produce the first plaintext block, which means that the IV must be known to both parties.</p>
<h2>Protecting Message Integrity</h2>
<p>While we usually discuss encryption as a method for providing confidentiality, we can also use encryption to ensure message integrity. In other words, encryption can surface unauthorized modifications to messages.</p>
<p>One approach for providing message integrity is to send the last block of CBC - the CBC <em>residue</em> - along with the plaintext. If an attacker intercepts the message and modifies the plaintext, they cannot recompute the CBC residue since they do not have the encryption key. Thus, they are forced to send the modified plaintext with the original residue.</p>
<p>When the authorized recipient receives the message, they will run the message through CBC to produce the residue. Since the plaintext has changed inflight, but the residue has not, the recipient's computed residue will not match the received residue. Therefore, the receiver will know that an unauthorized party has modified the plaintext.</p>
<h2>Protecting Message Confidentiality and Integrity</h2>
<p>To protect both message confidentiality and integrity, we should use two separate keys and two encryption rounds: one key produces the ciphertext, and the other key produces the CBC residue. Alternatively, we can first compute a hash of the message, append the hash to the message, and then encrypt the entire entity.</p>
<h2>CBC Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/DBF9FA91-292C-4847-ABFB-2C1166D0D5CA.png" /></p>
<h2>CBC Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/5146C532-57F6-4F41-9D3E-2512206871DE.png" /></h2>
<p>id: information-security-the-security-mindset
title: The Security Mindset
course: information-security
lecture: the-security-mindset</p>
<hr />
<h1>The Security Mindset</h1>
<h2>Why Cyber Security?</h2>
<p>Before considering why we care about cyber security, it's important to understand why we would care about security in general.</p>
<p>Essentially, we worry about security when we have something of value which is at risk of being harmed.</p>
<p>In order to understand the importance of cyber security, we need to consider the digital assets that we maintain and the threats those assets face.</p>
<p>For example, individuals store a lot of sensitive data online, such as financial information and medical information. If criminals get their hands on this data, they can monetize it and profit from it.</p>
<p>More broadly, communities rely on the internet for critical resources, making them attractive targets for adversaries.</p>
<p>Smart grids, which control the electrical power generation and distribution, are one such community asset. If computers control the smart grid, then whoever controls those computer controls an extremely important resource.</p>
<p>At a more general level, businesses and governments use the internet to carry out their daily activities, many of which involve storing proprietary and/or classified information. If hackers or adversaries gain access to this information, the consequences could be economically or politically disastrous.</p>
<h2>Security Impact Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/Screen%20Shot%202019-08-20%20at%208.42.25%20PM.png" /></p>
<h2>Security Impact Quiz Solution</h2>
<p>No one right solution. I think the important thing to understand here is that no company is safe from a breach, and many companies that we interact with on a daily basis have suffered security breaches.</p>
<h2>Cyber Assets at Risk</h2>
<p>In order to define the security mindset, we need to consider:</p>
<ul>
<li>Threats (who are the bad actors?)</li>
<li>Vulnerabilities (what weaknesses can they exploit?)</li>
<li>Attack (how will the bad actors exploit the weaknesses?)</li>
</ul>
<p>A <strong>threat source</strong> refers to an individual or entity that wishes to do us harm in our online lives.</p>
<p><strong>Cybercriminals</strong> want to profit from our sensitive data for financial gain.</p>
<p><strong>Hacktivists</strong> mount attacks in accordance with some political or philosophical agenda (think Edward Snowden).</p>
<p><strong>Nation states</strong> thwart cyber security in order to gain political advantage through espionage.</p>
<h2>Vulnerabilities and Attacks</h2>
<p>Threat actors exploit vulnerabilities to launch attacks.</p>
<p>An example of a vulnerability is a weak password. A threat actor can likely guess a weak password, and use that password to <em>compromise</em> your account.</p>
<p>If the threat actor is able to compromise an entire digital system instead of just a single account - by gaining access to a centralized server or database, for example - we refer to this compromise as a <em>security breach</em>.</p>
<p>An <strong>attack</strong> is a successful exploitation of a vulnerability by a threat source, resulting in a system that has been compromised.</p>
<p>Unfortunately, vulnerabilities are very hard to get rid of completely. They are found in software, networks and, frequently, humans.</p>
<h3>Trivial Example</h3>
<p>Many of us ride our bikes.</p>
<p>Our bikes are an important asset to us: they cost money and they help us get around. In addition, there are threats against bikes. People steal bikes.</p>
<p>If you just leave a bike lying around, it is seriously vulnerable. Someone can just pick it up and walk away.</p>
<p>One way we can chose to protect our bike is by locking it - by the wheel - to a sturdy or heavy object.</p>
<p>In this case, the thief is not going to fight the security you have in place (the lock), but rather will unscrew the lock from the frame and walk away with the bike minus the wheel.</p>
<p>The vulnerability we have here is that while we have secured the wheel, we have left the rest of the bike (which is still valuable) unsecured.</p>
<p>We never realized that we had to protect more than just the wheel.</p>
<h2>A Real World Example</h2>
<p>The <a href="https://en.wikipedia.org/wiki/History_of_Target_Corporation#2013_security_breach">Target data breach</a> of 2013 is one of the most widely publicized security breaches.</p>
<p>When thinking about security breaches there are different questions to ask:</p>
<ul>
<li>What is of value?</li>
<li>What is the threat source?</li>
<li>What vulnerability was exploited?</li>
</ul>
<p>In this attack, the information of value was credit card data that was available on the point-of-sale systems present in Target stores.</p>
<p>The threat source was cybercriminals wishing to profit off of this information.</p>
<p>In this case, the vulnerability was human.</p>
<p>The attack began with a <a href="https://en.wikipedia.org/wiki/Phishing">phishing</a> message sent to a member of the HVAC company that was contracting for Target. Through the phishing attacks, the criminals were able to get credentials to get onto Target's network, at which point they were able to install malware on the point-of-sale systems in order to siphon off the credit card numbers.</p>
<h2>Black Market Prices Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/E8C3B157-9CC2-43BB-B761-89A237C8A7E5.png" /></p>
<h2>Black Market Prices Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/E405BEDE-4306-4A65-91C9-AD0296201E67.png" /></p>
<p>I think the point here is not to remember the exact numbers, but rather to understand that this information can be purchased relatively cheaply. This makes sense given that millions of records can be retrieved in a single breach.</p>
<h2>Sony Pictures Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3430D19A-B3A4-4978-B9D1-D2CCFFBB7676.png" /></p>
<h2>Sony Pictures Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/E35AAD32-24F6-494C-A37F-8DF068591D26.png" /></p>
<p>Read more <a href="https://en.wikipedia.org/wiki/Sony_Pictures_hack">here</a></p>
<h2>Revisiting Threats, Vulnerabilities and Risk</h2>
<p>The following diagram succinctly illustrates the relationship between assets,  vulnerabilities, threats, and risk.</p>
<p><img alt="" src="https://assets.omscs.io/notes/CCD7D070-44CA-4A73-B2A5-7C5D08503901.png" /></p>
<h2>What Should We Do in Cyber Security?</h2>
<p>There are different things that we can hope to achieve in the field of cyber security.</p>
<p>First, we can try to make threats go away. This is not an easy feat to achieve, but we can try to discourage criminal activity by introducing computer abuse laws.</p>
<p>We can reduce vulnerabilities, but we are never going to have zero vulnerabilities. Complex systems are error-prone, and some of those errors will expose vulnerabilities that can be exploited.</p>
<p>Alternatively, we can strive to meet various security requirements of sensitive information. The most common requirements are confidentiality, integrity, and availability.</p>
<p>If the data is sensitive in the sense that it cannot be disclosed to unauthorized parties, then a <strong>confidentiality</strong> requirement is present.</p>
<p>If no one should be able to modify or corrupt the data, the data is said to have an <strong>integrity</strong> requirement.</p>
<p>If the data is critical in the sense that we must always have access to it - your bank account data, for instance - then the data has an <strong>availability</strong> requirement.</p>
<p>These three requirements comprise the <strong>CIA triad</strong>.</p>
<p>While these three requirements are primarily concerned with the data aspects of cyber security, cyber attacks can also have physical consequences. The most well-known case of this is <a href="https://en.wikipedia.org/wiki/Stuxnet">Stuxnet</a>.</p>
<h2>Security Requirements Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/38ACE867-7D38-47CD-A9BB-52AA9B654980.png" /></p>
<h2>Security Requirements Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/1ED304D4-8E4A-43E3-9209-62B58C7AD5E5.png" /></p>
<p>Since data breaches involve the disclosure of information to unauthorized parties, these breaches violate confidentiality.</p>
<h2>What Should the Good Guys Do?</h2>
<p>The good guys have many different jobs.</p>
<p>We have to worry about <em>prevention</em>, which means keeping the bad guys out of our systems.</p>
<p>Since prevention is not guaranteed, we want to <em>detect</em> the inevitable compromise as quickly as possible.</p>
<p>After detection, we must make sure that we <em>respond</em> to the compromise, which may include <em>recovery</em> of lost or corrupted data.</p>
<p>Finally, we must provide some <em>remediation</em> to ensure that the same attack doesn't happen again.</p>
<p>Cybersecurity consists of <em>policies</em>, which describe what needs to be done on each of these fronts, and <em>mechanisms</em>, which describe how the policies will be carried out.</p>
<h2>Losses Due to Cyber Crime Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/015A31E9-BB3F-4406-A5CD-A4A246C12321.png" /></p>
<h2>Losses Due to Cyber Crime Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0405619E-94F9-42E9-8E7F-5CB07EB9CBF2.png" /></p>
<h2>How Do We Address Cyber Security?</h2>
<p>One way to reduce vulnerability is to follow design principles that are good for security.</p>
<p><strong>Economy of mechanism</strong> means the design of security measures built into the system should be as simple and small as possible.</p>
<p><strong>Fail-safe default</strong> means that access decisions should be explicitly granted rather than explicitly denied. The default situation is lack of access, and the security controls identify conditions under which access is granted.</p>
<p><strong>Complete mediation</strong> says that every access to a resource must be checked against the access controls. No access should proceed unmonitored.</p>
<p><strong>Open design</strong> means the design of a security mechanism - for example, encryption algorithms - should be open rather than secret. Security by obscurity is a false promise.</p>
<p><strong>Least privilege</strong> means that every process or user of the system should operate with the least set of privileges required to perform a task. This ensures that damage inflicted by a corrupted user or process is contained.</p>
<p><strong>Psychological acceptability</strong> means that security mechanisms should not interfere unduly with the work of users, while at the same time meet the needs of those who authorize access. Security mechanisms that excessively hinder the usability or accessibility of resources are likely to be turned off.</p>
<p>These principles come from the paper <a href="http://www.cs.cornell.edu/courses/cs513/2005fa/NL02.html">Design Principles for Secure Systems</a></p>
<h2>Security Mindset Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/980D23F6-7ADD-4C3A-BB92-FA6FD53BF9E7.png" /></p>
<h2>Security Mindset Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/D8E63E79-4288-4ECA-97E1-CA3270A46652.png" /></h2>
<p>id: information-security-udacity-quizzes
title: Udacity Quizzes
course: information-security
lecture: udacity-quizzes</p>
<hr />
<h1>Udacity Quizzes</h1>
<h2>The Security Mindset</h2>
<h3>Security Impact Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/Screen%20Shot%202019-08-20%20at%208.42.25%20PM.png" /></p>
<h3>Security Impact Quiz Solution</h3>
<p>No one right solution. I think the important thing to understand here is that no company is safe from a breach, and many companies that you interact on a daily basis have suffered breaches.</p>
<h3>Black Market Prices Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/E8C3B157-9CC2-43BB-B761-89A237C8A7E5.png" /></p>
<h3>Black Market Prices Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/E405BEDE-4306-4A65-91C9-AD0296201E67.png" /></p>
<p>I think the point here is not to remember the exact numbers, but rather to understand that this information can be purchased relatively cheaply. This makes sense given that millions of records can be retrieved in a single breach.</p>
<h3>Sony Pictures Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3430D19A-B3A4-4978-B9D1-D2CCFFBB7676.png" /></p>
<h3>Sony Pictures Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/E35AAD32-24F6-494C-A37F-8DF068591D26.png" /></p>
<p>Read more <a href="https://en.wikipedia.org/wiki/Sony_Pictures_hack">here</a></p>
<h3>Security Requirements Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/38ACE867-7D38-47CD-A9BB-52AA9B654980.png" /></p>
<h3>Security Requirements Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1ED304D4-8E4A-43E3-9209-62B58C7AD5E5.png" /></p>
<p>Since data breaches involve the disclosure of information to unauthorized parties, these breaches violate confidentiality.</p>
<h3>Losses Due to Cyber Crime Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/015A31E9-BB3F-4406-A5CD-A4A246C12321.png" /></p>
<h3>Losses Due to Cyber Crime Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0405619E-94F9-42E9-8E7F-5CB07EB9CBF2.png" /></p>
<h3>Security Mindset Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/980D23F6-7ADD-4C3A-BB92-FA6FD53BF9E7.png" /></p>
<h3>Security Mindset Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D8E63E79-4288-4ECA-97E1-CA3270A46652.png" /></p>
<h2>Software Security</h2>
<h3>Stack Access Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/429E7357-0C4A-4E2E-B10B-474694620410.png" /></p>
<h3>Stack Access Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1094841F-A963-4260-BA08-4E5F4BB130B5.png" /></p>
<p>Since <code>allow_login</code>, <code>pwdstr</code> and <code>targetpwd</code> are all local variables to <code>main</code>, any access of them will access memory locations inside the stack frame for <code>main</code>.</p>
<p>The only lines of code that don't access the stack frame for <code>main</code> are the calls to <code>printf</code>, (which create a new stack frame), and <code>else</code>.</p>
<h3>Attacker Code Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/4E905E4F-F658-4D3E-8A95-BC7BD589593A.png" /></p>
<h3>Attacker Code Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/82AEC50D-14C8-41D9-98DB-930CF11CA87E.png" /></p>
<p>Remember that the stack pointer moves down in memory as space is allocated. This means that <code>allow_login</code> will receive memory starting at the highest feasible address, and <code>pwdstr</code> will receive memory starting at the next highest feasible address.</p>
<p>Suppose both <code>int</code> and <code>char</code> occupy 1 byte. <code>allow_login</code> may be allocated 1 byte of space starting at memory address <code>1000</code>. <code>pwdstr</code> may be allocated 12 bytes of space starting at memory address <code>988</code>.</p>
<p>If the user enters a password longer than 12 bytes, the remaining bytes will overflow into the memory allocated to <code>allow_login</code>, effectively overwriting its value.</p>
<p>Since login will succeed if <code>allow_login</code> is anything but 0 (i.e. not a fail-safe default), this overflow will almost certainly lead to access being granted.</p>
<h3>Buffer Overflow Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/AF1E8B07-5821-4767-976D-54A9EE56319C.png" /></p>
<h3>Buffer Overflow Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/07B11C34-5DB8-4233-BC74-E2075631A2E1.png" /></p>
<p>The first answer is wrong. The target password can be as long as you'd like, but if the attacker submits a longer password, the overflow will still happen.</p>
<p>The third answer is also wrong. Besides the fact that you shouldn't ever really add useless variables, these variables will only provide a finite amount of distance between the user-filled buffer and the return address. With a long enough password, the attacker can still overwrite the return address.</p>
<p>Only the second answer is correct. The overflow happens precisely because input larger than the space allocated for that input is not rejected by the program.</p>
<h3>NVD Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/61204FE2-AD15-4170-BCB4-48EC8A23F6C1.png" /></p>
<h3>NVD Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FFB98B29-CFB5-4F45-8359-BC6804E3D04D.png" /></p>
<h3>Strongly Vs Weakly Typed Language Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/041BD85C-82D0-4D30-AABA-C35771B37CB3.png" /></p>
<h3>Strongly Vs Weakly Typed Language Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/BB9848DB-A87B-4B54-B4FE-4CDB1A596F7A.png" /></p>
<h3>Buffer Overflow Attacks Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0AF6ADAD-2A2D-435A-BE02-786B77295BA2.png" /></p>
<h3>Buffer Overflow Attacks Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/618CEAB7-54EA-4819-9CE8-12CA704FC5C1.png" /></p>
<p>Stack canaries do prevent return-to-libc buffer overflow attacks, because stack canaries prevent return address overwriting. Without overwriting the return address, a function can only return to the function that called it.</p>
<p>ASLR does not protect against read-only buffer overflow exploits. ASLR only makes it harder to supply key addresses in write-based buffer overflow exploits.</p>
<p>Heartbleed cannot be avoided by using a non-executable stack. Heartbleed is a read-based buffer overflow exploit, and the attack did not involve injecting any machine instructions onto the stack.</p>
<h2>Operating System Security</h2>
<h3>Secure OS Quiz 1</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3E4E1A33-04F6-49C8-A8BE-5C9B97CD9F46.png" /></p>
<p><a href="https://usa.kaspersky.com/resource-center/threats/mac-vs-pc#.VRLACxDF-Hw">Mac vs PC Security</a></p>
<h3>Secure OS Quiz 1 Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A47F089A-E76B-45FB-8EAB-67A1410CD42A.png" /></p>
<h3>Secure OS Quiz 2</h3>
<p><img alt="" src="https://assets.omscs.io/notes/8FB30729-124D-4073-9C7B-E9B8BE6B98AE.png" /></p>
<h3>Secure OS Quiz 2 Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/14FB0734-2CED-4A50-97FE-789C608E61C3.png" /></p>
<p>A system call requires control transfer from the calling process into the OS, which then must perform authentication/authorization checks before granting access and transferring control back.</p>
<p>This is more costly than a regular call, which incurs none of this overhead.</p>
<h3>Secure OS Quiz 3</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B1E759C2-2BDC-4F1D-87CC-D0FF65033E40.png" /></p>
<h3>Secure OS Quiz 3 Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/9F2E641A-BA27-4DEB-8754-E4C12B164432.png" /></p>
<p>Processes run on behalf of users. Users must login to the system to run applications/processes.</p>
<h3>User Isolation Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/65EE949F-30AB-462D-ABAF-766E03061E1B.png" /></p>
<h3>User Isolation Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2CF867D1-BB5E-4D7F-A303-4A6F0A5CC1AD.png" /></p>
<h3>Revisiting Stack Overflow Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5D690072-1177-4D13-9415-4E98EDD4BC2A.png" /></p>
<h3>Revisiting Stack Overflow Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D1ECF899-825E-4B79-89D3-4B6B2A5A64FC.png" /></p>
<h3>Execution Privilege Level Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/71D72E8A-2857-48A2-8D0C-0B88F2A66C77.png" /></p>
<h3>Execution Privilege Level Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3716BF8E-4D50-43B3-936E-318EABBFDDB4.png" /></p>
<h3>TCB Requirements Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B91C6769-2EB6-41EC-884C-9BECF16EAA16.png" /></p>
<h3>TCB Requirements Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/449C3685-5396-4F92-A070-F09425449193.png" /></p>
<p>In this case, we have tampered with the TCB by turning off the check. The access still proceeds through the operating system, and is still technically correct (i.e. the access wasn't permitted because of a bug).</p>
<h3>Size of Security Code</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D40FCB93-786B-464E-B73E-ED5EAE001FE2.png" /></p>
<h3>Size of Security Code Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A944CF7D-097D-4359-B600-BAB6F6E3BB8F.png" /></p>
<p>I think the point being made here is that the increase in complexity may be accompanied by an increase in vulnerability.</p>
<h3>Hypervisor Code Size Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/8AE1A120-4AD3-44D6-9A06-C19DB78BC670.png" /></p>
<h3>Hypervisor Code Size Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/32D8E299-1B81-442E-8468-5834F515C381.png" /></p>
<p>Again, the argument being made here is that using a hypervisor as a TCB, with fewer lines of code than a full-fledged operating system, might be a more secure choice.</p>
<h2>Authentication</h2>
<h3>Authentication Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/196A1024-D729-4CE2-BA23-5C8D8CD10B6B.png" /></p>
<h3>Authentication Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/57996615-B926-4F51-BF29-E3372F1A5C63.png" /></p>
<p>If someone steals your phone, you will be thankful for your lock screen/passcode.</p>
<h3>Login Attacks Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5A9CA9D1-FD6A-413F-9DF6-43B0D94BBE71.png" /></p>
<h3>Login Attacks Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/DBB01EA0-AF2A-4894-96DF-5D34EEC42A10.png" /></p>
<p>Remember, the positive event is gaining access to the system. A false positive is gaining access erroneously. An attacker authenticating as someone else is a false positive.</p>
<h3>Implementation Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6E147430-22A9-4286-A6F3-475688360A5A.png" /></p>
<h3>Implementation Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/CC89677E-5EA4-41E8-899B-5697A658BA99.png" /></p>
<h3>Password Popularity Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/7E55E7C7-D42D-49D1-8BD8-426BFA142037.png" /></p>
<h3>Password Popularity Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3F2C0344-3371-466B-B6CF-D7D1E177661C.png" /></p>
<p>If we are attacking systems, we might get the best bang for our buck trying these passwords.</p>
<h3>Password Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/24F5D97B-1D55-46CD-B2D8-8E795B30BA8F.png" /></p>
<h3>Password Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/31FE2544-CBD2-4906-B310-7F05DC21E645.png" /></p>
<p>A trusted path ensures that there is no application between the user and the operating system. Without this path, malicious programs may intercept login credentials.</p>
<h3>Hashed Passwords Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C4A2AD00-738F-455D-830F-718C3ED2205D.png" /></p>
<h3>Hashed Passwords Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2F6B2EAE-5899-4DE4-B41A-49697B251132.png" /></p>
<h3>Hash Function Characteristics Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3F37F04D-3EC1-4EA7-A0F4-C3EE3098D70D.png" /></p>
<h3>Hash Function Characteristics Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/245963DD-ABEE-4364-96FA-16B7753AAD9C.png" /></p>
<h3>Unique PINS Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C7E9CD09-30CD-4A70-A3E8-12CA15DB1769.png" /></p>
<h3>Unique PINS Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B3B14694-D6EC-4C26-B0F3-C00DBB302AB8.png" /></p>
<p>With ten options for the first digit, ten options for the second digit, and so on, the total number of four digit pins is 10 * 10 * 10 * 10, or <code>10^4</code>, or 10,000.</p>
<h3>Brute Force Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F88846E5-1F09-4695-9ABA-9C6786066E21.png" /></p>
<h3>Brute Force Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0EA2B5B0-F329-4B96-80EA-1BF697743D43.png" /></p>
<p>With 72 options for each other six characters, the total number of unique passwords is 72^6, which is the number of attempts the hacker will have to make in the very worst case.</p>
<h3>Touch Screen Passwords Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/AB789F7E-C3A5-4938-B5C9-58BF3C3424D9.png" /></p>
<h3>Touch Screen Passwords Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D02FF363-D3A3-4D71-B4E6-E5A137CE04A8.png" /></p>
<p>Basically, the idea here is that attackers will likely not have to exhaustively search the space of possible patterns because biases exist that greatly shrink this space into a much smaller space of much more probable patterns.</p>
<h3>Multi-factor Authentication Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/41CFA250-2487-4089-A2D7-D01CC482495F.png" /></p>
<h3>Multi-factor Authentication Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/CC9A6A59-47B9-465A-BCAD-4F0257BE84A5.png" /></p>
<p>Remember, a false positive occurs when a malicious user is granted access to the system as a valid user. The likelihood of this happening decreases when multiple authentication components are employed by the system.</p>
<h3>Chip and Pin Authentication Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/77924BCE-4594-4893-B02E-08E46A624821.png" /></p>
<h3>Chip and Pin Authentication Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/4668FB80-8C96-4083-A753-7E4A41F8CC1D.png" /></p>
<p>Read more <a href="http://www.darkreading.com/vulnerabilities---threats/flaws-in-emv-chip-and-pin-undercut-security/d/d-id/1269155">here</a> and <a href="https://www.schneier.com/blog/archives/2014/05/preplay_attack_.html">here</a>.</p>
<h3>Biometric Authentication Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3D51F432-5BE0-41DC-BCE5-243BEEF20CA6.png" /></p>
<h3>Biometric Authentication Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/62C0DA99-A728-42B8-867F-D0FB6CEB9DA2.png" /></p>
<p>As a basic example, consider someone recording your voice and playing it back to a voice-based authentication system.</p>
<h2>Access Control</h2>
<h3>Data Confidentiality Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/AD434002-43B3-41CC-A837-4B2BBFA18017.png" /></p>
<h3>Data Confidentiality Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C9D0D775-0D1F-4695-9F4F-8EBA71914E34.png" /></p>
<p>Controlling read access is connected to data confidentiality, while controlling write access is connected to data integrity.</p>
<h3>Determining Access Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/104BA89A-BC90-4875-A0BD-48765D8DD073.png" /></p>
<h3>Determining Access Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0E90ADD5-3CCB-4A69-9C9E-55E06E88A8E8.png" /></p>
<p>Access control conflicts can be securely resolved by denying access.</p>
<h3>Discretionary Access Control Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/8C822B06-A689-4ABC-BC3C-69517F39029D.png" /></p>
<h3>Discretionary Access Control Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/69519ED2-526D-47DB-8CFF-B3A922D2DBDF.png" /></p>
<p>Bob can write the contents of the file to a new file that he owns, and share that file with Charlie.</p>
<h3>ACE Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/38DA4583-E908-4834-A4A8-A30FB65A2754.png" /></p>
<h3>ACE Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/89BFDAE7-ED13-41D6-BB4C-01D5948DD108.png" /></p>
<p>The presentation of the ticket is sufficient to gain access to the theater. No other access checks are required. This is closest in functionality to a capability.</p>
<h3>ACE Access Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/790A92B9-8315-4A52-8B83-9F7CF9F33947.png" /></p>
<h3>ACE Access Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0D94E256-D8D9-4BCE-9E83-F7BFD18F7E20.png" /></p>
<p>Negative access rights supersede positive access rights, so you can't terminate as soon as you find a positive access right. You can terminate as soon as you find a negative access right, though.</p>
<p>NB: The third option can't be true if the second option is true.</p>
<h3>Revocation of Rights Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/99C6BB65-DB67-42A9-A133-484EAEC0498C.png" /></p>
<h3>Revocation of Rights Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/06734230-A91A-4DCB-BBC0-35AF61DC9A09.png" /></p>
<h3>Time to Check vs Time to Use Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/252D27FB-9B58-4DCD-AE9C-6D6B7C3143E9.png" /></p>
<h3>Time to Check vs Time to Use Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B464C794-6718-40DB-BDAB-EAA956AD1C13.png" /></p>
<p>As long as you had the permissions when you called <code>open</code>, you can access the file using the file descriptor.</p>
<h3>Unix File Sharing Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/88897E9D-9338-459B-B582-7A87A6EB74E6.png" /></p>
<h3>Unix File Sharing Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/8E7ED659-B2F6-4823-A54F-C312F6110482.png" /></p>
<p>You would need to somehow add the descriptor to the per-process descriptor table for the process with which you wish to share the descriptor. Since the OS owns this table, mutating it is impossible.</p>
<h3>SetUID Bit Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/71AAA4B5-5DD3-414A-8317-8BB17007E533.png" /></p>
<h3>SetUID Bit Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/E2739829-4308-4DBE-8C7D-0AAF1025E54E.png" /></p>
<p>The effective UID of a process executing a file with the setuid bit set is the owner of the file, not the user who created the process.</p>
<h3>RBAC Benefits Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D1B82974-ED31-4162-B636-012F375BCE35.png" /></p>
<h3>RBAC Benefits Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/01A48AF0-F1FD-4085-A588-4BA0C746FE0C.png" /></p>
<h3>Access Control Policy Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/7221A53F-3B6C-4CA2-9738-3A63FCA7CEFA.png" /></p>
<h3>Access Control Policy Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5DEE9998-897C-4B46-8565-A383DD6FC069.png" /></p>
<p>From a security standpoint, denying access is a fail-safe default. It never fails to keep your system secure.</p>
<h2>Mandatory Access Control</h2>
<h3>DAC Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FFAA8FAE-B0AC-421F-A71A-2B59F7D76D87.png" /></p>
<h3>DAC Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/CC4FCC5B-CC40-4ADC-8AC7-B14CEA595009.png" /></p>
<p>DAC can't control information flow, so we must use MAC.</p>
<h3>Health Data Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B190798D-AB66-4B7B-938B-ED38D21FBB4C.png" /></p>
<h3>Health Data Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/9EF783B9-6360-427A-918C-CDF9773C4034.png" /></p>
<p>BLP is concerned with military/governmental intelligence. HIPAA is concerned with health information.</p>
<h3>Security Clearance Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/4492690A-933D-4088-BCCC-51031EA9A047.png" /></p>
<h3>Security Clearance Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D0C61525-5A43-4B43-8C64-4CCBC4715B41.png" /></p>
<p>Source: <a href="https://www.washingtonpost.com/news/the-switch/wp/2014/03/24/5-1-million-americans-have-security-clearances-thats-more-than-the-entire-population-of-norway/?noredirect=on">Washington Post</a></p>
<h3>Order Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2F90AB65-3E72-4760-BB6B-28DB02993748.png" /></p>
<h3>Order Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/37633CE2-16DD-45D5-B67D-52318AF4DD6E.png" /></p>
<p>Given any two real numbers, one number is always greater than the other.</p>
<h3>Label Domination Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/11C6E389-14C8-4928-B128-A743249D4F2A.png" /></p>
<h3>Label Domination Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/89DAADB0-D668-480D-8B6D-38C0037CCE42.png" /></p>
<p>While <code>secret &lt; top-secret</code> , <code>{Asia, Europe}</code> cannot be compared with <code>{Europe, South-America}</code>.</p>
<h3>Sensitive Data Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/65E58104-8D29-4E6C-AE31-FCB742D1C233.png" /></p>
<h3>Sensitive Data Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/34881303-A27C-4BB1-807C-03DE3A0016D9.png" /></p>
<p>In order for <code>D1</code> to dominate <code>D2</code>, <code>D1</code> must have a higher sensitivity level than <code>D2</code>.</p>
<p>In addition, the compartment of <code>D1</code> must contain the compartment of <code>D2</code> in order to be 'greater' (based on the ordering rules for sets). For this to be the case, the compartment of <code>D2</code> must be a subset of ("narrower" than) the compartment of <code>D1</code>.</p>
<h3>Unclassified Documents Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/EA4A6F50-B773-4345-BD3C-28CFB3AEA7D4.png" /></p>
<h3>Unclassified Documents Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3D70CF4F-3BC7-40D2-B75C-FB84BB1CE0D8.png" /></p>
<p>Write-down says that individuals cannot write documents with a classification that is less than their security clearance. Therefore, unclassified documents cannot be written by individuals holding a security clearance of classified, secret, or top secret.</p>
<h3>Classified Data Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2BE2011C-6B0A-4D48-BF24-575316A8F447.png" /></p>
<h3>Classified Data Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A699ECFA-0934-4CCD-9C63-056FD1E46428.png" /></p>
<p>Because of the write-up rule, individuals are allowed to write documents at a classification level that is greater than their clearance level. Individuals with unclassified security clearance are thus allowed to write top secret documents.</p>
<h3>BLP Model Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C4229ADC-2062-4802-BD5C-8BA008F90F29.png" /></p>
<h3>BLP Model Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3D182BB1-66B8-4F82-8795-E5BEEA1C6F11.png" /></p>
<p>For example, if a user is writing to a top secret document, and the classification level suddenly changes to secret, the write-up rule is violated and information is flowing in the wrong direction.</p>
<h3>Clark Wilson Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A286764A-C66E-4C60-9CE7-106440934312.png" /></p>
<h3>Clark Wilson Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A4317935-9B6A-4DB8-869A-1644B8A403F0.png" /></p>
<p>In mandatory access control, sharing decisions are not made at the discretion of the user.</p>
<h3>COI Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FD528D21-BCC6-48D4-A1F4-179CB9A9470B.png" /></p>
<h3>COI Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2A693A0B-93E6-4AE5-B6AB-3869601B5800.png" /></p>
<p>Competition implies that there is a possibility for a conflict of interest. Chinese Wall is best at preventing these situations.</p>
<h3>RBAC Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/18AF82C6-AE0E-4A04-BE46-24C199FAC8DF.png" /></p>
<h3>RBAC Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/E32A017C-052D-4DF1-94CA-ABBD02770338.png" /></p>
<p>In mandatory access control, the company decides who can share what.</p>
<h3>MAC Support Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1F3AB8F6-7244-44E3-91BD-833C137AC8FD.png" /></p>
<h3>MAC Support Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B94746DE-2747-401F-B607-68799681137C.png" /></p>
<h3>Least Privilege Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/125DFCBE-E30F-4B38-AE98-DB12FA30C0DC.png" /></p>
<h3>Least Privilege Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FC19D98D-46EB-46BE-8AE3-7C75BF6E482B.png" /></p>
<p>The TCB provides high assurance, not certainty.</p>
<h3>TCB High Assurance Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F33DDE22-EF71-4878-9A86-1153AE4C938B.png" /></p>
<h3>TCB High Assurance Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/47F700ED-F1EE-4693-B99C-5117AEEF93A2.png" /></p>
<p>Security by obscurity violates open design.</p>
<h3>Design Principle Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/130DA7AD-F9EE-498B-807C-C00F7111C79B.png" /></p>
<h3>Design Principle Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D70011C5-D8EA-404D-82A6-7A6C4A77DDDB.png" /></p>
<p>A fail-safe default is one that provides security unless otherwise specified. In this case, the default should be traffic encryption.</p>
<h3>Reducing TCB Size Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/11F63B01-9D9D-4070-B054-C4DE0A004584.png" /></p>
<h3>Reducing TCB Size Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B9687C3C-5D80-45A9-9112-224E955CDF88.png" /></p>
<h3>Testing TCB Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/DFED8BC1-EB62-44EB-A00D-06864E69B0AE.png" /></p>
<h3>Testing TCB Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5F87B5BC-DB54-413C-8348-BF6973C787F5.png" /></p>
<p>Testing can't show the absence of problems.</p>
<h3>Model Checking Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1DD38815-AC14-4050-8BE4-CD4B6545DE3B.png" /></p>
<h3>Model Checking Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B90F59EF-3CF9-42B6-BC7C-6237B4AB68B2.png" /></p>
<h3>TCSEC Divisions Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/812B3058-CB14-4745-9085-7D918AD2AE0F.png" /></p>
<h3>TCSEC Divisions Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/472F8C5A-752D-4F31-B25E-1AB70F353DDF.png" /></p>
<h3>Earning an EAL4 Certification Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1BD7FA8D-A4A3-420D-B034-5DE4ACFF0305.png" /></p>
<h3>Earning an EAL4 Certification Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/54D03A5C-FF37-40C9-A359-3F2B765910B4.png" /></p>
<h3>Cost Benefit Certification Tradeoffs Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0DB30C2E-0FDD-438F-8532-4B6CC06E7977.png" /></p>
<h3>Cost Benefit Certification Tradeoffs Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FC3F201F-6A8B-4E3B-9725-E8128B9719E5.png" /></p>
<h2>Database Security</h2>
<h3>Database Threats Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/DF4376DB-23F1-4197-A713-0D67A365E539.png" /></p>
<h3>Database Threats Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/EEA0ABC9-F002-4A9D-8654-81E456D1921D.png" /></p>
<p><a href="http://www.oracle.com/us/products/database/2014-ioug-dba-security-superhero-2338955.pdf">Source</a></p>
<h3>Database Hacking Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/BC720089-2712-4976-B060-FF39DC587337.png" /></p>
<h3>Database Hacking Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/027DCEF8-3F17-4FD1-8D27-191328C18040.png" /></p>
<h3>Key Value Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/83E4EFF2-3CED-4058-AD08-39D3DEFC3A62.png" /></p>
<h3>Key Value Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/66B99FB2-D304-43C2-979E-BDA1CAD672A8.png" /></p>
<p>A primary key uniquely identifies a row.</p>
<h3>Database Views Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/12C1B7B6-9B61-4C2A-B9CB-55D63FB07E0A.png" /></p>
<h3>Database Views Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/8046AD01-9F33-468B-9F3E-2A1D04087814.png" /></p>
<h3>Database Access Control Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/7D499BB8-5C13-4A36-8CF3-0C3E8F301532.png" /></p>
<h3>Database Access Control Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/11C78BAE-41F8-42FC-8AFE-F234639D2D20.png" /></p>
<h3>Cascading Authorizations Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/31AD71A2-E008-405D-8F49-8C4A9CA746D9.png" /></p>
<h3>Cascading Authorizations Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/4A856303-A0BB-473A-8E98-41306F1E2AE4.png" /></p>
<h3>DAC or MAC Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5947BE2E-48E7-4792-A77C-432EBC939BF2.png" /></p>
<h3>DAC or MAC Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6AED63B6-5A43-4EF8-BDCF-3624B7789381.png" /></p>
<h3>SQL Login Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/29ADEB96-538D-470A-85E1-28D2D25B40AC.png" /></p>
<h3>SQL Login Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6FF291D3-98CE-4AD1-93D7-9A93431D5335.png" /></p>
<h3>SQL Login Quiz 2</h3>
<p><img alt="" src="https://assets.omscs.io/notes/7BA1E896-52B9-43EB-A710-2EB5C7170141.png" /></p>
<h3>SQL Login Quiz 2 Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/87FB43B8-EEE7-4BB8-A3CE-10DFA9911FAE.png" /></p>
<h3>SQL Inference Attack Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/972B9CAC-ECD3-40CF-9187-8CA4B3F1E280.png" /></p>
<h3>SQL Inference Attack Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/379AB37B-1684-45F6-AD8D-54C00A35629B.png" /></p>
<h3>SQL Inference Attack Quiz 2</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0C1BADC4-C735-4958-9274-F9F2DB3E9411.png" /></p>
<h3>SQL Inference Attack Quiz 2 Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/13759837-A50F-4319-9A86-FDD985C5EE27.png" /></p>
<p>Consider the case where one student from a region containing two students retrieves the grade information about that region.</p>
<h2>Malicious Code</h2>
<h3>What is Malware Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/40637903-CAAE-402C-9F8D-DC289CB7EC62.png" /></p>
<h3>What is Malware Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/07625575-7DE3-4F7F-AEF7-5E0B1178E7A7.png" /></p>
<h3>Host Required Malware Quiz 1</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A4EDCDB2-1BCA-44CE-82D9-F9F87A38CED2.png" /></p>
<h3>Host Required Malware Quiz 1 Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5FECA411-7C95-4E9C-B485-2FB274E512F5.png" /></p>
<h3>Host Required Malware Quiz 2</h3>
<p><img alt="" src="https://assets.omscs.io/notes/21C54A27-F1F6-4A37-969F-A29DE164F9F5.png" /></p>
<h3>Host Required Malware Quiz 2 Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/049C97B7-000C-4F42-8755-89BDE3A06DB9.png" /></p>
<h3>Types of Viruses Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/133BBEDD-CE14-4ED3-A8ED-48F539E3E52B.png" /></p>
<h3>Types of Viruses Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6294734B-447D-4C84-9F5E-C80BD8923832.png" /></p>
<p>Macro viruses run when an infected document is opened with a given application. Boot sector viruses run before the operating system is loaded.</p>
<h3>Rootkit Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F9D17F35-7B72-4538-9425-77C62F298C1D.png" /></p>
<h3>Rootkit Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F4D927F4-F0EF-4056-9F9C-3979A28E1375.png" /></p>
<h3>Truth and Misconceptions Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C55A0FCE-82C4-4243-83F9-9FE14B9B1982.png" /></p>
<h3>Truth and Misconceptions Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FE1571D1-8225-4963-ABEA-379773BD8D9A.png" /></p>
<h3>Worm Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/63C5BA47-1177-48B3-8C53-AB4B8BD90395.png" /></p>
<h3>Worm Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/60DAF027-9368-40B6-AE36-FC6EA78B32B8.png" /></p>
<h3>Malware Prevention &amp; Detection Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/36682CCE-48D2-43A0-B174-A5558BA230E6.png" /></p>
<h3>Malware Prevention &amp; Detection Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/919A3EB0-92AE-4221-BFC5-D339E835C7E6.png" /></p>
<h3>Most Expensive Worm Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/8C469D3D-9061-45F2-8B2F-53D35CBD5A30.png" /></p>
<h3>Most Expensive Worm Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/38A65997-26BC-4D80-A560-169AF0930940.png" /></p>
<p><a href="https://encyclopedia2.thefreedictionary.com/Top+10+Worst+Computer+Worms+of+All+Time">Source</a></p>
<h2>Modern Malware</h2>
<h3>Bot Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/133D2EE2-25A2-4657-A7B4-78A70EDC2E60.png" /></p>
<h3>Bot Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FF650996-73FA-4E4C-B893-FA0A8F302E79.png" /></p>
<h3>DDoS Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B4B116A3-24D3-40AB-86DE-DF49D439D91E.png" /></p>
<h3>DDoS Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3F23779C-7FEB-4551-A120-ED3B7046EFF2.png" /></p>
<p>Remember, the characteristics of DNS servers can be used to amplify the effects of DDoS attacks, not mitigate them.</p>
<h3>C&amp;C Design Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/185071EA-CDCF-47EC-8D44-9F63D543C5DD.png" /></p>
<h3>C&amp;C Design Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FE123C3D-C49F-4AA5-80F0-0DF1EF468A48.png" /></p>
<p>The second answer is false. Bot code can have logic bombs or other triggers that enable bot to attack without contacting a C&amp;C server.</p>
<p>The third answer is also false. A botnet is more likely to be found using custom communication protocols, as admins observing the network are more likely to detect strange types of traffic flowing from their system.</p>
<h3>Botnet C&amp;C Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B94A4FF5-8F9D-4252-9849-4DFAFCAA5640.png" /></p>
<h3>Botnet C&amp;C Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F388379F-0461-46F3-9211-1ADA9775FEE1.png" /></p>
<p>A single gmail account, hardcoded in bot code, is both easy to detect and easy to disrupt.</p>
<p>P2P traffic will easily stand out in an enterprise network where peer-to-peer communications are not typically allowed.</p>
<p>A news site can be hard to detect, because traffic to news websites is common. However, if the site is identified as being malicious, it can easily be blocked.</p>
<h3>APT Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/31C8957F-328A-463B-98E6-8D5FA5481366.png" /></p>
<h3>APT Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/012DC084-0287-4D85-9D3B-0C2003FB716A.png" /></p>
<h3>Malware Analysis Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A14989C9-C5D0-4F0D-B937-F9F9E8B01079.png" /></p>
<h3>Malware Analysis Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C371FC26-E6A5-42D1-870F-5C4914E47789.png" /></p>
<h2>Firewalls</h2>
<h3>Firewalls Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F9F12971-51F9-4D97-8CDD-ABD6DE61A09F.png" /></p>
<h3>Firewalls Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/CD0D727F-C0F6-4B52-9B85-95B0D5540FED.png" /></p>
<h3>Firewall Features Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C58A7F53-1221-4BCD-9F63-3DD25ED340E1.png" /></p>
<h3>Firewall Features Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/08146EF7-844E-4DF4-AF9B-46A4EFE810B9.png" /></p>
<h3>Firewall Filtering Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/948B9D27-D7EE-499D-945D-B272DEF09A1C.png" /></p>
<h3>Firewall Filtering Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/448612E5-28F9-422A-ADBA-7661F4D4F1EF.png" /></p>
<p>The first example follows the "default drop" rule, which is high security but requires new services to be expressly allowed. The second example follows the "default forward" rule, which is easier to use at the expense of security. The final approach sits in between the two in terms of security and ease of use.</p>
<h3>Packet Filtering Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/97AF2EAE-DC71-4E99-AF2D-49520F5D1BD1.png" /></p>
<h3>Packet Filtering Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6C72F7E1-2A20-4826-8080-A48DEC8CEDB5.png" /></p>
<h3>Filtering Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5BE501CE-84FD-4BC6-A5A8-1334384E7466.png" /></p>
<h3>Filtering Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1F34A051-C027-4F76-BEA7-4BF6151DE243.png" /></p>
<h3>Personal Firewalls Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/318AE0E6-A077-413E-9B08-A6E3263B8E08.png" /></p>
<h3>Personal Firewalls Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/AE45FA72-0C13-4F06-A89A-620E2894EBFC.png" /></p>
<p>If the device is not always protected by the corporate network, as is the case in scenarios 1 and 3, then the personal firewall is needed for additional security.</p>
<h3>Firewall Deployment Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/EFDA0A4D-B9D3-417D-9025-2E23F564DDE1.png" /></p>
<h3>Firewall Deployment Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A765E6A6-3A0E-4F47-86B5-F56A9C0E3BFA.png" /></p>
<h3>Stand Alone Firewall Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/DCDD7C22-F6A1-449E-A7B5-013C5D1324A4.png" /></p>
<h3>Stand Alone Firewall Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F83D170A-A182-4CD1-A70E-A816AB4D8FD7.png" /></p>
<h2>Intrusion Detection</h2>
<h3>Intrusion Detection Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6FCC8EA1-D76B-4CD2-A7B2-C959F599631A.png" /></p>
<h3>Intrusion Detection Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D8BA0592-C705-4DEA-8677-C198872DAD54.png" /></p>
<h3>Intruder Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/62299D09-AF06-4DCC-8C70-37251796390A.png" /></p>
<h3>Intruder Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/BE79FB0F-8998-4A34-9B1D-89C3DF2DFA2E.png" /></p>
<h3>Types of Backdoors Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/7BB48E4A-080C-41DF-BDFF-981789BA55DC.png" /></p>
<h3>Types of Backdoors Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/72F9A46A-F7C2-43E0-84F0-BC956FF413A6.png" /></p>
<p>Read more <a href="http://www.infoworld.com/article/2606776/hacking/155947-Biggest-baddest-boldest-software-backdoors-of-all-time.html#slide3">here</a>, <a href="https://www.gnu.org/philosophy/proprietary-back-doors.html">here</a>, and <a href="https://www.eecs.berkeley.edu/~daw/teaching/cs261-f07/scribenotes/1025-brian.pdf">here</a>.</p>
<h3>Analysis Detection Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F83D983E-10A9-4BFC-9007-006DA276551C.png" /></p>
<h3>Analysis Detection Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3804546D-535E-4812-99F9-68C4039BA79A.png" /></p>
<h3>Signature Detection Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/54F22B6A-68FA-478A-9A18-6697555EE8C2.png" /></p>
<h3>Signature Detection Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/45F0F4C2-AE2D-4F2E-9598-779B6D797F58.png" /></p>
<h3>Anomaly Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B557672F-381D-4AA9-B3E0-79D35CA0CA65.png" /></p>
<h3>Anomaly Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/EFCDDFD7-05BB-4564-8CD3-6CA8FBF651E7.png" /></p>
<h3>Statistical &amp; Knowledge Based Approaches Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FD8DAA8E-9BDA-49E7-B155-99D4ED73C602.png" /></p>
<h3>Statistical &amp; Knowledge Based Approaches Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/795F294B-48FC-4667-89FB-BEFB856FF9B3.png" /></p>
<h3>Machine Learning Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F832A03B-6CE6-465D-87EB-1766FA05D423.png" /></p>
<h3>Machine Learning Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B66DFC3A-5CAF-4FBF-ACCC-B2EE1F2F0F1E.png" /></p>
<h3>Anomalous Behavior Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/73D531B9-DAB0-4B29-93CE-057BE5A1F4B0.png" /></p>
<h3>Anomalous Behavior Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/9E4397E7-D80E-4A34-8B6F-5F22F297369E.png" /></p>
<h3>Zero Day Market Place Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/60C770A8-12A9-4FA4-A475-CECF25987C9D.png" /></p>
<h3>Zero Day Market Place Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2AE76DB1-1D8B-448A-8256-C61796C19DE4.png" /></p>
<h3>Attacks Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F5CFF1A9-853F-4258-9A6A-C5ACDD8C643A.png" /></p>
<h3>Attacks Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/4D15090A-E7EB-4230-BD11-E816124BDA06.png" /></p>
<h3>NIDS Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6B45119B-AA0A-47F6-822D-A5FC37269B12.png" /></p>
<h3>NIDS Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/05B818DD-0EA3-4203-B87D-3DE4FD93663C.png" /></p>
<h3>IDS Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/30738940-A839-4656-B153-027BD6CF97A0.png" /></p>
<h3>IDS Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/8FB406A3-4B50-49BB-AA37-C33F19784845.png" /></p>
<h3>NIDS Sensor Deployed Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/599591ED-6BDC-4FCF-BA83-BBC590E815E7.png" /></p>
<h3>NIDS Sensor Deployed Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/63258409-141A-434F-B9CD-8DF34C46C864.png" /></p>
<h3>Snort Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/73F79545-4C3F-44B2-A4EC-DA4D4E300729.png" /></p>
<h3>Snort Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/207F97E0-2041-461C-864F-27A2D73B4924.png" /></p>
<h3>Honeypot Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6BBDB4A2-6E49-4DD1-B761-1BED24EB3322.png" /></p>
<h3>Honeypot Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C6889A78-B3F7-4738-B4CF-B81149D61644.png" /></p>
<h3>IDS Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/EE0009BB-048C-4192-8372-0752194F9C8F.png" /></p>
<h3>IDS Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/67B4C307-4630-470A-9E6E-EDB4C4FDC0D8.png" /></p>
<h3>IDS Attack Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/85CA9C14-3D97-4B61-BCCE-F2C703BCDC0D.png" /></p>
<h3>IDS Attack Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B0C3AD98-1CF0-4438-9A0E-81511D82D085.png" /></p>
<h2>Introduction to Cryptography</h2>
<h3>Encryption Attack Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/DAF48208-84E4-496E-B228-B4C8B0B841CA.png" /></p>
<h3>Encryption Attack Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/462EA39F-5754-47D1-B624-335F35CF3647.png" /></p>
<p>In a brute-force attack, the attacker must try all potential keys. The only way to make this task more difficult is to increase the length of the key, thus increasing the size of the keyspace.</p>
<h3>Simple Ciphers Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/88162C87-3BE8-476A-BC36-E9B325A11A04.png" /></p>
<h3>Simple Ciphers Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B6279774-5618-4B04-8081-1499BCF75299.png" /></p>
<p>Since "A" maps to "D", "B" maps to "E", and so forth, we can just "rewind" each letter in the ciphertext by three to obtain the plaintext.</p>
<h3>Monoalphabetic Cipher Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/693FC6D9-96D7-4E8D-8736-0D2D2CD8165D.png" /></p>
<h3>Monoalphabetic Cipher Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/43C05969-AD5E-4A44-A49D-590BD32B62FD.png" /></p>
<h3>Vigenere Cipher Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C188A430-4FD1-41CB-B6F3-1991645DB0E1.png" /></p>
<h3>Vigenere Cipher Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/4F4575D2-8431-473F-9F1B-AF4BC57359C6.png" /></p>
<h3>Hash Function Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/333D362C-324B-4AE9-9256-66111A0EAA3B.png" /></p>
<h3>Hash Function Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/9FCFF378-D376-46B5-8734-E5DB63549DCA.png" /></p>
<p>The <strong>avalanche effect</strong> states that a small change in the input to a hash function causes a large change to the output. We want this in place as a way to obscure similar passwords. Without the avalanche effect, an attacker may be able to deduce password <code>A</code> from its hash value if he knows that the hash of a string <code>B</code> is similar to <code>A</code>'s hash.</p>
<h3>Symmetric Encryption Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1E31561D-622A-48AB-8B4B-D46F37A11AD1.png" /></p>
<h3>Symmetric Encryption Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5F18ADCF-329B-4A37-9876-305990D371B2.png" /></p>
<h3>Asymmetric Encryption Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2CAA6C73-F6D0-4797-B4A7-FABFA269EFF6.png" /></p>
<h3>Asymmetric Encryption Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1374D8F4-378E-4CD8-9B80-511E87EA2F3C.png" /></p>
<h3>Encryption Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/623ADEEA-F8E3-4CC7-A61B-51EC26C8F93B.png" /></p>
<h3>Encryption Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/CB248B54-A4DA-49D9-A9DC-477AE73A38B3.png" /></p>
<h2>Symmetric Encryption</h2>
<h3>Block Cipher Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F77DC130-7DC8-46BD-A0EF-6A05F934BF23.png" /></p>
<h3>Block Cipher Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5A22576A-05B2-48C1-AE69-874601220654.png" /></p>
<h3>XOR Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/E6D8649E-9459-4BE3-8091-6B4FB8C456FF.png" /></p>
<h3>XOR Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/9E317675-DB11-4A1E-AAC8-D59F6667ABB9.png" /></p>
<p>"H" has an ASCII code of 72, which maps to <code>0b01001000</code>, and "i" has an ASCII code of 105, which maps to <code>0b01101001</code>. "F" maps to 15 (<code>0b1111</code>) and "A" maps to 11 (<code>0b1001</code>), so "FA" maps to <code>0b11111001</code> and "F2" maps to <code>0b11111001</code>.</p>
<p>We XOR two numbers bit-by-bit, and we return 0 when the bits match and 1 otherwise. Therefore <code>0b0100100001101001</code> XOR <code>0b1111100111110010</code> is <code>0b1011000110011011</code>.</p>
<h3>S Box Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/47A34B5B-85A1-45EE-BB2F-07EC4B1A59AB.png" /></p>
<h3>S Box Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0C60D9C2-1E8B-45D3-8410-8C63C9F1FDE8.png" /></p>
<h3>DES Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FCF98268-BDC4-48AA-8E11-39B427244D6B.png" /></p>
<h3>DES Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3233B23D-A5CA-4E0E-9818-C9FC4773221C.png" /></p>
<h3>AES Encryption Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/194759AE-0DA0-4C26-87D6-66A9E764598A.png" /></p>
<h3>AES Encryption Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A427A006-090C-4F5B-AA31-32FBA20D10C3.png" /></p>
<h3>CBC Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/DBF9FA91-292C-4847-ABFB-2C1166D0D5CA.png" /></p>
<h3>CBC Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5146C532-57F6-4F41-9D3E-2512206871DE.png" /></p>
<h2>Public-Key Cryptography</h2>
<h3>Additive Inverse Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/90F567FE-9F15-4966-A205-678D05E4DF66.png" /></p>
<h3>Additive Inverse Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/E00E3BB9-A148-4AFA-8A9E-DAFA95C4DC80.png" /></p>
<p>In modular addition, a number $k$  has an inverse $k'$ such that $k + k' \pmod M = 0$. In this case, $M = 20$ and $k = 8$. Therefore, $k' = 12$ because $8 + 12 \pmod{20} = 0$.</p>
<h3>Modular Multiplication Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/89D8C09E-CF46-4E8F-8F14-B9F075C0302C.png" /></p>
<h3>Modular Multiplication Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/252A1D26-CED8-446B-B012-40592D172D03.png" /></p>
<p>In modular multiplication, a number $k$  has an inverse $k'$ such that $k * k' \pmod M = 1$. In this case, $M = 17$ and $k = 3$. Therefore, $k' = 6$ because $3 * 6 \pmod{17} =  18 \pmod{17} = 1$.</p>
<h3>Totient Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/E9CACF9B-A69C-4D35-8FF1-1B8D1AC252ED.png" /></p>
<h3>Totient Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/4A80521F-0882-4BAC-A178-7A72A29A1531.png" /></p>
<p>If $n = p * q$ and $p$ and $q$ are prime, then $\phi(n) = (p - 1) * (q - 1)$. For $n = 21$, $p = 3$ and $q = 7$, $\phi(n) = (3 - 1) * (7 - 1) = 2 * 6 = 12$.</p>
<h3>Modular Exponentiation Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/DBABA778-3D5F-46BA-BF46-4AA6CBF87024.png" /></p>
<h3>Modular Exponentiation Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/7396A649-2E25-4636-9B04-532FA86DC8C6.png" /></p>
<p>We know that $x^y \pmod n = x^{y \pmod{\phi(n)}} \pmod n$. For $x = 7$, $y = 27$ and $n = 30$, $7^{27} \pmod{30} = 7^{27 \pmod{\phi(30)}} \pmod{30}$. We can calculate $\phi(30)$ as follows:  $\phi(30) = \phi(3) * \phi(10) = \phi(3) * \phi(2) * \phi(5) = 2 * 1 * 4 = 8$. Thus, $7^{27} \pmod{30} = 7^{27 \pmod 8} \pmod{30}$. If we divide 27 by 8, we are left with a remainder of 3, so $7^{27} \pmod{30} = 7^3 \pmod{30}$. $7^3 = 343$, which yields a remainder of 13 when divided by 30.</p>
<h3>RSA Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0BDF0664-4A30-41C8-9EFC-CA0FEC5B9BAF.png" /></p>
<h3>RSA Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/9B9F10D9-B82B-4F16-8A44-B25CCADF7491.png" /></p>
<p>$n = p * q = 11 * 3 = 33$ and $\phi(n) = (p - 1) * (q - 1) = 2 * 10 = 20$. $e$ and $d$ must be multiplicative inverses $\pmod{\phi(n)}$, so for $e = 7$, $d = 3$, since $21 \pmod{20} = 1$. Finally, public key ${e, n}$ is equal to ${7, 33}$, and private key, ${d, n}$ is equal to ${3, 33}$.</p>
<h3>RSA Encryption Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FC5100D0-A94A-46DB-8DAB-F12DF35B30E1.png" /></p>
<h3>RSA Encryption Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A38846E8-2C2B-4683-B7FF-6D847E9F23CE.png" /></p>
<p>Encrypting message $m$ involves computing  $m^e \pmod n$, which is equivalent to $2^7 \pmod{33} = 128 \pmod{33} = 29$.  Decrypting ciphertext $C$ involves computing $C^d \pmod n$, which is equivalent to $29^3 \pmod{33} = 24389 \pmod{33} = 3$.</p>
<h3>RSA in Practice Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/63B9D9AB-3440-4F75-8417-FAF749B460D8.png" /></p>
<h3>RSA in Practice Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3D62323C-0309-4B49-BEBB-E17D8C79A0BD.png" /></p>
<p>Always use standard libraries, as they have been reviewed and tested by experts in the field.</p>
<h3>Diffie-Hellman Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0ADA9333-D62C-4A27-8DA7-799BDBAF6512.png" /></p>
<h3>Diffie-Hellman Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/AA61E589-45F8-4F17-87B5-0FCE0DD5A99D.png" /></p>
<p>Alice sends $\alpha^a \pmod q$ to Bob, which is equivalent to $5^6 \pmod{23} = 8$. Bob sends $\alpha^b \pmod q$ to Alice, which is equivalent to $5^{15} \pmod{23} = 19$.</p>
<h3>RSA, Diffie-Hellman Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0DE9D182-0375-4A0C-BE6C-B6ECF5D66E4A.png" /></p>
<h3>RSA, Diffie-Hellman Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/BCAE9911-0D01-456E-837C-B92CB34B8BE0.png" /></p>
<h2>Hashes</h2>
<h3>Hash Size Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/4782A47E-5391-43F5-A80C-CA9F02FDBD71.png" /></p>
<h3>Hash Size Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/EC0A4B95-7A5E-4C5B-87AD-6D39D17FA04C.png" /></p>
<p>Given a hash length $n$, an attacker needs to hash $2^{n / 2}$ messages to find a collision. For $n = 128$, an attacker needs to compute $2^{64}$ hashes.</p>
<h3>Hash Function Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/AD311597-0FE3-4399-B9A1-11A70E568C55.png" /></p>
<h3>Hash Function Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/137488B0-4ADC-4B1E-AD86-DFA5067E6565.png" /></p>
<h2>Security Protocols</h2>
<h3>Mutual Authentication Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/80FD51E1-A56A-41ED-A67C-73513A08A815.png" /></p>
<h3>Mutual Authentication Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6F5B4FC5-A864-4ABF-A723-74B86A03E032.png" /></p>
<h3>Security Protocols Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/55902D91-0F5A-4553-829E-34C88755CFFD.png" /></p>
<h3>Security Protocols Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/183F382E-5822-4207-AAB9-BA9CEC7B898B.png" /></p>
<h3>Session Key Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0A70D994-363F-4512-8333-3D30F130D0C3.png" /></p>
<h3>Session Key Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F44F5C79-3691-440B-B5E9-72181E40A834.png" /></p>
<h3>Kerberos Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0327A697-D433-41EE-B0E4-54A3F830AFC7.png" /></p>
<h3>Kerberos Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/358A47CC-D72F-4BAB-BCCD-590496B92FBF.png" /></p>
<h2>IPSec and TLS</h2>
<h3>Spoofing Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1DD688E5-257A-4BD1-A26F-EA39E51D9B39.png" /></p>
<h3>Spoofing Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D5A3CBE4-FC07-4B05-9A8E-58657B7FB1DB.png" /></p>
<p>If you spoof your IP address, responses to your packets will not reach you. Therefore, IP spoofing is only useful for unidirectional communication.</p>
<h3>IPSec Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/71C27E26-B59A-479C-B58D-E5DE2CB8C25C.png" /></p>
<h3>IPSec Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/ED223658-281B-41DC-B9FB-C1A4C7947B46.png" /></p>
<h3>ESP Modes Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3008B283-1683-4743-A65C-803E545D9BE3.png" /></p>
<h3>ESP Modes Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FE6C0D73-4AD5-4227-ABC2-90E2C64533BD.png" /></p>
<h3>ESP and AH Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FD580F5D-A007-460F-B7C0-878B746040A9.png" /></p>
<h3>ESP and AH Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5F059246-E05A-48FE-89DA-01D8F01B2249.png" /></p>
<h3>IPSec Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/E4D8DF00-E68F-47D6-AEBD-1B28A0557F04.png" /></p>
<h3>IPSec Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2A1B6B61-7F65-43B9-84D8-6B281D0FD29C.png" /></p>
<h3>Diffie Hellman Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0914FC25-D4BF-4506-A396-5CE9A634DE1D.png" /></p>
<h3>Diffie Hellman Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/70D29C1C-2681-4AD3-9215-1608F8762907.png" /></p>
<h3>IKE Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/62A969AA-6E08-43A4-88D5-465C92149EE4.png" /></p>
<h3>IKE Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/8F57DD12-F29F-4F16-9039-41BC4E1A0509.png" /></p>
<h3>TLS and SSL Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/BE0FFF58-FFF7-4072-8B4C-77297F71EFFD.png" /></p>
<h3>TLS and SSL Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/34823FD7-F6DD-46F3-A29D-2FEE62D8D7FA.png" /></p>
<p>While transport layer protocols do rely on the IP layer, TLS does not specifically rely on IPSec.</p>
<h2>Wireless and Mobile Security</h2>
<h3>Wifi Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A1605EE1-CD3B-44F8-B316-087EB5CCDEBD.png" /></p>
<h3>Wifi Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3FB90460-9F73-461D-AF2F-9A572F610D1D.png" /></p>
<h3>Wifi Security Standards Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/9F9DCFAA-4E6E-4100-8875-AEBB630F432D.png" /></p>
<h3>Wifi Security Standards Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/7C57D6D4-3AB3-401F-8291-4762198BCC1E.png" /></p>
<h3>Operating System Vulnerabilities Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0BF73658-68A7-45E7-B8FF-6117B810C8B2.png" /></p>
<h3>Operating System Vulnerabilities Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3BB6C671-DF45-44C8-A21D-620C92AF45ED.png" /></p>
<p>Betcha thought it was gonna be all Microsoft, didn't you? Read more <a href="https://techtalk.gfi.com/most-vulnerable-operating-systems-and-applications-in-2014/">here</a>.</p>
<h3>Security Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/4AA42396-DE28-4F4E-A5E9-19038D09F56B.png" /></p>
<h3>Security Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B9B9D6E5-BE56-49FF-A59F-C47ADFC8A716.png" /></p>
<h3>App Store Security Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F70A9C5D-E64F-4BBA-A8AC-4B827080A4AA.png" /></p>
<h3>App Store Security Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F55BD9F8-0B42-44EE-ABC9-2653B6FE11E0.png" /></p>
<p>Read more <a href="https://www.computerworld.com/article/2483867/researchers-outwit-apple--plant-malware-in-the-app-store.html">here</a>.</p>
<h3>iOS Security Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/CF5A41AA-2B88-4025-9A26-9C5386660D66.png" /></p>
<h3>iOS Security Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/9B84187A-9DAC-4F61-8E87-9EACE74CD93D.png" /></p>
<p>Read more <a href="https://drive.google.com/file/d/0BxxXk1d3yyuZOFlsdkNMSGswSGs/view">here</a>.</p>
<h3>iOS Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3A910142-A483-4840-B86C-17202FB1F483.png" /></p>
<h3>iOS Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/46D2028E-7DD1-4982-861E-7D31F2574142.png" /></p>
<h3>Android Apps Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/FB9C919C-FAF9-467C-A2C8-C080760A7C84.png" /></p>
<h3>Android Apps Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D4C6F94A-5A0A-4014-8D94-982837DEE5DB.png" /></p>
<h2>Web Security</h2>
<h3>Cookie Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F6BDEF06-29AB-4349-832F-56EBC69D1D49.png" /></p>
<h3>Cookie Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2CE3FD4D-3E64-4591-A9F3-D19A90B9C151.png" /></p>
<p>Cookies are just strings of text. They are not compiled code, and therefore cannot infect a system the way a virus can.</p>
<h3>Web Security Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/532467B0-2F02-40A1-BEF9-C9B7E418FBB9.png" /></p>
<h3>Web Security Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/BD31DC8E-4CA2-49A9-8C52-AA394F2DCEF6.png" /></p>
<h3>XSS Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/8DBE2B0F-CC6F-4437-9A92-1C3FB2F37165.png" /></p>
<h3>XSS Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/E9AC9C05-8E76-4DBF-B342-F55A1A723FA8.png" /></p>
<h3>XSRF Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/01278C58-9179-459C-9DD1-A25AA8951AE0.png" /></p>
<h3>XSRF Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/9EC2B8EE-1317-434A-A103-89F4C1FE68DE.png" /></p>
<h3>SQL Injection Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/669AD069-005A-400C-A12A-5E0F9C200658.png" /></p>
<h3>SQL Injection Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A22C245A-EF36-478E-A72F-2F986CA67513.png" /></p>
<h2>Cyber Security</h2>
<h3>Network Use Policy Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C4EF0BE1-E7EB-4EF2-95C7-6C350AE5378A.png" /></p>
<h3>Network Use Policy Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/66481383-5E3B-41E1-8872-16C2F922D983.png" /></p>
<h3>Botnet Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/87796EC7-942D-4C51-A88A-D795E1D08008.png" /></p>
<h3>Botnet Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/BDBF525E-38FC-4589-B8F9-5D60D9BFC8ED.png" /></p>
<h3>Security Audit Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A0ACD1BC-3257-4E9D-B658-A38F2341B6D9.png" /></p>
<h3>Security Audit Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/955B7AA6-8925-4060-90FD-B15F77C7640A.png" /></p>
<p>NOTE: answers 1 and 3 are correct.</p>
<h3>CISO Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/44C4B128-D47A-4F43-AEFB-8AC2A7DF7355.png" /></p>
<h3>CISO Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6739A49C-41D1-4773-AB37-B79A90468145.png" /></p>
<h3>Computer Use Policy Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/9771E45D-9638-4E05-82F6-A1C10CB72D05.png" /></p>
<h3>Computer Use Policy Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6CEB54B3-7C84-476C-A25E-048670C9DFE2.png" /></p>
<h3>Student Privacy Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0AB2ABF9-9651-4AB1-A084-C5A26D7833A4.png" /></p>
<h3>Student Privacy Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/44B358FC-1EB0-42D2-AC0E-9129A51A793C.png" /></p>
<h3>Anthem Breach Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D3870811-2400-4AAC-80EC-F6DF688E235F.png" /></p>
<h3>Anthem Breach Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/8785FC32-D688-48B9-935A-B03C867CF522.png" /></p>
<p>Read more <a href="http://blogs.wsj.com/riskandcompliance/2015/03/02/crisis-of-the-week-anthems-breach-response/">here</a> and <a href="http://www.latimes.com/business/hiltzik/la-fi-mh-anthem-is-warning-consumers-20150306-column.html">here</a>.</p>
<h3>Security Breach Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/9978A76B-E7AB-47DE-892A-639CCA8A15ED.png" /></p>
<h3>Security Breach Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/CF8998BF-BD44-4ADC-9DCC-4C71DF43014B.png" /></p>
<h3>Reducing Exposure Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/3F8AD3EE-7E5F-46F3-8662-D86A7381C385.png" /></p>
<h3>Reducing Exposure Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6EEC39B8-9C40-473C-B2ED-6547F696CFAF.png" /></p>
<h3>Cyber Insurance Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/E2BF4801-6F74-4CD9-8E2A-142E405723DE.png" /></p>
<h3>Cyber Insurance Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/A2F22984-714E-452C-8801-507291A5711A.png" /></p>
<h3>Cyber Security Budgets Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1C6C0BDF-579C-4B4A-89B2-5AE53DE6E845.png" /></p>
<h3>Cyber Security Budgets Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/5F82F572-BDB4-46BD-BC15-382A67CD15C8.png" /></p>
<p>Read more <a href="https://www.partnerre.com/assets/uploads/docs/cyber-survey-results.pdf">here</a>.</p>
<h3>Proactive Security Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/4BEB9B1D-801B-4C94-BDA2-7547458C7620.png" /></p>
<h3>Proactive Security Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C3D071BA-435F-43EA-ABC8-A3D3D8C417E7.png" /></p>
<h2>Law, Ethics, and Privacy</h2>
<h3>Legal Deterrents Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2762F482-BE0A-4124-B408-52E8CF242DA8.png" /></p>
<h3>Legal Deterrents Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C646AE0D-9888-4239-97C1-3A1146256E8E.png" /></p>
<h3>Cost of Cybercrime Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/057806B3-A791-476B-86A5-038EE90E5789.png" /></p>
<h3>Cost of Cybercrime Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6D22EA68-A8BE-4C7B-A409-DE34882F3328.png" /></p>
<h3>Melissa Virus Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1E28C362-6E6A-4677-A362-568C16915225.png" /></p>
<h3>Melissa Virus Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/12204048-15EC-4A75-89EE-83966EC45C6D.png" /></p>
<h3>Unauthorized Access Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/0E4D483F-7A30-44CE-BF76-1BFC3C06BB0B.png" /></p>
<h3>Unauthorized Access Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/56C7B39C-4F63-4C1A-A02A-863642EC8401.png" /></p>
<h3>DMCA Exclusions Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/C3F16DFB-FD7A-4E37-8D5C-B49D85D292A9.png" /></p>
<h3>DMCA Exclusions Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/BACA7BA9-90D0-4402-81DF-724AB70FEB5A.png" /></p>
<h3>Computer Ethics Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2D3BCFF6-7747-4664-B3BD-037CB1DAA9D2.png" /></p>
<h3>Computer Ethics Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/7C9A2833-34E5-4F26-8E01-E81F4ECC0B0F.png" /></p>
<h3>Responsible Disclosure Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/DD897D09-0FCE-487F-9E2A-AE7B1BED3CD0.png" /></p>
<h3>Responsible Disclosure Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/63AB025B-A11C-43E2-80B2-74825F271520.png" /></p>
<h3>Privacy Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/6222EA4E-3B0D-472F-991C-FBEEFACF61A5.png" /></p>
<h3>Privacy Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/1F9A054B-54D7-423A-979A-609AFF05841F.png" /></p>
<p>Read more <a href="https://www.pewresearch.org/internet/2015/05/20/americans-attitudes-about-privacy-security-and-surveillance/">here</a>.</p>
<h3>Right to Be Forgotten Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/CCE71B10-21D1-492A-A2E5-7EDF4CAD7CC4.png" /></p>
<h3>Right to Be Forgotten Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/B5ADC3E6-8457-4465-93F3-56D856A5E848.png" /></p>
<h3>EFF Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/D70E4126-197A-493A-BA09-CC58D8168CEF.png" /></p>
<h3>EFF Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/348B6806-8887-4721-BE27-1A1404BAA50A.png" /></p>
<p>Read more <a href="https://www.eff.org/who-has-your-back-government-data-requests-2015">here</a></p>
<h3>Google Privacy Policy Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/64E48411-D40C-4D92-83B3-38F2EFA1B704.png" /></p>
<h3>Google Privacy Policy Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/4C61BFC4-01BA-4D4F-B9D0-BE25ED2BCEC5.png" /></p>
<h3>Legal Deterrents Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/432B96FF-19C1-405F-A90E-302E9828A709.png" /></p>
<h3>Legal Deterrents Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/27460EF1-8AF8-4584-A28B-017A21AF6522.png" /></p>
<h3>Fandango Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/F0D3B2E7-12CD-439C-AE8A-5A181E96F01C.png" /></p>
<h3>Fandango Quiz Solution</h3>
<p><img alt="" src="https://assets.omscs.io/notes/2DF69546-F0D9-44EC-9646-6C087EFF93F9.png" /></p>
<h3>Tracking Quiz</h3>
<p><img alt="" src="https://assets.omscs.io/notes/AA9789FF-1BD5-42A4-91C5-7894D1E4F442.png" /></p>
<h3>Tracking Quiz Solution</h3>
<h2><img alt="" src="https://assets.omscs.io/notes/C431A102-4377-4BB8-9C40-BA2D6CA46F6B.png" /></h2>
<p>id: information-security-web-security
title: Web Security
course: information-security
lecture: web-security</p>
<hr />
<h1>Web Security</h1>
<h2>How the Web Works</h2>
<p>A web browser and a web server communicate using the <strong>HyperText Transfer Protocol</strong> (HTTP). The browser requests documents through a URL, and the server responds with documents in <strong>HyperText Markup Language</strong> (HTML).</p>
<p><img alt="" src="https://assets.omscs.io/notes/176D0F91-9527-4508-9D0C-8D9FB3200865.png" /></p>
<p>HTML documents can include text, graphics, video, audio, PostScript, JavaScript, and other components. The browser displays text and embedded graphics and executes the JavaScript and other helper scripts.</p>
<h2>Cookies</h2>
<p>Each HTTP request uses its own HTTP connection; that is, HTTP is a <em>stateless</em> protocol. For example, when navigating through a website, each visit to a URL generates a separate HTTP (really TCP) connection.</p>
<p>Browsers and servers use cookies as a way of carrying information, such as user authentication/session state, across multiple HTTP requests.</p>
<p><img alt="" src="https://assets.omscs.io/notes/1BAB1B26-F15A-4E20-B3B3-5C593392FA73.png" /></p>
<p><strong>Cookies</strong> are small strings of text that a web server can create as part of any HTTP response using the <code>Set-cookie</code> HTTP header. Cookies are essentially key/value pairs, such as <code>userName=user123</code>.</p>
<p>In addition to the key/value pair itself, a cookie also contains some metadata, including expiration information, domain information, and security requirements for transmission.</p>
<p>A user's browser stores cookies and includes them in subsequent requests as a way to create and preserve state over fundamentally stateless connections.</p>
<h2>Cookie Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F6BDEF06-29AB-4349-832F-56EBC69D1D49.png" /></p>
<h2>Cookie Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/2CE3FD4D-3E64-4591-A9F3-D19A90B9C151.png" /></p>
<p>Cookies are just strings of text. They are not compiled code, and therefore cannot infect a system the way a virus can.</p>
<h2>The Web and Security</h2>
<p>Can a browser trust the content it receives from the server?</p>
<p>Browsers rarely authenticate servers before communicating with them. Even if they do, the content that a server sends may not be trustworthy.</p>
<p>On the browser side, a website may have security vulnerabilities that allow it to display malicious content or execute malicious scripts. Additionally, a website might link to other websites that have security vulnerabilities themselves.</p>
<p>On the server side, a website runs applications that process requests from browsers and often interacts with backend servers to produce content for users.</p>
<p>These web applications, like any software, may have security vulnerabilities. Furthermore, many websites do not authenticate users, which means that attackers are free to send requests designed to exploit security vulnerabilities in these web applications.</p>
<h2>Web Security Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/532467B0-2F02-40A1-BEF9-C9B7E418FBB9.png" /></p>
<h2>Web Security Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/BD31DC8E-4CA2-49A9-8C52-AA394F2DCEF6.png" /></p>
<h2>Cross-Site Scripting (XSS)</h2>
<p>Many websites, including social networking sites, blogs, forums, and wikis, display user-supplied data. For example, a user Joe might visit a website and fill out a form indicating that his name is Joe. The website might greet him with a page saying, "Hello Joe."</p>
<p>Suppose that instead of entering his name, Joe submits the following.</p>
<p>```html</p>
<script type="text/javascript">alert('Hello World')</script>
<p>```</p>
<p>The website takes this string as the user's name and includes it in the HTML page sent to the browser. Therefore, when the browser displays this webpage, the script runs, and the webpage displays "Hello World."</p>
<h2>XSS Example</h2>
<p>In a <strong>cross-site scripting</strong> (XSS) attack, an attacker tricks the browser into executing malicious scripts without the user's knowledge.</p>
<p>The following diagram presents how this attack might work.</p>
<p><img alt="" src="https://assets.omscs.io/notes/97CEA72E-2455-439F-95C4-D9F7CC3B27EA.png" /></p>
<p>First, the user logs in to a vulnerable site, naive.com, and the browser stores a cookie to naive.com. Next, the attacker directs the user to evil.com, which returns a page containing a hidden iframe.</p>
<p>The iframe forces the browser to visit naive.com and invoke the <code>hello.cgi</code> web application, sending the malicious script as the name of the user. <code>hello.cgi</code> at naive.com then echos the malicious script in the HTML page sent back to the user's browser.</p>
<p>The browser displays the HTML page and executes the malicious script, which steals the user's cookie to naive.com and sends it to the attacker. Since the cookie can include session authentication information for naive.com, the attacker can now impersonate this user on naive.com.</p>
<h2>XSS Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/8DBE2B0F-CC6F-4437-9A92-1C3FB2F37165.png" /></p>
<h2>XSS Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/E9AC9C05-8E76-4DBF-B342-F55A1A723FA8.png" /></p>
<h2>XSRF: Cross-Site Request Forgery</h2>
<p>When a user logs in to a site, the server usually writes a cookie to the user's browser that contains session authentication information for that user on that site.</p>
<p>The cookie lives in the user's browser as long as they keep the session alive. Once they log out of the website, the server resets the cookie.</p>
<p>If a user browses to a malicious site in the middle of their session with a trusted site, a script on the malicious site can potentially read the user's cookie to the trusted site and use it to forge requests to that site. This type of attack is called <strong>cross-site request forgery</strong>.</p>
<p>The user never sees this malicious request, since the malicious site often triggers it from a hidden iframe. Additionally, the trusted server doesn't find the request suspicious since it contains the user's cookie, which the server itself granted.</p>
<p><img alt="" src="https://assets.omscs.io/notes/9F08DB29-3750-474F-841B-677EA4D1F0FC.png" /></p>
<h2>XSRF Example</h2>
<p>Here is an illustration of an XRSF example involving a trusted site, bank.com, and a malicious site, attacker.com.</p>
<p><img alt="" src="https://assets.omscs.io/notes/86B95C1B-A028-43AE-AAC5-13F386336EC2.png" /></p>
<p>The user logs in to bank.com and keeps the session alive, which means that the browser has a cookie to bank.com. Meanwhile, the attacker phishes the user and directs them to the malicious site attacker.com.</p>
<p>When the user visits attacker.com, their browser downloads and executes the malicious page. The scripts on this page direct the browser to make a request to bank.com on the user's behalf.</p>
<p>Since the user is still logged in to bank.com, their browser also sends the bank.com cookie along with the forged request. As a result, bank.com believes that the request originated from the user and therefore executes the request.</p>
<h2>XSRF vs XSS</h2>
<p>In cross-site scripting, an attacker injects a script into a badly-implemented website that does not validate user input. As a result, when a user visits this website, their browser downloads and executes the malicious script.</p>
<p>In cross-site request forgery, an attacker forges user requests to a website. As a result, the website executes the attacker's malicious actions as if they were initiated and authorized by the user.</p>
<p>Both XSS and XSRF are the results of security weaknesses in websites, in particular, the lack of authenticating and validating user input.</p>
<h2>XSRF Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/01278C58-9179-459C-9DD1-A25AA8951AE0.png" /></p>
<h2>XSRF Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9EC2B8EE-1317-434A-A103-89F4C1FE68DE.png" /></p>
<h2>Structured Query Language (SQL)</h2>
<p>SQL is the most widely-used database query language. We use SQL to retrieve database information, such as tables or records, and modify database information; for example, adding records to a table or modifying the specific values of a record.</p>
<h2>Sample PHP Code</h2>
<p>Many websites contain forms that users fill out with information that they want the database to persist. When a user submits form data, the web server typically runs a program to transform the data into an SQL query and then sends the query to the database server for execution.</p>
<p>For example, the following PHP snippet builds an SQL query based partially on user input.</p>
<p><img alt="" src="https://assets.omscs.io/notes/E73A8762-957A-4800-B230-0C7C5CA96E68.png" /></p>
<p>The security threat here is that specially crafted input can generate malicious SQL queries that can lead to compromise of data confidentiality and integrity.</p>
<h2>Example Login</h2>
<p>Here is an example of a web form consisting of username and password fields that a user might use to log in to a web site.</p>
<p><img alt="" src="https://assets.omscs.io/notes/C84D690A-40AB-40AB-A735-AA97C2365F25.png" /></p>
<p>To authenticate the user, the web server first needs to compare the received password hash with the stored password hash for the user. The web server issues an SQL query to the database to retrieve the stored user information.</p>
<p><img alt="" src="https://assets.omscs.io/notes/9F384F2C-0D9E-4ECC-80DC-70F469CE2A8D.png" /></p>
<h2>Malicious User Input</h2>
<p>Suppose an attacker enters this malicious string as the user name.</p>
<p><img alt="" src="https://assets.omscs.io/notes/81320400-97C9-4DE0-B25B-DA1DB932918A.png" /></p>
<p>What is going to happen?</p>
<p><img alt="" src="https://assets.omscs.io/notes/4A1296B9-EA61-4DAA-9CD5-83B86E4A0E78.png" /></p>
<p>The SQL query sent from the web server to the backend database server triggers the deletion of all user records.</p>
<h2>SQL Injection Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/669AD069-005A-400C-A12A-5E0F9C200658.png" /></p>
<h2>SQL Injection Quiz Solution</h2>
<h2><img alt="" src="https://assets.omscs.io/notes/A22C245A-EF36-478E-A72F-2F986CA67513.png" /></h2>
<p>id: information-security-welcome
title: Welcome to IIS
course: information-security
lecture: welcome</p>
<hr />
<h1>Welcome</h1>
<h2>Howdy Friends</h2>
<p>Here are my notes from when I took IIS in OMSCS during Fall 2019.</p>
<p>I have organized them into two sections:</p>
<ul>
<li>Lecture Notes</li>
<li>Exam Review</li>
</ul>
<p>Each document in "Lecture Notes" corresponds to a lesson in <a href="https://classroom.udacity.com/courses/ud459">Udacity</a>. Within each document, the headings correspond to the videos within that lesson. Usually, I omit any intro/summary lessons.</p>
<p>The "Exam Review" section contains student-generated study guides for both the midterm and the final exam,
as well as a complete list of the Udacity quizzes and answers.</p>
<h2>Textbook Information</h2>
<p>The following textbook helped me get an <strong>A</strong> in this course:</p>
<ul>
<li><a href="https://amzn.to/3d8YPc9">Computer Security: Principles and Practice</a></li>
</ul>
<h2>Download These Notes</h2>
<p>Some students have asked for PDF versions of the notes for a simpler, more portable
studying experience. The following PDFs are available for download.</p>
<ul>
<li><a href="https://payhip.com/b/51wH" title="The complete set of IIS notes, including lecture notes and exam review materials.">Introduction to Information Security - Complete</a></li>
<li><a href="https://payhip.com/b/X1j0" title="The complete set of IIS lecture notes, covering content from all twenty-one lectures.">Introduction to Information Security - Lecture Notes</a></li>
<li><a href="https://payhip.com/b/34Xw" title="The complete set of IIS exam review notes, containing all Udacity quizzes as well as study material for the midterm and final exams.">Introduction to Information Security - Exam Review</a></li>
</ul>
<h2>Contact</h2>
<p>If you have any questions, comments, concerns, or improvements, don't hesitate to reach out to me. You can find me at:</p>
<ul>
<li><a href="mailto:matt@omscs-notes.com">matt@omscs-notes.com</a></li>
<li><a href="https://www.linkedin.com/in/matt-schlenker-3457b047/">Matt Schlenker \| Linkedin</a></li>
<li>@mschlenker (Slack)</li>
</ul>
<hr />
<p>id: information-security-wireless-and-mobile-security
title: Wireless and Mobile Security
course: information-security
lecture: wireless-and-mobile-security</p>
<hr />
<h1>Wireless and Mobile Security</h1>
<h2>Introduction to Wifi</h2>
<p>A typical use of WiFi is to allow WiFi-enabled personal computers or devices to access the Internet through a wireless access point (AP). Alternatively, devices can connect directly to one another wirelessly through the AP.</p>
<p>Devices connect to the AP wirelessly, and the AP connects to the Internet through physical wiring, often through a router provided by the Internet service provider.</p>
<p>In wireless networking, data is not transmitted via physical wiring, but rather through air, which is an open medium. In other words, there is no inherent physical protection in wireless communications.</p>
<p>Without hard wiring connecting two devices for direct communication, devices in a wireless environment must use broadcasting; that is, a sender must broadcast a message, and a receiver must be listening for a broadcast.</p>
<h2>Wifi Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/A1605EE1-CD3B-44F8-B316-087EB5CCDEBD.png" /></p>
<h2>Wifi Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3FB90460-9F73-461D-AF2F-9A572F610D1D.png" /></p>
<h2>Overview of Wifi Security</h2>
<p>The earlier WiFi security standard, Wired Equivalent Privacy (WEP), is easily breakable even when properly configured. The new, more secure standard is 802.11i, which WiFi Protected Access 2 (WPA2) implements. You should always use WPA2 over WEP.</p>
<h2>Overview of 802.11i</h2>
<p>The 802.11i standard enforces access control, and the underlying access control protocol is based on another standard, 802.1x. 802.1x is flexible because it is based on the <a href="https://en.wikipedia.org/wiki/Extensible_Authentication_Protocol">Extensible Authentication Protocol</a> (EAP).</p>
<p>EAP is designed as a carrier protocol whose purpose is to transport the messages of "real" authentication protocols, such as TLS. In other words, you can implement a host of different authentication methods on top of EAP, and therefore on top of 802.1x.</p>
<p>The more advanced EAP methods, such as TLS, provide mutual authentication, which limits man-in-the-middle attacks by authenticating both the server and client. Furthermore, this EAP method results in key material, which can be used to generate dynamic encryption keys.</p>
<p>Additionally, 802.11i follows strong security practices. For example, it uses different keys for encryption and integrity protection, and also uses more secure encryption schemes - AES in particular.</p>
<h2>Wifi Security Standards Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9F9DCFAA-4E6E-4100-8875-AEBB630F432D.png" /></p>
<h2>Wifi Security Standards Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/7C57D6D4-3AB3-401F-8291-4762198BCC1E.png" /></p>
<h2>Overview of Smartphone Security</h2>
<p>The following plot shows a significant increase in smartphone sales in recent years.</p>
<p><img alt="" src="https://assets.omscs.io/notes/E69C1979-A030-492E-8971-1B557DA2290A.png" /></p>
<p>People use smartphones now more than ever, and we are using them for more and more essential tasks. Therefore, we must examine the security of smartphones.</p>
<h2>Overview of iOS Security</h2>
<p>The iOS security architecture combines both hardware and software features to provide security to iOS devices such as iPhones and iPads.</p>
<p><img alt="" src="https://assets.omscs.io/notes/D6E8E31D-832C-46CF-95BB-065F65C52881.png" /></p>
<p>The architecture contains built-in cryptographic capabilities - for example, the cryptographic engine and keys are embedded into the hardware - for supporting data protection via confidentiality and integrity.</p>
<p>The architecture also provides powerful isolation mechanisms. For example, it uses app sandboxing to protect app security. These sandboxes enable apps to run in isolation, free from interference from other apps. Additionally, sandboxing helps to ensure the integrity of the overall system. In other words, even if an app is compromised, its capability to damage the system is minimal.</p>
<p><img alt="" src="https://assets.omscs.io/notes/255A3E0A-2841-42CF-839B-0DBBAAC9C8EC.png" /></p>
<h2>Operating System Vulnerabilities Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/0BF73658-68A7-45E7-B8FF-6117B810C8B2.png" /></p>
<h2>Operating System Vulnerabilities Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3BB6C671-DF45-44C8-A21D-620C92AF45ED.png" /></p>
<p>Betcha thought it was gonna be all Microsoft, didn't you? Read more <a href="https://techtalk.gfi.com/most-vulnerable-operating-systems-and-applications-in-2014/">here</a>.</p>
<h2>Hardware Security Feature</h2>
<p>Each iOS device has a dedicated AES-256 cryptographic engine built into the direct memory access path between the flash storage and the main system memory, which makes file encryption/decryption highly efficient.</p>
<p>The device's unique ID (UID) and group ID (GID) are AES 256-bit keys fused into the <a href="https://www.computerhope.com/jargon/s/secure-enclave.htm">secure enclave</a> hardware component during manufacturing. Only the cryptographic engine, itself a hardware component, can read these keys directly. All other firmware and software components can only see the result of an encryption or decryption operation.</p>
<p>A UID is unique to a device and is not recorded by Apple or its suppliers. GIDs are common to all processors in a class of devices, such as those using the Apple A8 processor, and are used for tasks such as delivering system installations and updates.</p>
<h2>iOS Trusted Bootchain</h2>
<p>iOS uses a <strong>trusted bootchain</strong> to establish the security of an iOS device on boot. Each step in the bootchain (except the first) only executes once the previous step has verified it.</p>
<p><img alt="" src="https://assets.omscs.io/notes/274985FE-70FC-41F8-8A5D-7B5937456B8B.png" /></p>
<p>When an iOS device is turned on, each application processor immediately executes code from a section of read-only memory known as the <em>BootROM</em>. This immutable, implicitly-trusted code, known as the hardware <em>root of trust</em>, is burned into the hardware during chip fabrication.</p>
<p>The BootROM code contains the Apple root CA public key, which is used to verify that Apple has signed the <em>low-level boot loader</em> (LLB) before allowing it to load. When the LLB finishes its tasks, it verifies and runs the next stage boot loader, iBoot, which in turn verifies and runs the iOS kernel.</p>
<p>This secure bootchain helps ensure that the lowest levels of software are not tampered with, and enforces that iOS only runs on validated Apple devices.</p>
<h2>File Data Encryption</h2>
<p>In addition to the cryptographic capabilities built into the hardware of each iOS device, Apple uses a technology called <strong>data protection</strong> to further secure data stored in flash memory.</p>
<p>Data protection enables a high level of encryption for user data. Critical system apps such as Messages, Mail, and Calendar use data protection by default, and third-party apps installed on iOS 7 or later receive this protection automatically.</p>
<p>Data protection constructs and manages a hierarchy of keys - such as class, file, and filesystem keys - that builds on the hardware encryption technologies built into each iOS device.</p>
<p><img alt="" src="https://assets.omscs.io/notes/900975FC-B103-4BA8-9E13-C5352FE4C48A.png" /></p>
<p>Each time a file is created, the data protection system generates a new 256-bit <em>file key</em>, which it gives to the hardware AES engine. The engine encrypts the file using this key - via the CBC mode of AES - every time the file is written to flash memory.</p>
<p>Every file is a member of one or more file classes, and each class is associated with a <em>class key</em>. A class key is protected by the hardware UID and, for some classes, the user's passcode as well. The file key is encrypted with one or more class keys, depending on which classes the file belongs to, and the result is stored in the file's metadata.</p>
<p>The metadata of all files in the filesystem is encrypted using the same random key: the <em>filesystem key</em>. The system generates this key when iOS is first installed, or when a user wipes and restarts the device.</p>
<p>When a file is opened, it's metadata is decrypted first using the filesystem key, which reveals the encrypted file key. Next, the file key is decrypted using one or more class keys. Finally, the file key is used to decrypt the file as it is read from flash memory.</p>
<h2>Security Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/4AA42396-DE28-4F4E-A5E9-19038D09F56B.png" /></p>
<h2>Security Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/B9B9D6E5-BE56-49FF-A59F-C47ADFC8A716.png" /></p>
<h2>Mandatory Code Signing</h2>
<p>The iOS kernel controls which user processes and apps are allowed to run. iOS requires all executable code to be signed with an Apple-issued certificate to ensure that all apps come from a known and approved source and have not been modified in unauthorized ways.</p>
<p>Apps provided with the device, such as Mail or Safari, are already signed by Apple. Third-party apps must also be certified and signed using an Apple-issued certificate.</p>
<p>By requiring all apps on the device to be signed, iOS extends the concept of <em>chain of trust</em> from the kernel to the apps and prevents third-party apps from uploading unauthorized code or running self-modifying code.</p>
<p>A user-space daemon examines executable memory pages as they are loaded by an app to ensure that the app has not been modified since it was installed or explicitly updated.</p>
<h2>Restricted App Distribution Model</h2>
<p>A developer must first register with Apple and join the iOS developer program if they want to develop apps for iOS devices. Apple verifies the real-world identity of each developer - whether an individual or business - before issuing a certificate.</p>
<p>Developers use their certificates to sign their apps before submitting them to the App Store for distribution, which means that every app in the App Store can be traced back to an identifiable entity. Associating apps with the real-world identities of their developers serves as a deterrent to submitting malicious code.</p>
<p>Furthermore, Apple reviews all apps in the App Store to ensure that they operate as described and requires iOS devices to download apps exclusively from the official Apple App Store.</p>
<p>The restricted app distribution model, combined with app signing, makes it very difficult to upload malware to the App Store.</p>
<h2>App Store Security Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F70A9C5D-E64F-4BBA-A8AC-4B827080A4AA.png" /></p>
<h2>App Store Security Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/F55BD9F8-0B42-44EE-ABC9-2653B6FE11E0.png" /></p>
<p>Read more <a href="https://www.computerworld.com/article/2483867/researchers-outwit-apple--plant-malware-in-the-app-store.html">here</a>.</p>
<h2>Sandboxing</h2>
<p>Once an app resides on a device, iOS enforces additional security measures to prevent it from compromising other apps or the rest of the system.</p>
<p>Each app receives a unique home directory for its files, which is randomly assigned when the app is installed. This directory serves as a sandbox; that is, iOS restricts apps from accessing information outside of the directory.</p>
<p><img alt="" src="https://assets.omscs.io/notes/EF44FABA-293E-4DDC-98F4-E6F54B26C241.png" /></p>
<p>If a third-party app needs to access external information, it must use services explicitly provided by iOS. This requirement prevents apps from unauthorized access or modification to information it does not own.</p>
<p>Additionally, the majority of iOS processes, including third-party apps, run as a non-privileged user, <code>mobile</code>, which does not have access to crucial system files and resources. The iOS APIs do not allow apps to escalate their own privileges to modify other apps or iOS itself.</p>
<p>Finally, the entire iOS partition is mounted as read-only, and unnecessary tools such as remote login services are not included in the system software.</p>
<h2>Address Space Layout Randomization</h2>
<p>iOS has several other runtime security measures. One such measure is <a href="https://en.wikipedia.org/wiki/Address_space_layout_randomization">address space layout randomization</a> (ASLR), which protects against the exploitation of memory corruption bugs.</p>
<p>A common class of attack - which includes the <a href="https://en.wikipedia.org/wiki/Return-to-libc_attack">return-to-libc</a> attack - involves an attacker estimating the addresses of nearby system functions and calling these functions to perform malicious actions or escalate privileges.</p>
<p>As a countermeasure, iOS randomly arranges the different program components in memory upon app initialization. This randomization makes it virtually impossible for an attacker to locate a useful library function to exploit.</p>
<p><img alt="" src="https://assets.omscs.io/notes/D542DCBC-FA88-42FF-B287-F03E788F59D3.png" /></p>
<h2>iOS Security Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/CF5A41AA-2B88-4025-9A26-9C5386660D66.png" /></p>
<h2>iOS Security Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/9B84187A-9DAC-4F61-8E87-9EACE74CD93D.png" /></p>
<p>Read more <a href="https://drive.google.com/file/d/0BxxXk1d3yyuZOFlsdkNMSGswSGs/view">here</a>.</p>
<h2>Data Execution Prevention</h2>
<p>Another runtime security feature that iOS provides is data execution prevention. <strong>Data execution prevention</strong> is an implementation of the policy the makes writeable and executable pages mutually exclusive.</p>
<p>Specifically, iOS marks pages that are writable in runtime, such as pages that contain the stack, as non-executable, using the ARM processor's <a href="http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0360f/CACHFICI.html">execute never</a> feature. Reciprocally, iOS marks executable memory pages, such as pages that hold code instructions, as non-writeable.</p>
<p>This mutual exclusivity helps prevent code-injection attacks. To inject code, an attacker must write instructions into a memory page and then subsequently execute those instructions. Since a page cannot be both writeable and executable, an attacker can never execute injected code.</p>
<h2>Passcodes and Touch ID</h2>
<p>By setting up a device passcode, a user both prevents unauthorized access to their device and automatically enables data protection, which encrypts all of their files.</p>
<p>iOS supports 4-digit numeric and arbitrary-length alphanumeric passcodes. To discourage brute-force attacks, the iOS interface enforces escalating time delays after the entry of an invalid passcode. Users can choose to have the device automatically wiped if the passcode is entered incorrectly after ten consecutive attempts.</p>
<p>A user can opt to use Touch ID instead of a passcode. Touch ID is the fingerprint-sensing system that makes secure access to the device faster and easier.</p>
<h2>iOS Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/3A910142-A483-4840-B86C-17202FB1F483.png" /></p>
<h2>iOS Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/46D2028E-7DD1-4982-861E-7D31F2574142.png" /></p>
<h2>Android Security Overview</h2>
<p>Android is implemented as a software-stack architecture, consisting of a Linux kernel, a runtime environment with corresponding libraries, an application framework, and a set of applications.</p>
<p><img alt="" src="https://assets.omscs.io/notes/E7639F62-7467-4DF9-B028-D07A3EEADC32.png" /></p>
<p>The Linux kernel sits at the lowest level of the architecture stack and provides a level of abstraction between device hardware and the upper layers of the stack.</p>
<p>Apps are commonly written in Java, which is first compiled to Java Virtual Machine (JVM) bytecode and then translated to bytecode that runs on the <a href="https://www.javatpoint.com/dalvik-virtual-machine">Dalvik virtual machine</a> DVM, a virtual machine optimized for mobile devices. In particular, the DVM optimizes for memory, battery life, and performance.</p>
<p>The Android core libraries are Java-based libraries that are used for application development. Most of these libraries do not perform any work but instead serve as thin Java wrappers around a set of C and C++ based libraries. These underlying libraries fulfill a wide range of functions, including graphics rendering in 2D and 3D, SSL, and more.</p>
<p>The application framework is a set of services that collectively form the environment in which Android apps run. This framework allows apps to be constructed using reusable, interchangeable, and replaceable components.</p>
<p>Furthermore, an individual app can publish components and data for use by other apps. This capability allows apps to build on top of other apps, in addition to using default components exposed by the framework.</p>
<p>At the top of the software stack are the apps, which include apps that come with the device - such as contacts, phone, and email - as well as any other third-party apps the user has downloaded.</p>
<h2>Application Sandbox</h2>
<p>Apps that run in virtual machines are essentially sandboxed in runtime. Sandboxed apps cannot directly interfere with the operating system or other apps, nor can they directly access the device hardware. Each app is granted a set of permissions at install time and can only perform operations permitted by these permissions.</p>
<p>Android assigns as unique user ID (UID) to each app and runs it with that UID in a separate process. The kernel enforces security between apps and the system at the process level through standard Linux facilities, using the user and group IDs associated with an app to determine which system resources and functions an app can access.</p>
<p>By default, apps have limited access to the operating system and other apps. The operating system denies unauthorized requests - such as one app trying to read data owned by another app, or an app attempting to dial the phone without permission - unless the appropriate user privileges are present.</p>
<p>An app can announce the permissions it needs, and a user can grant these permissions during app installation. The permissions are typically implemented by mapping them to Linux groups that have the necessary read/write access to relevant system resources, such as files and sockets.</p>
<h2>Android Sandbox vs iOS Sandbox</h2>
<p>From a security perspective, one of the main differences between the Android and iOS sandbox is how they handle permissions.</p>
<p><img alt="" src="https://assets.omscs.io/notes/3F51B9F1-1D96-4EE5-843C-4EEFA0D5EBBF.png" /></p>
<p>Android apps can announce the permissions that they require, and users can approve these permissions at install time. Notably, Android apps can ask for very powerful permissions.</p>
<p>All iOS apps have the same set of basic permissions. If an app needs to access system resources or data - such as the user's address book - user approval is required at the first access request. In general, iOS apps have limited permissions.</p>
<h2>Code Signing</h2>
<p>Android also takes a very different approach than iOS in terms of code signing. In particular, all Android apps are self-signed by developers. A developer can create a public key, self-sign it to create a certificate, and then use the key to sign apps.</p>
<p>There is no central authority that signs third-party Android apps, and there is no vetting process for third-party app developers. Anybody can become an Android app developer, self-sign their apps, and upload them to the Google Play Store.</p>
<p>While Apple uses code signing to identify developers and verify app executables, Android uses code signing for different purposes.</p>
<p>Specifically, Android devices use code signing to ensure that updates for an app are coming from the same developer that created the app. Additionally, code signing helps manage the trust relationship between apps so that they can share code and data.</p>
<h2>Android Apps Quiz</h2>
<p><img alt="" src="https://assets.omscs.io/notes/FB9C919C-FAF9-467C-A2C8-C080760A7C84.png" /></p>
<h2>Android Apps Quiz Solution</h2>
<p><img alt="" src="https://assets.omscs.io/notes/D4C6F94A-5A0A-4014-8D94-982837DEE5DB.png" /></p>